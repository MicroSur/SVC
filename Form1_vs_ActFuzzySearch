VERSION 5.00
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCTL.OCX"
Begin VB.Form FrmMain 
   AutoRedraw      =   -1  'True
   Caption         =   "SurVideoCatalog"
   ClientHeight    =   9345
   ClientLeft      =   60
   ClientTop       =   -180
   ClientWidth     =   12435
   FillStyle       =   0  'Solid
   FontTransparent =   0   'False
   Icon            =   "Form1.frx":0000
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   ScaleHeight     =   623
   ScaleMode       =   3  'Pixel
   ScaleWidth      =   829
   StartUpPosition =   2  'CenterScreen
   Begin VB.Timer tPlay 
      Enabled         =   0   'False
      Interval        =   1000
      Left            =   1920
      Top             =   8580
   End
   Begin VB.CheckBox ChBTT 
      Caption         =   "?"
      Height          =   315
      Left            =   0
      Style           =   1  'Graphical
      TabIndex        =   11
      Top             =   0
      Width           =   1170
   End
   Begin SurVideoCatalog.UCVMSUR VerticalMenu 
      Height          =   8476
      Left            =   0
      TabIndex        =   125
      Top             =   0
      Width           =   1209
      _ExtentX        =   2143
      _ExtentY        =   14949
      ScaleWidth      =   190,539
      ScaleHeight     =   1512,689
   End
   Begin VB.Timer Timer2 
      Enabled         =   0   'False
      Interval        =   2000
      Left            =   1320
      Top             =   8580
   End
   Begin MSComctlLib.ImageList ImageList 
      Left            =   300
      Top             =   8400
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   16
      ImageHeight     =   16
      MaskColor       =   12632256
      _Version        =   393216
      BeginProperty Images {2C247F25-8591-11D1-B16A-00C0F0283628} 
         NumListImages   =   41
         BeginProperty ListImage1 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":030A
            Key             =   "CHECK"
         EndProperty
         BeginProperty ListImage2 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":0624
            Key             =   "LArr"
         EndProperty
         BeginProperty ListImage3 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":093E
            Key             =   "AVI"
         EndProperty
         BeginProperty ListImage4 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":0B47
            Key             =   "DIVX"
         EndProperty
         BeginProperty ListImage5 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":0D5C
            Key             =   "DVD"
         EndProperty
         BeginProperty ListImage6 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":0F6C
            Key             =   "MOV"
         EndProperty
         BeginProperty ListImage7 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":1184
            Key             =   "MPG"
         EndProperty
         BeginProperty ListImage8 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":1392
            Key             =   "WMV"
         EndProperty
         BeginProperty ListImage9 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":15B4
            Key             =   "XVID"
         EndProperty
         BeginProperty ListImage10 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":17C4
            Key             =   "mnuPlayM"
         EndProperty
         BeginProperty ListImage11 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":1D5E
            Key             =   "mGotoURL"
         EndProperty
         BeginProperty ListImage12 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":2770
            Key             =   "mnuEditMov"
         EndProperty
         BeginProperty ListImage13 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":2D0A
            Key             =   "mnuAddNewMov"
         EndProperty
         BeginProperty ListImage14 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":32A4
            Key             =   "mnuAddNewAuto"
         EndProperty
         BeginProperty ListImage15 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":383E
            Key             =   "mSR"
         EndProperty
         BeginProperty ListImage16 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":3DD8
            Key             =   "mTools"
         EndProperty
         BeginProperty ListImage17 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":4372
            Key             =   "mConvert"
         EndProperty
         BeginProperty ListImage18 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":44CC
            Key             =   "mValid"
         EndProperty
         BeginProperty ListImage19 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":4626
            Key             =   "mnuAutoSizeLV"
         EndProperty
         BeginProperty ListImage20 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":4780
            Key             =   "mnuDolgCheck"
         EndProperty
         BeginProperty ListImage21 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":4D1A
            Key             =   "mnuLabelCheck"
         EndProperty
         BeginProperty ListImage22 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":52B4
            Key             =   "mGetCoverCh"
         EndProperty
         BeginProperty ListImage23 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":584E
            Key             =   "mnuExportCheckClip"
         EndProperty
         BeginProperty ListImage24 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":6260
            Key             =   "mCh2Excel"
         EndProperty
         BeginProperty ListImage25 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":63BA
            Key             =   "mnuExportCheckHTML"
         EndProperty
         BeginProperty ListImage26 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":6954
            Key             =   "mDelCh"
         EndProperty
         BeginProperty ListImage27 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":6EEE
            Key             =   "mCombine"
         EndProperty
         BeginProperty ListImage28 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":7488
            Key             =   "mnuDolgSel"
         EndProperty
         BeginProperty ListImage29 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":7A22
            Key             =   "mnuLabelSel"
         EndProperty
         BeginProperty ListImage30 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":7FBC
            Key             =   "mGetCoverSel"
         EndProperty
         BeginProperty ListImage31 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":8556
            Key             =   "mnuCopyLV"
         EndProperty
         BeginProperty ListImage32 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":8F68
            Key             =   "mSel2Excel"
         EndProperty
         BeginProperty ListImage33 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":90C2
            Key             =   "mnuHTML"
         EndProperty
         BeginProperty ListImage34 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":965C
            Key             =   "mDelSel"
         EndProperty
         BeginProperty ListImage35 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":9BF6
            Key             =   "mnuCopyRow"
         EndProperty
         BeginProperty ListImage36 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":A190
            Key             =   "mnuLVChecked"
         EndProperty
         BeginProperty ListImage37 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":A72A
            Key             =   "mnuLVSelected"
         EndProperty
         BeginProperty ListImage38 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":ACC4
            Key             =   "mFiltActAll"
         EndProperty
         BeginProperty ListImage39 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":B25E
            Key             =   "mFiltAct"
         EndProperty
         BeginProperty ListImage40 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":B7F8
            Key             =   "SAVE_ICON"
         EndProperty
         BeginProperty ListImage41 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "Form1.frx":BD92
            Key             =   "mnuKillPic"
         EndProperty
      EndProperty
   End
   Begin VB.Frame FrameActer 
      Caption         =   "Actors"
      Height          =   8535
      Left            =   1260
      TabIndex        =   85
      Top             =   0
      Width           =   10665
      Begin VB.Frame FrActBio 
         BorderStyle     =   0  'None
         Height          =   4155
         Left            =   4500
         TabIndex        =   98
         Top             =   4140
         Width           =   5895
         Begin VB.TextBox TextActBio 
            BackColor       =   &H00C0FFFF&
            Height          =   3255
            Left            =   0
            MultiLine       =   -1  'True
            OLEDropMode     =   1  'Manual
            ScrollBars      =   2  'Vertical
            TabIndex        =   9
            Top             =   900
            Width           =   5895
         End
         Begin VB.TextBox TextActName 
            BackColor       =   &H00C0FFFF&
            Height          =   345
            Left            =   0
            MaxLength       =   100
            OLEDropMode     =   1  'Manual
            TabIndex        =   8
            Top             =   240
            Width           =   5475
         End
         Begin VB.Label LActBio 
            Caption         =   "Bio"
            Height          =   195
            Left            =   0
            TabIndex        =   100
            Top             =   660
            Width           =   5355
         End
         Begin VB.Label LActName 
            Caption         =   "Name"
            Height          =   195
            Left            =   0
            TabIndex        =   99
            Top             =   0
            Width           =   4035
         End
      End
      Begin VB.Frame FrActButtons 
         BorderStyle     =   0  'None
         Height          =   3975
         Left            =   8640
         TabIndex        =   97
         Top             =   240
         Width           =   1815
         Begin VB.CommandButton Command2 
            Caption         =   "Command2"
            Height          =   315
            Left            =   120
            TabIndex        =   199
            Top             =   2760
            Width           =   495
         End
         Begin VB.CommandButton Command1 
            Caption         =   "Com"
            Height          =   315
            Left            =   840
            TabIndex        =   198
            Top             =   2760
            Width           =   855
         End
         Begin VB.Frame FrameFoto 
            Caption         =   "Photo"
            Height          =   795
            Left            =   0
            TabIndex        =   179
            Top             =   1320
            Width           =   1815
            Begin VB.CommandButton ComActFile 
               Height          =   435
               Left            =   120
               MousePointer    =   1  'Arrow
               Picture         =   "Form1.frx":C7A4
               Style           =   1  'Graphical
               TabIndex        =   182
               Top             =   240
               Width           =   435
            End
            Begin VB.CommandButton ComActPast 
               Height          =   435
               Left            =   720
               MousePointer    =   1  'Arrow
               Picture         =   "Form1.frx":D826
               Style           =   1  'Graphical
               TabIndex        =   181
               Top             =   240
               Width           =   435
            End
            Begin VB.CommandButton ComActFotoDel 
               Height          =   435
               Left            =   1320
               MousePointer    =   1  'Arrow
               Picture         =   "Form1.frx":E8A8
               Style           =   1  'Graphical
               TabIndex        =   180
               Top             =   240
               Width           =   375
            End
         End
         Begin VB.OptionButton OptActOnlyFotoHid 
            Height          =   225
            Index           =   0
            Left            =   180
            TabIndex        =   177
            Top             =   2445
            Value           =   -1  'True
            Width           =   225
         End
         Begin VB.OptionButton OptActOnlyFotoHid 
            Height          =   195
            Index           =   1
            Left            =   780
            TabIndex        =   176
            Top             =   2460
            Width           =   195
         End
         Begin VB.OptionButton OptActOnlyFotoHid 
            Height          =   195
            Index           =   2
            Left            =   1380
            TabIndex        =   175
            Top             =   2460
            Width           =   195
         End
         Begin VB.OptionButton OptActOnlyFotoHid 
            Height          =   195
            Index           =   3
            Left            =   180
            TabIndex        =   173
            Top             =   2700
            Width           =   195
         End
         Begin SurVideoCatalog.XpB ComActSave 
            Height          =   375
            Left            =   0
            TabIndex        =   7
            Top             =   840
            Width           =   1815
            _ExtentX        =   265
            _ExtentY        =   265
            Caption         =   "Save"
            ButtonStyle     =   3
            Picture         =   "Form1.frx":F2AA
            PictureWidth    =   16
            PictureHeight   =   16
            XPColor_Pressed =   15116940
            XPColor_Hover   =   4692449
            MaskColor       =   16711935
         End
         Begin SurVideoCatalog.XpB ComActEdit 
            Height          =   375
            Left            =   0
            TabIndex        =   6
            Top             =   420
            Width           =   1815
            _ExtentX        =   265
            _ExtentY        =   265
            Caption         =   "Edit"
            ButtonStyle     =   3
            Picture         =   "Form1.frx":F5FE
            PictureWidth    =   16
            PictureHeight   =   16
            XPColor_Pressed =   15116940
            XPColor_Hover   =   4692449
         End
         Begin SurVideoCatalog.XpB ComAddAct 
            Height          =   375
            Left            =   0
            TabIndex        =   5
            Top             =   0
            Width           =   1815
            _ExtentX        =   265
            _ExtentY        =   265
            Caption         =   "Add"
            ButtonStyle     =   3
            Picture         =   "Form1.frx":F758
            PictureWidth    =   16
            PictureHeight   =   16
            XPColor_Pressed =   15116940
            XPColor_Hover   =   4692449
            MaskColor       =   16711935
         End
         Begin VB.Label lblActFoto 
            Alignment       =   2  'Center
            Caption         =   "All - Foto - No Foto"
            Height          =   195
            Left            =   60
            TabIndex        =   178
            Top             =   2220
            Width           =   1695
         End
         Begin VB.Label lActDups 
            Caption         =   "Dups"
            Height          =   195
            Left            =   480
            TabIndex        =   174
            Top             =   2700
            Width           =   1335
         End
      End
      Begin VB.Frame FrActLeft 
         BorderStyle     =   0  'None
         Height          =   8055
         Left            =   60
         TabIndex        =   93
         Top             =   240
         Width           =   4455
         Begin VB.Frame FrActSelect 
            BorderStyle     =   0  'None
            Height          =   2235
            Left            =   0
            TabIndex        =   94
            Top             =   5820
            Width           =   4335
            Begin SurVideoCatalog.XpB ComSelMovIcon 
               Height          =   375
               Left            =   0
               TabIndex        =   4
               Top             =   1800
               Width           =   4335
               _ExtentX        =   265
               _ExtentY        =   265
               Caption         =   "Select"
               ButtonStyle     =   3
               Enabled         =   0   'False
               XPColor_Pressed =   15116940
               XPColor_Hover   =   4692449
            End
            Begin VB.TextBox TextSearchLVActTypeHid 
               Height          =   315
               Left            =   0
               TabIndex        =   1
               Top             =   0
               Width           =   3795
            End
            Begin VB.ListBox ListBActHid 
               Height          =   1230
               ItemData        =   "Form1.frx":FAAC
               Left            =   2520
               List            =   "Form1.frx":FAAE
               MultiSelect     =   1  'Simple
               TabIndex        =   3
               Top             =   420
               Width           =   1755
            End
            Begin SurVideoCatalog.XpB comActSearchInBIO 
               Height          =   315
               Left            =   3900
               TabIndex        =   2
               Top             =   0
               Width           =   435
               _ExtentX        =   767
               _ExtentY        =   556
               Caption         =   ">"
               ButtonStyle     =   3
               XPColor_Pressed =   15116940
               XPColor_Hover   =   4692449
            End
            Begin VB.Label LActMarkCount 
               Alignment       =   2  'Center
               Caption         =   "Selected: 0"
               Height          =   255
               Left            =   120
               TabIndex        =   96
               Top             =   1380
               Width           =   2175
            End
            Begin VB.Label LActMarkHelp 
               Caption         =   "Names"
               Height          =   735
               Left            =   120
               TabIndex        =   95
               Top             =   420
               Width           =   2235
            End
         End
         Begin MSComctlLib.ListView LVActer 
            Height          =   4815
            Left            =   0
            TabIndex        =   0
            Top             =   0
            Width           =   4395
            _ExtentX        =   7779
            _ExtentY        =   8493
            View            =   3
            LabelEdit       =   1
            LabelWrap       =   -1  'True
            HideSelection   =   0   'False
            HideColumnHeaders=   -1  'True
            FullRowSelect   =   -1  'True
            _Version        =   393217
            ForeColor       =   -2147483640
            BackColor       =   12648447
            Appearance      =   1
            NumItems        =   2
            BeginProperty ColumnHeader(1) {BDD1F052-858B-11D1-B16A-00C0F0283628} 
               Object.Width           =   9701
            EndProperty
            BeginProperty ColumnHeader(2) {BDD1F052-858B-11D1-B16A-00C0F0283628} 
               SubItemIndex    =   1
               Object.Width           =   0
            EndProperty
         End
      End
      Begin VB.PictureBox PicActFotoScroll 
         BackColor       =   &H00C0FFFF&
         Height          =   3735
         Left            =   4560
         OLEDropMode     =   1  'Manual
         ScaleHeight     =   3675
         ScaleWidth      =   3915
         TabIndex        =   86
         Top             =   240
         Width           =   3975
         Begin VB.PictureBox PicActFoto 
            Appearance      =   0  'Flat
            AutoRedraw      =   -1  'True
            AutoSize        =   -1  'True
            BackColor       =   &H00808080&
            BorderStyle     =   0  'None
            ForeColor       =   &H80000008&
            Height          =   2175
            Left            =   120
            OLEDropMode     =   1  'Manual
            ScaleHeight     =   2175
            ScaleWidth      =   2235
            TabIndex        =   87
            TabStop         =   0   'False
            Top             =   120
            Width           =   2235
         End
      End
   End
   Begin VB.Frame FrameAddEdit 
      Caption         =   "Edit"
      Height          =   8535
      Left            =   1260
      TabIndex        =   88
      Top             =   0
      Width           =   10665
      Begin VB.Frame FrImgPrCov 
         Appearance      =   0  'Flat
         ForeColor       =   &H80000008&
         Height          =   1455
         Left            =   8940
         TabIndex        =   146
         Top             =   3300
         Width           =   1275
         Begin VB.CommandButton ComX 
            Caption         =   "X"
            Height          =   255
            Index           =   4
            Left            =   1020
            MousePointer    =   1  'Arrow
            TabIndex        =   194
            Top             =   60
            Width           =   255
         End
         Begin VB.Image ImgPrCov 
            Height          =   1335
            Left            =   0
            MouseIcon       =   "Form1.frx":FAB0
            MousePointer    =   99  'Custom
            Stretch         =   -1  'True
            Top             =   60
            Width           =   1215
         End
      End
      Begin SurVideoCatalog.XpB ComDel 
         Height          =   375
         Left            =   8580
         TabIndex        =   22
         Top             =   1740
         Width           =   1935
         _ExtentX        =   3413
         _ExtentY        =   688
         Caption         =   "Del"
         ButtonStyle     =   3
         Picture         =   "Form1.frx":1037A
         PictureWidth    =   16
         PictureHeight   =   16
         XPColor_Pressed =   15116940
         XPColor_Hover   =   4692449
      End
      Begin SurVideoCatalog.XpB ComOpen 
         Height          =   375
         Left            =   8580
         TabIndex        =   20
         Top             =   720
         Width           =   1935
         _ExtentX        =   265
         _ExtentY        =   265
         Caption         =   "Open"
         ButtonStyle     =   3
         Picture         =   "Form1.frx":10D8C
         PictureWidth    =   16
         PictureHeight   =   16
         XPColor_Pressed =   15116940
         XPColor_Hover   =   4692449
         MaskColor       =   16711935
      End
      Begin SurVideoCatalog.XpB ComSaveRec 
         Height          =   375
         Left            =   8580
         TabIndex        =   23
         Top             =   2280
         Width           =   1935
         _ExtentX        =   265
         _ExtentY        =   265
         Caption         =   "Save"
         ButtonStyle     =   3
         Picture         =   "Form1.frx":110E0
         PictureWidth    =   16
         PictureHeight   =   16
         XPColor_Pressed =   15116940
         XPColor_Hover   =   4692449
      End
      Begin SurVideoCatalog.XpB ComAdd 
         Height          =   375
         Left            =   8580
         TabIndex        =   21
         Top             =   1200
         Width           =   1935
         _ExtentX        =   265
         _ExtentY        =   265
         Caption         =   "Add"
         ButtonStyle     =   3
         Picture         =   "Form1.frx":1167A
         PictureWidth    =   16
         PictureHeight   =   16
         XPColor_Pressed =   15116940
         XPColor_Hover   =   4692449
      End
      Begin SurVideoCatalog.XpB ComCancel 
         Height          =   375
         Left            =   8580
         TabIndex        =   24
         Top             =   2820
         Width           =   1935
         _ExtentX        =   265
         _ExtentY        =   265
         Caption         =   "Cancel"
         ButtonStyle     =   3
         PictureWidth    =   16
         PictureHeight   =   16
         XPColor_Pressed =   15116940
         XPColor_Hover   =   4692449
      End
      Begin VB.Frame FrAdEdPixHid 
         BorderStyle     =   0  'None
         Height          =   7695
         Left            =   120
         TabIndex        =   111
         Top             =   600
         Width           =   10455
         Begin MSComctlLib.Slider PositionP 
            Height          =   375
            Left            =   240
            TabIndex        =   28
            Top             =   4080
            Width           =   9735
            _ExtentX        =   17198
            _ExtentY        =   688
            _Version        =   393216
            Min             =   1
            Max             =   100
            SelStart        =   1
            TickStyle       =   3
            TickFrequency   =   10
            Value           =   1
         End
         Begin MSComctlLib.Slider Position 
            Height          =   375
            Left            =   240
            TabIndex        =   29
            Top             =   3660
            Width           =   9735
            _ExtentX        =   17198
            _ExtentY        =   688
            _Version        =   393216
            Min             =   1
            Max             =   100
            SelStart        =   1
            TickStyle       =   3
            TickFrequency   =   10
            Value           =   1
         End
         Begin SurVideoCatalog.XpB ComRND 
            Height          =   255
            Index           =   2
            Left            =   7320
            TabIndex        =   46
            Top             =   7440
            Width           =   2775
            _ExtentX        =   4895
            _ExtentY        =   450
            Caption         =   "Auto"
            ButtonStyle     =   3
            XPColor_Pressed =   15116940
            XPColor_Hover   =   4692449
         End
         Begin SurVideoCatalog.XpB ComRND 
            Height          =   255
            Index           =   1
            Left            =   3840
            TabIndex        =   45
            Top             =   7440
            Width           =   2775
            _ExtentX        =   4895
            _ExtentY        =   450
            Caption         =   "Auto"
            ButtonStyle     =   3
            XPColor_Pressed =   15116940
            XPColor_Hover   =   4692449
         End
         Begin SurVideoCatalog.XpB ComRND 
            Height          =   255
            Index           =   0
            Left            =   360
            TabIndex        =   44
            Top             =   7440
            Width           =   2775
            _ExtentX        =   4895
            _ExtentY        =   450
            Caption         =   "Auto"
            ButtonStyle     =   3
            XPColor_Pressed =   15116940
            XPColor_Hover   =   4692449
         End
         Begin VB.OptionButton optAspect 
            Appearance      =   0  'Flat
            Caption         =   "16:9"
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   1
            Left            =   9660
            Style           =   1  'Graphical
            TabIndex        =   195
            Top             =   2760
            Width           =   495
         End
         Begin VB.OptionButton optAspect 
            Appearance      =   0  'Flat
            Caption         =   "4:3"
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   0
            Left            =   9180
            Style           =   1  'Graphical
            TabIndex        =   196
            Top             =   2760
            Width           =   495
         End
         Begin VB.CommandButton ComCap 
            Height          =   495
            Index           =   2
            Left            =   9780
            MousePointer    =   1  'Arrow
            Picture         =   "Form1.frx":1208C
            Style           =   1  'Graphical
            TabIndex        =   43
            Top             =   4500
            Width           =   615
         End
         Begin VB.CommandButton ComFrontFace 
            Height          =   375
            Index           =   3
            Left            =   9360
            MousePointer    =   1  'Arrow
            Picture         =   "Form1.frx":12396
            Style           =   1  'Graphical
            TabIndex        =   42
            Top             =   4500
            Width           =   435
         End
         Begin VB.CommandButton ComFrontFaceFile 
            Height          =   375
            Index           =   3
            Left            =   8940
            MousePointer    =   1  'Arrow
            Picture         =   "Form1.frx":12920
            Style           =   1  'Graphical
            TabIndex        =   41
            Top             =   4500
            Width           =   435
         End
         Begin VB.PictureBox PicSS3 
            Appearance      =   0  'Flat
            AutoRedraw      =   -1  'True
            BackColor       =   &H00808080&
            BorderStyle     =   0  'None
            ForeColor       =   &H80000008&
            Height          =   2775
            Left            =   7020
            MouseIcon       =   "Form1.frx":12EAA
            MousePointer    =   99  'Custom
            ScaleHeight     =   185
            ScaleMode       =   3  'Pixel
            ScaleWidth      =   224
            TabIndex        =   117
            TabStop         =   0   'False
            Top             =   4620
            Width           =   3360
            Begin VB.CommandButton ComX 
               Caption         =   "X"
               Height          =   315
               Index           =   2
               Left            =   0
               MousePointer    =   1  'Arrow
               TabIndex        =   40
               Top             =   0
               Width           =   315
            End
         End
         Begin VB.CommandButton ComCap 
            Height          =   495
            Index           =   1
            Left            =   6300
            MousePointer    =   1  'Arrow
            Picture         =   "Form1.frx":13774
            Style           =   1  'Graphical
            TabIndex        =   39
            Top             =   4500
            Width           =   615
         End
         Begin VB.CommandButton ComFrontFace 
            Height          =   375
            Index           =   2
            Left            =   5880
            MousePointer    =   1  'Arrow
            Picture         =   "Form1.frx":13A7E
            Style           =   1  'Graphical
            TabIndex        =   38
            Top             =   4500
            Width           =   435
         End
         Begin VB.CommandButton ComFrontFaceFile 
            Height          =   375
            Index           =   2
            Left            =   5460
            MousePointer    =   1  'Arrow
            Picture         =   "Form1.frx":14008
            Style           =   1  'Graphical
            TabIndex        =   37
            Top             =   4500
            Width           =   435
         End
         Begin VB.PictureBox PicSS2 
            Appearance      =   0  'Flat
            AutoRedraw      =   -1  'True
            BackColor       =   &H00808080&
            BorderStyle     =   0  'None
            ForeColor       =   &H80000008&
            Height          =   2775
            Left            =   3540
            MouseIcon       =   "Form1.frx":14592
            MousePointer    =   99  'Custom
            ScaleHeight     =   185
            ScaleMode       =   3  'Pixel
            ScaleWidth      =   224
            TabIndex        =   116
            TabStop         =   0   'False
            Top             =   4620
            Width           =   3360
            Begin VB.CommandButton ComX 
               Caption         =   "X"
               Height          =   315
               Index           =   1
               Left            =   0
               MousePointer    =   1  'Arrow
               TabIndex        =   36
               Top             =   0
               Width           =   315
            End
         End
         Begin VB.PictureBox movie 
            Appearance      =   0  'Flat
            AutoRedraw      =   -1  'True
            BackColor       =   &H00808080&
            BorderStyle     =   0  'None
            ForeColor       =   &H80000008&
            Height          =   3525
            Left            =   3660
            ScaleHeight     =   3525
            ScaleWidth      =   4680
            TabIndex        =   119
            TabStop         =   0   'False
            Top             =   60
            Width           =   4680
         End
         Begin SurVideoCatalog.XpB ComAutoScrShots 
            Height          =   435
            Left            =   8460
            TabIndex        =   25
            Top             =   3120
            Width           =   1935
            _ExtentX        =   3413
            _ExtentY        =   767
            Caption         =   "Random"
            ButtonStyle     =   3
            XPColor_Pressed =   15116940
            XPColor_Hover   =   4692449
         End
         Begin VB.CommandButton ComCap 
            Height          =   495
            Index           =   0
            Left            =   2820
            MousePointer    =   1  'Arrow
            Picture         =   "Form1.frx":14E5C
            Style           =   1  'Graphical
            TabIndex        =   35
            Top             =   4500
            Width           =   615
         End
         Begin VB.CommandButton ComFrontFace 
            Height          =   375
            Index           =   1
            Left            =   2400
            MousePointer    =   1  'Arrow
            Picture         =   "Form1.frx":15166
            Style           =   1  'Graphical
            TabIndex        =   34
            Top             =   4500
            Width           =   435
         End
         Begin VB.CommandButton ComFrontFaceFile 
            Height          =   375
            Index           =   1
            Left            =   1980
            MousePointer    =   1  'Arrow
            Picture         =   "Form1.frx":156F0
            Style           =   1  'Graphical
            TabIndex        =   33
            Top             =   4500
            Width           =   435
         End
         Begin VB.CommandButton ComKeyAvi 
            Appearance      =   0  'Flat
            Height          =   315
            Index           =   1
            Left            =   10020
            Picture         =   "Form1.frx":15C7A
            Style           =   1  'Graphical
            TabIndex        =   31
            Top             =   4020
            Width           =   375
         End
         Begin VB.CommandButton ComKeyAvi 
            Appearance      =   0  'Flat
            Height          =   315
            Index           =   0
            Left            =   10020
            Picture         =   "Form1.frx":163E4
            Style           =   1  'Graphical
            TabIndex        =   30
            Top             =   3660
            Width           =   375
         End
         Begin VB.PictureBox PicFrontFace 
            Appearance      =   0  'Flat
            AutoRedraw      =   -1  'True
            AutoSize        =   -1  'True
            BackColor       =   &H00808080&
            BorderStyle     =   0  'None
            ForeColor       =   &H80000008&
            Height          =   660
            Left            =   180
            MousePointer    =   99  'Custom
            ScaleHeight     =   44
            ScaleMode       =   3  'Pixel
            ScaleWidth      =   44
            TabIndex        =   122
            TabStop         =   0   'False
            Top             =   60
            Visible         =   0   'False
            Width           =   660
         End
         Begin VB.PictureBox picCanvas 
            Appearance      =   0  'Flat
            AutoRedraw      =   -1  'True
            BackColor       =   &H00808080&
            BorderStyle     =   0  'None
            ForeColor       =   &H80000008&
            Height          =   3525
            Left            =   0
            MouseIcon       =   "Form1.frx":16B4E
            MousePointer    =   99  'Custom
            ScaleHeight     =   235
            ScaleMode       =   3  'Pixel
            ScaleWidth      =   239
            TabIndex        =   118
            TabStop         =   0   'False
            Top             =   60
            Width           =   3585
            Begin VB.CommandButton ComX 
               Caption         =   "X"
               Height          =   315
               Index           =   3
               Left            =   0
               MousePointer    =   1  'Arrow
               TabIndex        =   170
               Top             =   0
               Width           =   315
            End
            Begin VB.CommandButton ComFrontFace 
               Height          =   375
               Index           =   0
               Left            =   3180
               MousePointer    =   1  'Arrow
               Picture         =   "Form1.frx":17418
               Style           =   1  'Graphical
               TabIndex        =   169
               Top             =   0
               Width           =   435
            End
            Begin VB.CommandButton ComFrontFaceFile 
               Height          =   375
               Index           =   0
               Left            =   2760
               MousePointer    =   1  'Arrow
               Picture         =   "Form1.frx":179A2
               Style           =   1  'Graphical
               TabIndex        =   168
               Top             =   0
               Width           =   435
            End
         End
         Begin VB.CheckBox ChLockFSHid 
            Alignment       =   1  'Right Justify
            Height          =   375
            Index           =   1
            Left            =   0
            TabIndex        =   27
            Top             =   4080
            Value           =   1  'Checked
            Width           =   195
         End
         Begin VB.CheckBox ChLockFSHid 
            Alignment       =   1  'Right Justify
            Height          =   315
            Index           =   0
            Left            =   0
            TabIndex        =   26
            Top             =   3720
            Width           =   195
         End
         Begin VB.PictureBox PicSS1 
            Appearance      =   0  'Flat
            AutoRedraw      =   -1  'True
            BackColor       =   &H00808080&
            BorderStyle     =   0  'None
            ForeColor       =   &H80000008&
            Height          =   2775
            Left            =   60
            MouseIcon       =   "Form1.frx":17F2C
            MousePointer    =   99  'Custom
            ScaleHeight     =   185
            ScaleMode       =   0  'User
            ScaleWidth      =   224
            TabIndex        =   115
            TabStop         =   0   'False
            Top             =   4620
            Width           =   3360
            Begin VB.CommandButton ComX 
               Caption         =   "X"
               Height          =   315
               Index           =   0
               Left            =   0
               MousePointer    =   1  'Arrow
               TabIndex        =   32
               Top             =   0
               Width           =   315
            End
            Begin VB.PictureBox Picture1 
               Height          =   0
               Left            =   0
               ScaleHeight     =   0
               ScaleWidth      =   0
               TabIndex        =   127
               Top             =   0
               Width           =   0
            End
         End
         Begin VB.PictureBox PicSS1Big 
            Appearance      =   0  'Flat
            AutoRedraw      =   -1  'True
            AutoSize        =   -1  'True
            BackColor       =   &H80000005&
            BorderStyle     =   0  'None
            ForeColor       =   &H80000008&
            Height          =   375
            Left            =   840
            ScaleHeight     =   25
            ScaleMode       =   3  'Pixel
            ScaleWidth      =   37
            TabIndex        =   114
            TabStop         =   0   'False
            Top             =   4440
            Visible         =   0   'False
            Width           =   555
         End
         Begin VB.PictureBox PicSS2Big 
            Appearance      =   0  'Flat
            AutoRedraw      =   -1  'True
            AutoSize        =   -1  'True
            BackColor       =   &H80000005&
            BorderStyle     =   0  'None
            ForeColor       =   &H80000008&
            Height          =   375
            Left            =   4320
            ScaleHeight     =   25
            ScaleMode       =   3  'Pixel
            ScaleWidth      =   37
            TabIndex        =   113
            TabStop         =   0   'False
            Top             =   4440
            Visible         =   0   'False
            Width           =   555
         End
         Begin VB.PictureBox PicSS3Big 
            Appearance      =   0  'Flat
            AutoRedraw      =   -1  'True
            AutoSize        =   -1  'True
            BackColor       =   &H80000005&
            BorderStyle     =   0  'None
            ForeColor       =   &H80000008&
            Height          =   375
            Left            =   7560
            ScaleHeight     =   25
            ScaleMode       =   3  'Pixel
            ScaleWidth      =   37
            TabIndex        =   112
            TabStop         =   0   'False
            Top             =   4380
            Visible         =   0   'False
            Width           =   555
         End
         Begin VB.OptionButton optAspect 
            Appearance      =   0  'Flat
            Caption         =   "w:h"
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   2
            Left            =   8700
            Style           =   1  'Graphical
            TabIndex        =   197
            Top             =   2760
            Width           =   495
         End
      End
      Begin VB.Frame FrAdEdTechHid 
         BorderStyle     =   0  'None
         Height          =   7695
         Left            =   120
         TabIndex        =   128
         Top             =   600
         Width           =   10455
         Begin VB.ComboBox cBasePicURL 
            Height          =   315
            ItemData        =   "Form1.frx":187F6
            Left            =   1380
            List            =   "Form1.frx":187F8
            Sorted          =   -1  'True
            TabIndex        =   81
            Top             =   4500
            Width           =   2895
         End
         Begin VB.TextBox TextMovURL 
            Height          =   315
            Left            =   1380
            MaxLength       =   255
            TabIndex        =   83
            Top             =   4980
            Width           =   6975
         End
         Begin VB.TextBox TextCoverURL 
            Height          =   315
            Left            =   4320
            MaxLength       =   255
            TabIndex        =   82
            Top             =   4500
            Width           =   4035
         End
         Begin VB.ComboBox ComboNos 
            Height          =   315
            ItemData        =   "Form1.frx":187FA
            Left            =   4260
            List            =   "Form1.frx":187FC
            Sorted          =   -1  'True
            TabIndex        =   72
            Top             =   120
            Width           =   4095
         End
         Begin VB.ComboBox TextUser 
            Height          =   315
            ItemData        =   "Form1.frx":187FE
            Left            =   1380
            List            =   "Form1.frx":18800
            Sorted          =   -1  'True
            Style           =   1  'Simple Combo
            TabIndex        =   84
            Top             =   5580
            Width           =   6975
         End
         Begin VB.TextBox CDSerialCur 
            Height          =   315
            Left            =   1380
            MaxLength       =   255
            TabIndex        =   73
            Top             =   540
            Width           =   6975
         End
         Begin VB.TextBox TextVideoHid 
            Height          =   315
            Left            =   1380
            MaxLength       =   255
            TabIndex        =   75
            Top             =   1620
            Width           =   6975
         End
         Begin VB.TextBox TextFilelenHid 
            Height          =   315
            Left            =   1380
            MaxLength       =   255
            TabIndex        =   80
            Top             =   3960
            Width           =   6975
         End
         Begin VB.TextBox TextFPSHid 
            Height          =   315
            Left            =   1380
            MaxLength       =   255
            TabIndex        =   77
            Top             =   2460
            Width           =   6975
         End
         Begin VB.TextBox TextAudioHid 
            Height          =   315
            Left            =   1380
            MaxLength       =   255
            TabIndex        =   78
            Top             =   3000
            Width           =   6975
         End
         Begin VB.TextBox TextResolHid 
            Height          =   315
            Left            =   1380
            MaxLength       =   255
            TabIndex        =   76
            Top             =   2040
            Width           =   6975
         End
         Begin VB.TextBox TextTimeHid 
            Height          =   315
            Left            =   1380
            TabIndex        =   74
            Top             =   1080
            Width           =   6495
         End
         Begin VB.TextBox TextCDN 
            Height          =   315
            Left            =   1380
            MaxLength       =   255
            TabIndex        =   71
            Top             =   120
            Width           =   2835
         End
         Begin VB.TextBox TextFileName 
            Height          =   315
            Left            =   1380
            ScrollBars      =   2  'Vertical
            TabIndex        =   79
            Top             =   3540
            Width           =   6975
         End
         Begin SurVideoCatalog.XpB ComInterGoHid 
            Height          =   375
            Index           =   1
            Left            =   8460
            TabIndex        =   144
            Top             =   4920
            Width           =   1935
            _ExtentX        =   3413
            _ExtentY        =   661
            Caption         =   ""
            ButtonStyle     =   3
            Picture         =   "Form1.frx":18802
            PictureWidth    =   16
            PictureHeight   =   16
            XPColor_Pressed =   15116940
            XPColor_Hover   =   4692449
            MaskColor       =   16711935
         End
         Begin SurVideoCatalog.XpB ComGetCover 
            Height          =   375
            Left            =   8460
            TabIndex        =   145
            Top             =   4470
            Width           =   1935
            _ExtentX        =   3413
            _ExtentY        =   661
            Caption         =   "Get"
            ButtonStyle     =   3
            Picture         =   "Form1.frx":18B56
            PictureWidth    =   16
            PictureHeight   =   16
            XPColor_Pressed =   15116940
            XPColor_Hover   =   4692449
            MaskColor       =   16711935
         End
         Begin SurVideoCatalog.XpB ComPlusHid 
            Height          =   300
            Index           =   2
            Left            =   7980
            TabIndex        =   171
            Top             =   1080
            Width           =   315
            _ExtentX        =   265
            _ExtentY        =   265
            Caption         =   "+"
            ButtonStyle     =   3
            XPColor_Pressed =   15116940
            XPColor_Hover   =   4692449
         End
         Begin VB.Label LTech 
            Caption         =   "MovieURL"
            Height          =   255
            Index           =   10
            Left            =   60
            TabIndex        =   140
            Top             =   5040
            Width           =   1275
         End
         Begin VB.Label LTech 
            Caption         =   "CoverURL"
            Height          =   255
            Index           =   9
            Left            =   60
            TabIndex        =   139
            Top             =   4560
            Width           =   1275
         End
         Begin VB.Label LTech 
            Caption         =   "Debtor"
            Height          =   255
            Index           =   11
            Left            =   60
            TabIndex        =   138
            Top             =   5640
            Width           =   1215
         End
         Begin VB.Label LTech 
            Caption         =   "SN"
            Height          =   255
            Index           =   1
            Left            =   60
            TabIndex        =   137
            Top             =   600
            Width           =   1275
         End
         Begin VB.Label LTech 
            Caption         =   "Video"
            Height          =   255
            Index           =   3
            Left            =   60
            TabIndex        =   136
            Top             =   1680
            Width           =   1275
         End
         Begin VB.Label LTech 
            Caption         =   "Size"
            Height          =   255
            Index           =   8
            Left            =   60
            TabIndex        =   135
            Top             =   4020
            Width           =   1275
         End
         Begin VB.Label LTech 
            Caption         =   "FPS"
            Height          =   255
            Index           =   5
            Left            =   60
            TabIndex        =   134
            Top             =   2520
            Width           =   1275
         End
         Begin VB.Label LTech 
            Caption         =   "Audio"
            Height          =   255
            Index           =   6
            Left            =   60
            TabIndex        =   133
            Top             =   3060
            Width           =   1275
         End
         Begin VB.Label LTech 
            Caption         =   "Resol"
            Height          =   255
            Index           =   4
            Left            =   60
            TabIndex        =   132
            Top             =   2100
            Width           =   1275
         End
         Begin VB.Label LTech 
            Caption         =   "Length"
            Height          =   255
            Index           =   2
            Left            =   60
            TabIndex        =   131
            Top             =   1140
            Width           =   1275
         End
         Begin VB.Label LTech 
            Caption         =   "NNCD"
            Height          =   255
            Index           =   0
            Left            =   60
            TabIndex        =   130
            Top             =   180
            Width           =   1215
         End
         Begin VB.Label LTech 
            Caption         =   "File"
            Height          =   255
            Index           =   7
            Left            =   60
            TabIndex        =   129
            Top             =   3600
            Width           =   1215
         End
      End
      Begin VB.Frame FrAdEdTextHid 
         BorderStyle     =   0  'None
         Height          =   7755
         Left            =   120
         TabIndex        =   102
         Top             =   600
         Width           =   10455
         Begin VB.ComboBox ComboOther 
            Height          =   315
            ItemData        =   "Form1.frx":19568
            Left            =   5400
            List            =   "Form1.frx":1956A
            Sorted          =   -1  'True
            TabIndex        =   193
            Top             =   3420
            Width           =   2535
         End
         Begin VB.CheckBox ChInFilFl 
            Alignment       =   1  'Right Justify
            Caption         =   "Empty"
            Height          =   255
            Left            =   3720
            TabIndex        =   172
            Top             =   3840
            Value           =   1  'Checked
            Width           =   4815
         End
         Begin VB.ComboBox TextRate 
            Height          =   315
            ItemData        =   "Form1.frx":1956C
            Left            =   1380
            List            =   "Form1.frx":1956E
            Sorted          =   -1  'True
            Style           =   1  'Simple Combo
            TabIndex        =   59
            Top             =   3060
            Width           =   2775
         End
         Begin VB.ComboBox TextSubt 
            Height          =   315
            ItemData        =   "Form1.frx":19570
            Left            =   5400
            List            =   "Form1.frx":19572
            Sorted          =   -1  'True
            Style           =   1  'Simple Combo
            TabIndex        =   60
            Top             =   3060
            Width           =   2955
         End
         Begin VB.ComboBox TextLang 
            Height          =   315
            ItemData        =   "Form1.frx":19574
            Left            =   5400
            List            =   "Form1.frx":19576
            Sorted          =   -1  'True
            Style           =   1  'Simple Combo
            TabIndex        =   58
            Top             =   2700
            Width           =   2955
         End
         Begin VB.TextBox TextRole 
            Height          =   735
            Left            =   1380
            MultiLine       =   -1  'True
            TabIndex        =   56
            Top             =   1920
            Width           =   6975
         End
         Begin SurVideoCatalog.XpB ComClsEd 
            Height          =   315
            Left            =   1380
            TabIndex        =   62
            Top             =   3780
            Width           =   2055
            _ExtentX        =   3625
            _ExtentY        =   556
            Caption         =   "Clear"
            PicturePosition =   0
            ButtonStyle     =   3
            PictureWidth    =   0
            PictureHeight   =   0
            ShowFocusRect   =   0   'False
            XPColor_Pressed =   15116940
            XPColor_Hover   =   4692449
            MaskColor       =   16777215
         End
         Begin VB.ComboBox TextMName 
            Height          =   315
            ItemData        =   "Form1.frx":19578
            Left            =   1380
            List            =   "Form1.frx":1957A
            Sorted          =   -1  'True
            Style           =   1  'Simple Combo
            TabIndex        =   47
            Top             =   120
            Width           =   6975
         End
         Begin VB.ComboBox TextCountry 
            Height          =   315
            ItemData        =   "Form1.frx":1957C
            Left            =   1380
            List            =   "Form1.frx":1957E
            Sorted          =   -1  'True
            Style           =   1  'Simple Combo
            TabIndex        =   52
            Top             =   1200
            Width           =   3975
         End
         Begin VB.ComboBox TextOther 
            Height          =   315
            ItemData        =   "Form1.frx":19580
            Left            =   1380
            List            =   "Form1.frx":19582
            Sorted          =   -1  'True
            Style           =   1  'Simple Combo
            TabIndex        =   61
            Top             =   3420
            Width           =   3975
         End
         Begin VB.Frame FrInetInfo 
            Caption         =   "IFind"
            Height          =   3075
            Left            =   5040
            TabIndex        =   123
            Top             =   4140
            Width           =   5415
            Begin VB.CommandButton ComRHid 
               Caption         =   "G"
               Height          =   315
               Index           =   1
               Left            =   4980
               TabIndex        =   183
               Top             =   240
               Width           =   375
            End
            Begin VB.TextBox TxtIName 
               Height          =   315
               Left            =   1200
               TabIndex        =   64
               Top             =   240
               Width           =   3735
            End
            Begin VB.ListBox lbInetMovieList 
               Height          =   1815
               ItemData        =   "Form1.frx":19584
               Left            =   120
               List            =   "Form1.frx":19586
               TabIndex        =   67
               Top             =   1080
               Width           =   5175
            End
            Begin SurVideoCatalog.XpB ComInetFind 
               Height          =   315
               Left            =   3840
               TabIndex        =   66
               Top             =   660
               Width           =   1455
               _ExtentX        =   2566
               _ExtentY        =   556
               Caption         =   "Find"
               ButtonStyle     =   3
               Picture         =   "Form1.frx":19588
               PictureWidth    =   16
               PictureHeight   =   16
               XPColor_Pressed =   15116940
               XPColor_Hover   =   4692449
            End
            Begin VB.ComboBox ComboInfoSites 
               Height          =   315
               ItemData        =   "Form1.frx":196E2
               Left            =   105
               List            =   "Form1.frx":196E4
               Sorted          =   -1  'True
               TabIndex        =   65
               Top             =   660
               Width           =   3615
            End
            Begin VB.Label LIName 
               Caption         =   "Title"
               Height          =   375
               Left            =   120
               TabIndex        =   124
               Top             =   240
               Width           =   975
            End
         End
         Begin VB.ComboBox TextYear 
            Height          =   315
            ItemData        =   "Form1.frx":196E6
            Left            =   1380
            List            =   "Form1.frx":196E8
            Sorted          =   -1  'True
            Style           =   1  'Simple Combo
            TabIndex        =   57
            Top             =   2700
            Width           =   2775
         End
         Begin VB.ComboBox TextAuthor 
            Height          =   315
            ItemData        =   "Form1.frx":196EA
            Left            =   1380
            List            =   "Form1.frx":196EC
            Sorted          =   -1  'True
            Style           =   1  'Simple Combo
            TabIndex        =   55
            Top             =   1560
            Width           =   6975
         End
         Begin VB.ComboBox TextGenre 
            Height          =   315
            ItemData        =   "Form1.frx":196EE
            Left            =   1380
            List            =   "Form1.frx":196F0
            Sorted          =   -1  'True
            Style           =   1  'Simple Combo
            TabIndex        =   49
            Top             =   840
            Width           =   3975
         End
         Begin VB.ComboBox TextLabel 
            Height          =   315
            ItemData        =   "Form1.frx":196F2
            Left            =   1380
            List            =   "Form1.frx":196F4
            Sorted          =   -1  'True
            Style           =   1  'Simple Combo
            TabIndex        =   48
            Top             =   480
            Width           =   6975
         End
         Begin SurVideoCatalog.XpB ComShowBin 
            Height          =   435
            Left            =   6300
            TabIndex        =   70
            Top             =   7260
            Width           =   4035
            _ExtentX        =   7117
            _ExtentY        =   767
            Caption         =   "drag-and-drop"
            ButtonStyle     =   3
            Picture         =   "Form1.frx":196F6
            PictureWidth    =   16
            PictureHeight   =   16
            XPColor_Pressed =   15116940
            XPColor_Hover   =   4692449
         End
         Begin SurVideoCatalog.XpB ComInterGoHid 
            Height          =   435
            Index           =   0
            Left            =   5640
            TabIndex        =   69
            Top             =   7260
            Width           =   555
            _ExtentX        =   979
            _ExtentY        =   767
            Caption         =   ""
            ButtonStyle     =   3
            Picture         =   "Form1.frx":19C90
            PictureWidth    =   16
            PictureHeight   =   16
            XPColor_Pressed =   15116940
            XPColor_Hover   =   4692449
            MaskColor       =   16711935
         End
         Begin VB.ComboBox ComboSites 
            Height          =   315
            Left            =   60
            TabIndex        =   68
            Top             =   7320
            Width           =   5475
         End
         Begin VB.ComboBox ComboCountry 
            Height          =   315
            ItemData        =   "Form1.frx":19FE4
            Left            =   5400
            List            =   "Form1.frx":19FE6
            Sorted          =   -1  'True
            TabIndex        =   53
            Top             =   1200
            Width           =   2535
         End
         Begin SurVideoCatalog.XpB ComPlusHid 
            Height          =   300
            Index           =   0
            Left            =   8040
            TabIndex        =   51
            Top             =   840
            Width           =   315
            _ExtentX        =   265
            _ExtentY        =   265
            Caption         =   "+"
            ButtonStyle     =   3
            XPColor_Pressed =   15116940
            XPColor_Hover   =   4692449
         End
         Begin VB.TextBox TextAnnotation 
            Height          =   3015
            Left            =   60
            MultiLine       =   -1  'True
            ScrollBars      =   2  'Vertical
            TabIndex        =   63
            Top             =   4200
            Width           =   4890
         End
         Begin VB.ComboBox ComboGenre 
            Height          =   315
            ItemData        =   "Form1.frx":19FE8
            Left            =   5400
            List            =   "Form1.frx":19FEA
            Sorted          =   -1  'True
            TabIndex        =   50
            Top             =   840
            Width           =   2535
         End
         Begin SurVideoCatalog.XpB ComPlusHid 
            Height          =   300
            Index           =   1
            Left            =   8040
            TabIndex        =   54
            Top             =   1200
            Width           =   315
            _ExtentX        =   265
            _ExtentY        =   265
            Caption         =   "+"
            ButtonStyle     =   3
            XPColor_Pressed =   15116940
            XPColor_Hover   =   4692449
         End
         Begin SurVideoCatalog.XpB ComPlusHid 
            Height          =   300
            Index           =   3
            Left            =   8040
            TabIndex        =   192
            Top             =   3420
            Width           =   315
            _ExtentX        =   265
            _ExtentY        =   265
            Caption         =   "+"
            ButtonStyle     =   3
            XPColor_Pressed =   15116940
            XPColor_Hover   =   4692449
         End
         Begin VB.Label LSubt 
            Alignment       =   1  'Right Justify
            Caption         =   "Subtitle"
            Height          =   255
            Left            =   4260
            TabIndex        =   143
            Top             =   3120
            Width           =   1035
         End
         Begin VB.Label LLang 
            Alignment       =   1  'Right Justify
            Caption         =   "Language"
            Height          =   255
            Left            =   4260
            TabIndex        =   142
            Top             =   2760
            Width           =   1035
         End
         Begin VB.Label LRate 
            Caption         =   "Rating"
            Height          =   255
            Left            =   120
            TabIndex        =   141
            Top             =   3120
            Width           =   1215
         End
         Begin VB.Label LOther 
            Caption         =   "Comments"
            Height          =   255
            Left            =   120
            TabIndex        =   126
            Top             =   3480
            Width           =   1215
         End
         Begin VB.Label LYear 
            Caption         =   "Year"
            Height          =   255
            Left            =   120
            TabIndex        =   110
            Top             =   2760
            Width           =   1155
         End
         Begin VB.Label LAct 
            Caption         =   "Actors"
            Height          =   255
            Left            =   120
            TabIndex        =   109
            Top             =   1980
            Width           =   1215
         End
         Begin VB.Label LCountry 
            Caption         =   "Country"
            Height          =   255
            Left            =   120
            TabIndex        =   108
            Top             =   1260
            Width           =   1155
         End
         Begin VB.Label LRes 
            Caption         =   "Director"
            Height          =   255
            Left            =   120
            TabIndex        =   107
            Top             =   1620
            Width           =   1215
         End
         Begin VB.Label LAnnot 
            Caption         =   "Descr"
            Height          =   255
            Left            =   120
            TabIndex        =   106
            Top             =   3840
            Width           =   1095
         End
         Begin VB.Label LLabel 
            Caption         =   "Label"
            Height          =   255
            Left            =   120
            TabIndex        =   105
            Top             =   540
            Width           =   1155
         End
         Begin VB.Label LMName 
            Caption         =   "Title"
            Height          =   255
            Left            =   120
            TabIndex        =   104
            Top             =   180
            Width           =   1095
         End
         Begin VB.Label LGenre 
            Caption         =   "Genre"
            Height          =   255
            Left            =   120
            TabIndex        =   103
            Top             =   900
            Width           =   1095
         End
      End
      Begin MSComctlLib.TabStrip TabStrAdEd 
         Height          =   8235
         Left            =   60
         TabIndex        =   101
         Top             =   240
         Width           =   10575
         _ExtentX        =   18653
         _ExtentY        =   14526
         TabWidthStyle   =   2
         TabFixedWidth   =   5997
         Separators      =   -1  'True
         _Version        =   393216
         BeginProperty Tabs {1EFB6598-857C-11D1-B16A-00C0F0283628} 
            NumTabs         =   3
            BeginProperty Tab1 {1EFB659A-857C-11D1-B16A-00C0F0283628} 
               Caption         =   "Video"
               ImageVarType    =   2
            EndProperty
            BeginProperty Tab2 {1EFB659A-857C-11D1-B16A-00C0F0283628} 
               Caption         =   "Info"
               ImageVarType    =   2
            EndProperty
            BeginProperty Tab3 {1EFB659A-857C-11D1-B16A-00C0F0283628} 
               Caption         =   "Tech"
               ImageVarType    =   2
            EndProperty
         EndProperty
      End
   End
   Begin VB.Frame FrameCover 
      Caption         =   "Cover"
      Height          =   8535
      Left            =   1260
      TabIndex        =   89
      Top             =   0
      Width           =   10665
      Begin VB.PictureBox PicCoverTemp 
         Appearance      =   0  'Flat
         AutoRedraw      =   -1  'True
         BackColor       =   &H80000005&
         BorderStyle     =   0  'None
         ForeColor       =   &H80000008&
         Height          =   1635
         Left            =   360
         ScaleHeight     =   1635
         ScaleWidth      =   2295
         TabIndex        =   121
         TabStop         =   0   'False
         Top             =   4920
         Visible         =   0   'False
         Width           =   2295
      End
      Begin VB.PictureBox PicPrintScroll 
         Height          =   4185
         Left            =   60
         ScaleHeight     =   4125
         ScaleWidth      =   10155
         TabIndex        =   91
         Top             =   240
         Width           =   10215
         Begin VB.PictureBox PicCoverPaper 
            Appearance      =   0  'Flat
            AutoRedraw      =   -1  'True
            BackColor       =   &H00FFFFFF&
            BorderStyle     =   0  'None
            ForeColor       =   &H00000000&
            Height          =   16860
            Left            =   120
            ScaleHeight     =   297.392
            ScaleMode       =   6  'Millimeter
            ScaleWidth      =   210.609
            TabIndex        =   92
            Top             =   120
            Width           =   11940
            Begin VB.PictureBox PicCoverTextWnd 
               Appearance      =   0  'Flat
               AutoRedraw      =   -1  'True
               BackColor       =   &H00C0FFFF&
               ForeColor       =   &H00000000&
               Height          =   2115
               Left            =   540
               ScaleHeight     =   36.777
               ScaleMode       =   6  'Millimeter
               ScaleWidth      =   81.227
               TabIndex        =   120
               Top             =   720
               Visible         =   0   'False
               Width           =   4635
            End
         End
      End
      Begin VB.Frame FrPrintBotHid 
         BorderStyle     =   0  'None
         Height          =   1665
         Left            =   240
         TabIndex        =   90
         Top             =   6696
         Width           =   10155
         Begin VB.CheckBox chPrnAllOne 
            Caption         =   "All in 1"
            Height          =   255
            Left            =   3420
            TabIndex        =   18
            Top             =   1080
            Width           =   4035
         End
         Begin VB.CheckBox ChCentrP 
            Caption         =   "Centre"
            Height          =   255
            Left            =   0
            TabIndex        =   16
            Top             =   1440
            Value           =   1  'Checked
            Width           =   3015
         End
         Begin VB.CheckBox ChPrintChecked 
            Caption         =   "All"
            Height          =   255
            Left            =   3420
            TabIndex        =   17
            Top             =   780
            Width           =   3855
         End
         Begin VB.CheckBox ChPrintPix 
            Caption         =   "Cover"
            Height          =   255
            Left            =   0
            TabIndex        =   13
            Top             =   720
            Value           =   1  'Checked
            Width           =   3015
         End
         Begin SurVideoCatalog.XpB CmdPrint 
            Height          =   495
            Left            =   8040
            TabIndex        =   19
            Top             =   840
            Width           =   2055
            _ExtentX        =   3625
            _ExtentY        =   873
            Caption         =   "Printer"
            ButtonStyle     =   3
            Picture         =   "Form1.frx":19FEC
            PictureWidth    =   16
            PictureHeight   =   16
            XPColor_Pressed =   15116940
            XPColor_Hover   =   4692449
            MaskColor       =   16711935
         End
         Begin VB.CheckBox ChScaleP 
            Caption         =   "Scale"
            Height          =   255
            Left            =   0
            TabIndex        =   14
            Top             =   960
            Value           =   1  'Checked
            Width           =   3015
         End
         Begin VB.CheckBox ChPropP 
            Caption         =   "Aspect"
            Height          =   255
            Left            =   0
            TabIndex        =   15
            Top             =   1200
            Width           =   3015
         End
         Begin MSComctlLib.TabStrip TabStripCover 
            Height          =   375
            Left            =   0
            TabIndex        =   12
            Top             =   180
            Width           =   9975
            _ExtentX        =   17595
            _ExtentY        =   688
            TabMinWidth     =   1764
            _Version        =   393216
            BeginProperty Tabs {1EFB6598-857C-11D1-B16A-00C0F0283628} 
               NumTabs         =   4
               BeginProperty Tab1 {1EFB659A-857C-11D1-B16A-00C0F0283628} 
                  Caption         =   "Standart"
                  ImageVarType    =   2
               EndProperty
               BeginProperty Tab2 {1EFB659A-857C-11D1-B16A-00C0F0283628} 
                  Caption         =   "Letter"
                  ImageVarType    =   2
               EndProperty
               BeginProperty Tab3 {1EFB659A-857C-11D1-B16A-00C0F0283628} 
                  Caption         =   "DVD"
                  ImageVarType    =   2
               EndProperty
               BeginProperty Tab4 {1EFB659A-857C-11D1-B16A-00C0F0283628} 
                  Caption         =   "List"
                  ImageVarType    =   2
               EndProperty
            EndProperty
         End
      End
      Begin VB.Image ImBlankHid 
         Height          =   24
         Left            =   2880
         Picture         =   "Form1.frx":1A33E
         Top             =   7920
         Width           =   24
      End
   End
   Begin SurVideoCatalog.MyFrame FrameView 
      Height          =   8535
      Left            =   1260
      TabIndex        =   147
      Top             =   0
      Width           =   10665
      _ExtentX        =   18812
      _ExtentY        =   15055
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ScaleWidth      =   4254,553
      ScaleHeight     =   4068,98
      Begin SurVideoCatalog.UCLVaddon UCLV 
         Height          =   4455
         Left            =   6420
         TabIndex        =   167
         Top             =   600
         Width           =   4035
         _ExtentX        =   7117
         _ExtentY        =   7858
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   204
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin MSComctlLib.ListView tvGroup 
         Height          =   4455
         Left            =   60
         TabIndex        =   166
         Top             =   600
         Width           =   2475
         _ExtentX        =   4366
         _ExtentY        =   7858
         View            =   3
         LabelEdit       =   1
         LabelWrap       =   0   'False
         HideSelection   =   0   'False
         FullRowSelect   =   -1  'True
         _Version        =   393217
         ForeColor       =   -2147483640
         BackColor       =   12648447
         BorderStyle     =   1
         Appearance      =   0
         NumItems        =   2
         BeginProperty ColumnHeader(1) {BDD1F052-858B-11D1-B16A-00C0F0283628} 
            Object.Width           =   2646
         EndProperty
         BeginProperty ColumnHeader(2) {BDD1F052-858B-11D1-B16A-00C0F0283628} 
            SubItemIndex    =   1
            Text            =   "<>"
            Object.Width           =   1235
         EndProperty
      End
      Begin MSComctlLib.ListView ListView 
         Height          =   4455
         Left            =   2700
         TabIndex        =   10
         Top             =   600
         Width           =   3555
         _ExtentX        =   6297
         _ExtentY        =   7858
         View            =   3
         LabelEdit       =   1
         LabelWrap       =   0   'False
         HideSelection   =   0   'False
         OLEDragMode     =   1
         AllowReorder    =   -1  'True
         Checkboxes      =   -1  'True
         FullRowSelect   =   -1  'True
         _Version        =   393217
         SmallIcons      =   "ImageList"
         ForeColor       =   -2147483640
         BackColor       =   12648447
         BorderStyle     =   1
         Appearance      =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   204
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         OLEDragMode     =   1
         NumItems        =   0
      End
      Begin VB.Frame PicSplitLVDHid 
         BorderStyle     =   0  'None
         Height          =   3435
         Left            =   60
         TabIndex        =   148
         Top             =   5100
         Width           =   10575
         Begin VB.TextBox TextVAnnot 
            BackColor       =   &H00C0FFFF&
            ForeColor       =   &H00000000&
            Height          =   2895
            HideSelection   =   0   'False
            Left            =   4680
            MultiLine       =   -1  'True
            ScrollBars      =   2  'Vertical
            TabIndex        =   191
            Top             =   420
            Width           =   3510
         End
         Begin VB.PictureBox picScrollBoxV 
            AutoRedraw      =   -1  'True
            AutoSize        =   -1  'True
            BackColor       =   &H00808080&
            Height          =   2880
            Left            =   3420
            ScaleHeight     =   2820
            ScaleWidth      =   4215
            TabIndex        =   187
            TabStop         =   0   'False
            Top             =   420
            Visible         =   0   'False
            Width           =   4275
            Begin VB.PictureBox PicTempHid 
               Appearance      =   0  'Flat
               AutoRedraw      =   -1  'True
               AutoSize        =   -1  'True
               BackColor       =   &H80000005&
               BorderStyle     =   0  'None
               ForeColor       =   &H80000008&
               Height          =   1395
               Index           =   1
               Left            =   3300
               ScaleHeight     =   93
               ScaleMode       =   3  'Pixel
               ScaleWidth      =   85
               TabIndex        =   190
               Top             =   0
               Visible         =   0   'False
               Width           =   1275
            End
            Begin VB.PictureBox PicFaceV 
               Appearance      =   0  'Flat
               AutoRedraw      =   -1  'True
               AutoSize        =   -1  'True
               BackColor       =   &H00808080&
               BorderStyle     =   0  'None
               ForeColor       =   &H80000008&
               Height          =   2295
               Left            =   0
               MouseIcon       =   "Form1.frx":1A392
               MousePointer    =   99  'Custom
               ScaleHeight     =   40.481
               ScaleMode       =   6  'Millimeter
               ScaleWidth      =   47.096
               TabIndex        =   189
               TabStop         =   0   'False
               Top             =   0
               Width           =   2670
            End
            Begin VB.PictureBox PicTempHid 
               Appearance      =   0  'Flat
               AutoRedraw      =   -1  'True
               AutoSize        =   -1  'True
               BackColor       =   &H80000005&
               BorderStyle     =   0  'None
               ForeColor       =   &H80000008&
               Height          =   1395
               Index           =   0
               Left            =   1740
               ScaleHeight     =   93
               ScaleMode       =   3  'Pixel
               ScaleWidth      =   85
               TabIndex        =   188
               Top             =   0
               Visible         =   0   'False
               Width           =   1275
            End
         End
         Begin VB.Frame FrameImageHid 
            BackColor       =   &H00000000&
            BorderStyle     =   0  'None
            Height          =   2895
            Left            =   0
            TabIndex        =   185
            Top             =   420
            Width           =   3360
            Begin VB.PictureBox Image0 
               Appearance      =   0  'Flat
               AutoRedraw      =   -1  'True
               BackColor       =   &H00000000&
               BorderStyle     =   0  'None
               ClipControls    =   0   'False
               FillColor       =   &H00808080&
               ForeColor       =   &H00C0C0C0&
               Height          =   1755
               Left            =   0
               MouseIcon       =   "Form1.frx":1AC5C
               MousePointer    =   99  'Custom
               ScaleHeight     =   1755
               ScaleWidth      =   2760
               TabIndex        =   186
               TabStop         =   0   'False
               Top             =   0
               Width           =   2760
            End
         End
         Begin VB.Frame FrSplitD_Vert 
            BorderStyle     =   0  'None
            ClipControls    =   0   'False
            Height          =   2355
            Left            =   3360
            TabIndex        =   184
            Top             =   720
            Width           =   60
         End
         Begin VB.Frame FrFindViewHid 
            BorderStyle     =   0  'None
            Height          =   2832
            Left            =   8340
            TabIndex        =   150
            Top             =   420
            Width           =   1935
            Begin VB.Frame FrameSearch 
               Caption         =   "Search"
               Height          =   1695
               Left            =   0
               TabIndex        =   152
               Top             =   1080
               Width           =   1935
               Begin VB.CheckBox ChMarkFindHid 
                  Height          =   255
                  Left            =   120
                  TabIndex        =   155
                  Top             =   1380
                  Width           =   195
               End
               Begin VB.TextBox TextFind 
                  BackColor       =   &H00FFFFFF&
                  Height          =   345
                  Left            =   120
                  TabIndex        =   154
                  Top             =   600
                  Width           =   1695
               End
               Begin VB.ComboBox CombFind 
                  Height          =   315
                  ItemData        =   "Form1.frx":1B526
                  Left            =   120
                  List            =   "Form1.frx":1B528
                  TabIndex        =   153
                  Top             =   240
                  Width           =   1695
               End
               Begin SurVideoCatalog.XpB ComNext 
                  Height          =   255
                  Left            =   420
                  TabIndex        =   156
                  Top             =   1380
                  Width           =   1395
                  _ExtentX        =   265
                  _ExtentY        =   265
                  Caption         =   ">"
                  ButtonStyle     =   3
                  XPColor_Pressed =   15116940
                  XPColor_Hover   =   4692449
               End
               Begin SurVideoCatalog.XpB ComFind 
                  Height          =   315
                  Left            =   120
                  TabIndex        =   157
                  Top             =   1020
                  Width           =   1695
                  _ExtentX        =   2990
                  _ExtentY        =   556
                  Caption         =   "Find"
                  ButtonStyle     =   3
                  Picture         =   "Form1.frx":1B52A
                  PictureWidth    =   16
                  PictureHeight   =   16
                  XPColor_Pressed =   15116940
                  XPColor_Hover   =   4692449
               End
            End
            Begin SurVideoCatalog.XpB ComPlay 
               Height          =   315
               Left            =   0
               TabIndex        =   158
               Top             =   720
               Width           =   1875
               _ExtentX        =   265
               _ExtentY        =   265
               Caption         =   "Play"
               ButtonStyle     =   3
               Picture         =   "Form1.frx":1B684
               PictureWidth    =   16
               PictureHeight   =   16
               XPColor_Pressed =   15116940
               XPColor_Hover   =   4692449
            End
            Begin SurVideoCatalog.XpB ComFilter 
               Height          =   315
               Left            =   0
               TabIndex        =   159
               Top             =   360
               Width           =   1875
               _ExtentX        =   265
               _ExtentY        =   265
               Caption         =   "Filter"
               ButtonStyle     =   3
               Picture         =   "Form1.frx":1BC1E
               PictureWidth    =   16
               PictureHeight   =   16
               XPColor_Pressed =   15116940
               XPColor_Hover   =   4692449
            End
            Begin SurVideoCatalog.XpB ComShowFa 
               Height          =   315
               Left            =   0
               TabIndex        =   160
               Top             =   0
               Width           =   1875
               _ExtentX        =   3307
               _ExtentY        =   556
               Caption         =   "Cover"
               ButtonStyle     =   3
               Picture         =   "Form1.frx":1C1B8
               PictureWidth    =   16
               PictureHeight   =   16
               XPColor_Pressed =   15116940
               XPColor_Hover   =   4692449
            End
            Begin SurVideoCatalog.XpB ComShowAn 
               Height          =   315
               Left            =   0
               TabIndex        =   161
               Top             =   0
               Width           =   1875
               _ExtentX        =   265
               _ExtentY        =   265
               Caption         =   "Descr"
               ButtonStyle     =   3
               Picture         =   "Form1.frx":1C752
               PictureWidth    =   16
               PictureHeight   =   16
               XPColor_Pressed =   15116940
               XPColor_Hover   =   4692449
            End
            Begin VB.ListBox LstFiles 
               Appearance      =   0  'Flat
               BackColor       =   &H00C0FFFF&
               Height          =   1590
               ItemData        =   "Form1.frx":1CCEC
               Left            =   0
               List            =   "Form1.frx":1CCEE
               TabIndex        =   151
               Top             =   1080
               Visible         =   0   'False
               Width           =   1935
            End
         End
         Begin VB.TextBox TextItemHid 
            Appearance      =   0  'Flat
            BackColor       =   &H00C0FFFF&
            ForeColor       =   &H00800000&
            Height          =   345
            Left            =   0
            ScrollBars      =   2  'Vertical
            TabIndex        =   149
            Top             =   0
            Width           =   9255
         End
         Begin MSComctlLib.ProgressBar PBar 
            Height          =   255
            Left            =   8280
            TabIndex        =   162
            Top             =   60
            Width           =   1935
            _ExtentX        =   3413
            _ExtentY        =   450
            _Version        =   393216
            Appearance      =   0
            Enabled         =   0   'False
            Min             =   1
         End
      End
      Begin MSComctlLib.TabStrip TabLVHid 
         Height          =   315
         Left            =   60
         TabIndex        =   164
         Top             =   240
         Width           =   7875
         _ExtentX        =   13917
         _ExtentY        =   556
         Style           =   1
         ShowTips        =   0   'False
         HotTracking     =   -1  'True
         TabMinWidth     =   2293
         _Version        =   393216
         BeginProperty Tabs {1EFB6598-857C-11D1-B16A-00C0F0283628} 
            NumTabs         =   1
            BeginProperty Tab1 {1EFB659A-857C-11D1-B16A-00C0F0283628} 
               ImageVarType    =   2
            EndProperty
         EndProperty
         OLEDropMode     =   1
      End
      Begin VB.Frame FrLV_Vert 
         BorderStyle     =   0  'None
         ClipControls    =   0   'False
         Height          =   3495
         Left            =   6300
         TabIndex        =   163
         Top             =   600
         Width           =   75
      End
      Begin VB.Frame FrTV_Vert 
         BorderStyle     =   0  'None
         ClipControls    =   0   'False
         Height          =   3495
         Left            =   2580
         TabIndex        =   165
         Top             =   600
         Width           =   75
      End
   End
   Begin VB.Menu popCoverHid 
      Caption         =   "popCover"
      Visible         =   0   'False
      Begin VB.Menu mnuCoverSave 
         Caption         =   "Save As"
      End
      Begin VB.Menu mnuCoverCopy 
         Caption         =   "Copy"
      End
   End
   Begin VB.Menu popMovieHid 
      Caption         =   "popMovie"
      Visible         =   0   'False
      Begin VB.Menu mnuMovieSaveFrame 
         Caption         =   "Save As"
      End
      Begin VB.Menu mnuMovieCopyClip 
         Caption         =   "Copy"
      End
   End
   Begin VB.Menu popFaceHid 
      Caption         =   "popFace"
      Visible         =   0   'False
      Begin VB.Menu mnuSaveFace 
         Caption         =   "Save As"
      End
      Begin VB.Menu mnuCopyFace 
         Caption         =   "Copy"
      End
   End
   Begin VB.Menu popActHid 
      Caption         =   "popAct"
      Visible         =   0   'False
      Begin VB.Menu mnuSaveFoto 
         Caption         =   "Save as"
      End
      Begin VB.Menu mnuCopyFoto 
         Caption         =   "Copy"
      End
   End
   Begin VB.Menu popLVHid 
      Caption         =   "popLV"
      Visible         =   0   'False
      Begin VB.Menu mnuPlayM 
         Caption         =   "Play"
         Shortcut        =   ^M
      End
      Begin VB.Menu mGotoURL 
         Caption         =   "URL"
      End
      Begin VB.Menu m1Hid 
         Caption         =   "-"
      End
      Begin VB.Menu mnuEditMov 
         Caption         =   "Edit"
         Shortcut        =   ^E
      End
      Begin VB.Menu mnuAddNewMov 
         Caption         =   "Add"
         Shortcut        =   ^N
      End
      Begin VB.Menu mnuAddNewAuto 
         Caption         =   "Add Auto"
      End
      Begin VB.Menu mSR 
         Caption         =   "Search"
         Shortcut        =   ^F
      End
      Begin VB.Menu m20Hid 
         Caption         =   "-"
      End
      Begin VB.Menu mnuCard 
         Caption         =   "Movie Card"
      End
      Begin VB.Menu mnuGroup 
         Caption         =   "Groups"
      End
      Begin VB.Menu m2Hid 
         Caption         =   "-"
      End
      Begin VB.Menu mnuLVChecked 
         Caption         =   "Checked"
         Begin VB.Menu mChSel 
            Caption         =   "Check selected"
            Shortcut        =   ^Z
         End
         Begin VB.Menu mUnChSel 
            Caption         =   "UnCheck selected"
         End
         Begin VB.Menu mnuCheckAll 
            Caption         =   "All"
            Shortcut        =   ^B
         End
         Begin VB.Menu mnuCheckNone 
            Caption         =   "None"
            Shortcut        =   ^D
         End
         Begin VB.Menu mInvCh 
            Caption         =   "Invert"
            Shortcut        =   ^I
         End
         Begin VB.Menu mnuSortChecked 
            Caption         =   "Sort"
            Shortcut        =   ^S
         End
         Begin VB.Menu m3Hid 
            Caption         =   "-"
         End
         Begin VB.Menu mnuDolgCheck 
            Caption         =   "Set Debtor"
            Shortcut        =   ^Y
         End
         Begin VB.Menu mnuLabelCheck 
            Caption         =   "Set Label"
            Shortcut        =   ^K
         End
         Begin VB.Menu mGetCoverCh 
            Caption         =   "Get Cover"
            Shortcut        =   ^R
         End
         Begin VB.Menu m4Hid 
            Caption         =   "-"
         End
         Begin VB.Menu mnuExportCheckClip 
            Caption         =   "Clipboard"
            Shortcut        =   ^X
         End
         Begin VB.Menu mCh2Excel 
            Caption         =   "Excel"
            Shortcut        =   ^O
         End
         Begin VB.Menu mnuExportCheckHTML 
            Caption         =   "to HTML"
            Shortcut        =   ^G
         End
         Begin VB.Menu m113Hid 
            Caption         =   "-"
         End
         Begin VB.Menu mDelCh 
            Caption         =   "Delete"
            Shortcut        =   +{DEL}
         End
         Begin VB.Menu m66Hid 
            Caption         =   "-"
         End
         Begin VB.Menu mCombine 
            Caption         =   "Combine"
         End
      End
      Begin VB.Menu mnuLVSelected 
         Caption         =   "Selected"
         Begin VB.Menu mSelCh 
            Caption         =   "Select checked"
            Shortcut        =   ^V
         End
         Begin VB.Menu mUnSelCh 
            Caption         =   "UnSelect checked"
         End
         Begin VB.Menu mnuSelectAllLV 
            Caption         =   "All"
            Shortcut        =   ^A
         End
         Begin VB.Menu mInvSel 
            Caption         =   "Invert"
            Shortcut        =   ^J
         End
         Begin VB.Menu m5Hid 
            Caption         =   "-"
         End
         Begin VB.Menu mnuDolgSel 
            Caption         =   "Set Debtor"
            Shortcut        =   ^U
         End
         Begin VB.Menu mnuLabelSel 
            Caption         =   "Set Label"
            Shortcut        =   ^L
         End
         Begin VB.Menu mGetCoverSel 
            Caption         =   "Get Cover"
            Shortcut        =   ^T
         End
         Begin VB.Menu m6Hid 
            Caption         =   "-"
         End
         Begin VB.Menu mnuCopyLV 
            Caption         =   "to Clipboard"
            Shortcut        =   ^C
         End
         Begin VB.Menu mSel2Excel 
            Caption         =   "Excel"
            Shortcut        =   ^P
         End
         Begin VB.Menu mnuHTML 
            Caption         =   "to HTML"
            Shortcut        =   ^H
         End
         Begin VB.Menu m114Hid 
            Caption         =   "-"
         End
         Begin VB.Menu mDelSel 
            Caption         =   "Delete"
            Shortcut        =   {DEL}
         End
         Begin VB.Menu m78Hid 
            Caption         =   "-"
         End
         Begin VB.Menu mnuCopyRow 
            Caption         =   "Copy row"
            Shortcut        =   ^W
         End
      End
      Begin VB.Menu m77Hid 
         Caption         =   "-"
      End
      Begin VB.Menu mTools 
         Caption         =   "Tools"
         Begin VB.Menu mConvert 
            Caption         =   "Convert"
         End
         Begin VB.Menu mValid 
            Caption         =   "Validation"
         End
         Begin VB.Menu mnuAutoSizeLV 
            Caption         =   "Auto size"
         End
      End
   End
   Begin VB.Menu mnuTextMenuHid 
      Caption         =   "mnuTextMenu"
      Visible         =   0   'False
      Begin VB.Menu mnuShowThisActer 
         Caption         =   "Select Person"
         Enabled         =   0   'False
      End
      Begin VB.Menu mFiltActAll 
         Caption         =   "Show All"
      End
      Begin VB.Menu m777 
         Caption         =   "-"
      End
      Begin VB.Menu mFiltAct 
         Caption         =   "Filter person"
      End
      Begin VB.Menu m7Hid 
         Caption         =   "-"
      End
      Begin VB.Menu mnuUndo 
         Caption         =   "Undo"
      End
      Begin VB.Menu mnuCut 
         Caption         =   "Cut"
      End
      Begin VB.Menu mnuCopy 
         Caption         =   "Copy"
      End
      Begin VB.Menu mnuPaste 
         Caption         =   "Paste"
      End
      Begin VB.Menu mnuDelete 
         Caption         =   "Delete"
      End
      Begin VB.Menu m8Hid 
         Caption         =   "-"
      End
      Begin VB.Menu mnuSelectAll 
         Caption         =   "Select &All"
      End
   End
   Begin VB.Menu PopShowPicHid 
      Caption         =   "PopShowPicHid"
      Visible         =   0   'False
      Begin VB.Menu mnuSavePic 
         Caption         =   "Save as"
      End
      Begin VB.Menu mnuCopyPic 
         Caption         =   "Copy"
      End
      Begin VB.Menu m9Hid 
         Caption         =   "-"
      End
      Begin VB.Menu mnuKillPic 
         Caption         =   "Close"
      End
   End
   Begin VB.Menu mPopGroup 
      Caption         =   "PopGroup"
      Visible         =   0   'False
      Begin VB.Menu mGroup 
         Caption         =   "0"
         Index           =   0
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   1
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   2
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   3
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   4
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   5
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   6
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   7
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   8
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   9
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   10
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   11
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   12
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   13
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   14
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   15
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   16
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   17
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   18
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   19
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   20
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   21
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   22
      End
      Begin VB.Menu mGroup 
         Caption         =   ""
         Index           =   23
      End
      Begin VB.Menu mGroup 
         Caption         =   "24"
         Index           =   24
      End
   End
End
Attribute VB_Name = "FrmMain"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
'LAST MODIFIED
'- TextTimeMSHid  sTextTimeMS
'rsdd.Fields("MovieName") = rsdd.Fields("MovieName") 'CheckNoNull("MovieName")

'ListView.SelectedItem.Selected = True     ',   ,  
'FilterItemsSQL FilterItemsSQL '  - Like
'21 may 2007  restorebasepos
'14.05.07   , LCID  strconv  

'Private Sub SQLCompatible(ByRef s As String)

'29.04.2007
'    tv  ide
'  tv   (   )
'  
'strSQL = SQL1 & " Group By " & GroupField & " Order By " & GroupField '& " Desc"
'       ,     

'28.03.2007 MMI_Format As Currency 'Single  As Currency 'Single
' ,      
' Private Const cstrSVDName As String = "Universal Open Source MPEG Source"
' Private Const cstrSVDName As String = "Mpeg Source" +   

''' ''''''
' : 
'10:44:30> InetOpen: Ok
'10:44:30>  URL =
'10:44:30> Internet Connect Error: 87
' ---------   msscript.ocx
''''''''''

'Debug.Print ": " & strSQL
'Debug.Print "FAD: " & strSQL
'Debug.Print "mFA:" & strSQL
'Debug.Print "FIS" & strSQL

'TODO
'!!  1501  worldart -   
' , 500    . register Acter -..- shura_le@

'!!! myMsgBox   hwnd   
'!!! frmAutoFlag Then FrmMain.SetFocus 

'+             (   - ...)
'+          ( )
'-        -   Replace with pattern
'-      -  
'+      ,   -     fill lv  
'+  LstBases_DragDrop  (    ,     )
'+   -   
'+  /       
'+      -  ,     ctrl
'+   f11    (  )
'+ kinopoisk    

'?       
'  Sub InetGetPics(ch As Boolean)       http://us.imdb.com/title/tt0477347/
'~        :  () 
'?         movie site..
'?     22  2,22   22
'-      (  ctrl+F)
'~    dvd  ,    dvd+r 
'?      ?   
'?  ,        
'     ,     ( ) ?


' 06.06.2007 5.4.0 svcsetup.exe
'-    -  
'+      :   ()  ,   ,  .
'+         
'+  ,       DelMovies
'!    ,   
'+       (Dim SelIt As Boolean)
'+ F10 
'+ / 2.2    
'+     (  )
'+   ctrl+       
'+    - ,   ( ?)
'+ 2000     (   )
'+   -  (    )
'+ FilterItemsSQL '    Like     (,*)
'+      (, , , , , )
'           


'+      ,     .
'+     \\    
'+      
'+ Opt_InetGetPicUseTempFile  ,   read global.ini
'+   tv   
'!    TV -   
'+  filelen  TV
'+ Null  
'!   mediainfo MediaInfoLib - v0.7.4.5
'   mediainfo/ 'Select Case MPGCodec    Select Case strMPEG
'+ Ins (    ctrl shift)
'+     
    
' 5.3.7.1 20.03.2007
'+    dvd 
'~     255      -    txt (  )
'+  w:h  
'-      / ?  
'+  ,   .     (4/3 16/9)
'+         .
'+   ,     (    )
'?  lcase    ...      ?
'-   HTML  ?
'
' 5.3.7 22.02.2007
'+    -     
'-  ?  Ins    
'+   makeini (  )
'+       user.lng
'+    ,  
'+      .  ,  Infernal13
'=          -  
'+    user.lng      .
'+       
'+      
'+    avi   .
'?     
'+ 30.01.2007    IJL11.DLL (cDibSection mIntelJPEGLibrary)
'+          +  WIA   
'+  AVI DS
'+      ,  . Timer2.Enabled = TimerStatus
'  ,      .
'+        ( sn)
'   +InitOpto = cCD.ChooseInterface '(blnForceASPI)
'+  -   1:1 
'+    -   AI
'+       browseForFolder -  
'? - ,  global.ini ,   ,    
'+     ,   rus.lng   .
'~   ,     
'~  .   MediaInfo  .
'+      ctrl+a -       .
'? ,    ,  . INIFileFlagRW   
'~   ...   firstrun       firstrun
'? ...        .     ...
'+         99-100%  -   jepeg.
'   ReDim B(0 To m_cDib.Height * m_cDib.BytesPerScanLine / 3) As Byte
'?        "     ".
'    ...
'+       
'- GetWord     
'+         
'+       jpg (    )
'   mnuCoverSave, mnuCoverCopy
'+            
'   tmp = TranslatedFieldsNames(dbAnnotationInd) & ": " & tmp

' -  WIA
'   +  
'   ~    -   
' + ' : RenderAut   DShGetInfo !!!
' ? .     
' +   NoMediaType -     
' ?  www.torrents.ru
' + 31.10.2006 www.senatorinfo.com  
' - OriginalTitleFirst = True (, ...
' + 30.10.2006   
' +      
' ?     
' ?           lv
' + :   ... ->  ,  , 
' + vbr/cbr    avi?   -  todebug
' +   avi
'   IART - Director, IAS1 - IAS9    
' + AVCodecList.svc  
' + search replace
' + convert2svc - people
' + ComSaveRec.BackColor = &HC0C0E0
' +      
' +     
' +      ""  
' +   2 :  ,   (    )
' ?      - unicode compression  ?
' +    
' +   hb_cScroll
' ?     1:1 -     1:1 -  
' +     .   ShowInShowPic  formShowPic
' + GetAspectFromVideoField     
' + Private Sub DrawCoverEdit()       (,  )
' ?       -   
' =       .  html  
' ?    ?
' +  - 255...
' +     lv
' +  
' +     DelMovies
' +       
' ? TextGenre_KeyDown -> TextGenre_KeyPress   ctrl c
' ?        
' +     FillTV      .    <>
' + FillTV    '    (, , , , .c, , , , , , URL , URL 
'   FillTV  .   , -   .
' +   -  FillTV
' + TVClick    ,  
' +  -         -  
' +     
' +  -   
' +     (,;)      
' + Converter:    -    
' + j=0 '   (   )  (dvd)   .  -  (12  -  ?)
' ?   ?     
' ?          -    ,   
' +     ntlm (SendRequest)
' +   cancel      
' + SelRowsKey ...  SelRows  checkrows - ,   
' +   rsmove 
'
' +  global.ini [GLOBAL]
' +   DShow 
' +     ?   ANTe  .     .      .    ,    .     (    ).   .
' +  
' ~      - 1  -  
' +    (b avto) LB_SETSEL
' +  
' + !   - WIA  convert.txt,  -
' ?    global  ? - 
' +      -      .
'   ,   ,   .
'    12351
'    
'   
'    
'
'    12352
'   
'   
'    
' -     HTML      - .
' +   -      .              .
' ?           
' +    .  *.mp4, MKV - 
'   NamesStore(9)  10
' +        PNG, Tif, jpg,gif,bmp
' + PNG, Tif (MS WIA)
' +   ,    
' ?   
' +   -   
' +   Enter*
' +      X
' +      
' +        
' +     ,      ()
' +      
' ?     
'   http://msdn.microsoft.com/library/default.asp?url=/library/en-us/directshow/htm/geteventmethodimediaeventobject.asp
' ?  -       -    ?
' ~     nero drivespeed
' ?      ( svcd?) -      
'     svcd
' + ?  cancelupdate   -  - ,     
' +    ?     
' +    -   
' +   
' +   
' +    1 
' ?  FrameView - -  
' +         
' +    
' + HScroll_Change
' !   - 
' +     
' +    - 
' +    DVD  ?
'    ,  1     (  , ) -   
' +   
' +       
' ? cBasePicURL  ComboInfoSites -     
'   (  - -     )
' +   
' +    ?
' +    'rsKeyPole = val(ListView.ListItems(140).Key)
'   ListView.ListItems.Add ind, rs.Fields("Key") & """", CheckNoNullVal(0)
' +        (    ?)
' +    vstrip-  mminfo
' +  vstrip -   2    
' ?   -     (  )
' +   textWindow  
' -   -           
' +  
' +   (  )   
' +   CSV
' +   - -   ...  ()
' +   :
'   + SubTitle
'   + CoverPath +
'   + MovieURL +
'   + Rating
'   + MediaType + ComboNos
'   + Language
' +   ifo  MMI_Format_str=16/9...
' =     ,  .
'   =   
'   =     ... - 
' -          -    people.mdb
' + dsGetInfo     vstrip (WMV )-  ,    
' + :      ,     .
' ~              .
' + F3 ^F
' +  -    
' +  -     
' +    sql
' +     ()
' +          
' +     
' + -   
' +      ,     .
''''''''''''''''''
''''''''''''''''''
'   :
'+       -   SQL 
'+   - Public dbMovieNameInd As Integer
'+  -
'    Public Const lvHeaderIndexPole As Integer = 25
'    Public Const lvIndexPole As Integer = 24 ' 18
'    Public Const SVCBaseFielsCount = 31 '25 '   
'+    OpenDB
'+    ListView.CH1   
'+    FillLVSubs
'+     
'+  FirstRun.mdb
'+     ListView_ColumnClick
'+   ExportHTML
'   +   HTML
'   +     ($SUBTITLE$    - )
'+   GetCoverSpisok  mnuCopyLV_Click
'  + LstExport_ListCount = 25 '19       +  + 
'  + LstExport_Arr(25) As Boolean '  0
'+    test.html
'+      
'  + GetFields()
'  + PutFields()
'  + ClearFields
'+ GetPutDD 
'+    
'+          SetFromScript
'+   UCLV
'
''''''''''''''''''''''''''''''''''''''''''''
'      
'+   Const LstOptNum +1
'+  -   
'+     (LstOpt14= 1:1  )
'+     ComOptSave_Click
'+   ReadINI ReadINIOpt
'+     Var2Options (LstOpt.Selected(13) = Opt_CenterShowPic)
'+      Options2Var - LstOpt2Var - LstExport2Var
'                  
'+   ,   chVMcolor_Click()
'        VMSameColor = chVMcolor.Value
'        ApplyOpt
'        optsaved = False
'+   
'

'PNG TIF (MS WIA)
'Private img As ImageFile
'Private vec As Vector


'      
'Private Declare Function GetPixel Lib "gdi32" (ByVal hdc As Long, ByVal X As Long, ByVal Y As Long) As Long

'Private Declare Function GetCursorPos Lib "user32" (lpPoint As POINTAPI) As Long

Private TextTimeHidText As String '    

' ,  
Private FormObjects As New Collection

'  
Private WithEvents m_LV_Vert As cMouseTrack
Attribute m_LV_Vert.VB_VarHelpID = -1
Private WithEvents m_TV_Vert As cMouseTrack
Attribute m_TV_Vert.VB_VarHelpID = -1
Private WithEvents m_SS_Vert As cMouseTrack '/ - /
Attribute m_SS_Vert.VB_VarHelpID = -1

'Dim LV_VDragFlag As Boolean
'Private LV_VDrag As Integer ' = x  
Private MainWidth As Long '   
Private MainWidthPix As Long '     
Private MainHeightPix As Long
Private MainHeight As Long


Private mnuLVCheckedCaption As String '     LV
Private mnuLVSelectedCaption As String
'Private mSumChCaption  As String
'Private mSumSelCaption  As String

Private fr_acter As Boolean ' 



'smess for listbox
'Private Declare Function SendMessageByString Lib "user32" Alias "SendMessageA" (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal sParam As String) As Long

'''
Private Const Range As Integer = 10000 'For MPGPOSScroll

'Private m_wCurOptIdx As Integer 'for browse for folder
'Private Declare Function timeGetTime Lib "winmm.dll" () As Long

'Private GoNextKey As Boolean 'true -     

'
'Private not2save As Boolean '   
Private oldTabStripCoverInd As Integer '  


'
'Private iniTTFileName As String '    
Private TT As New cToolTipEx

'Private CheckedInLV As Integer '     


'Private Const CB_FINDSTRING = &H14C
'Private Const CB_FINDSTRINGEXACT = &H158
'Private Const CB_ERR = (-1)

'  
Private Type POINTAPI
    x As Long
    y As Long
End Type
Private Type MINMAXINFO
    ptReserved As POINTAPI
    ptMaxSize As POINTAPI
    ptMaxPosition As POINTAPI
    ptMinTrackSize As POINTAPI
    ptMaxTrackSize As POINTAPI
End Type
Private Const WM_GETMINMAXINFO = &H24
Implements ISubclass
Private m_emr As EMsgResponse

'-  CD
Private Declare Function RegisterWindowMessage Lib "user32" Alias "RegisterWindowMessageA" (ByVal lpString As String) As Long
Private Const RegMsg As String = "QueryCancelAutoPlay"
Private m_RegMsg As Long

'Private Const CB_SHOWDROPDOWN = &H14F ' 



Private WithEvents m_cScroll As cScrollBars
Attribute m_cScroll.VB_VarHelpID = -1
Private WithEvents ma_cScroll As cScrollBars
Attribute ma_cScroll.VB_VarHelpID = -1
Private WithEvents map_cScroll As cScrollBars 'print
Attribute map_cScroll.VB_VarHelpID = -1
'for rot font
Private Declare Function GetDeviceCaps Lib "gdi32" (ByVal hdc As Long, ByVal nIndex As Long) As Long
Private Const LOGPIXELSY As Integer = 90        '  Logical pixels/inch in Y

'lview click
Private Type lvwMsgInfo
 x As Long
 y As Long
 Flgs As Long
 Itm As Long
 SubItm As Long
End Type

Private lvwMsg As lvwMsgInfo
'''''''''''''''''''''''''''''''''''''''''''''

Private ChPrintCheckedCaption As String
Public LActMarkCountCaption As String
Private mcount As Long '   

Private cIM As cIconMenu




'Private IsTypingAct As Boolean '     

Friend Function WindowProc(hWnd As Long, Msg As Long, wp As Long, lp As Long) As Long
Dim result As Long
Select Case Msg
Case m_RegMsg       ' QueryCancelAutoPlay
    ' TRUE: cancel AutoRun
    ' *must* be 1, not -1!
    ' FALSE: allow AutoRun
    result = 1

Case Else
    ' Pass along to default window procedure.
    result = InvokeWindowProc(hWnd, Msg, wp, lp)
End Select
' Return desired result code to Windows.
WindowProc = result
End Function







Private Sub FillLVAdd()    '(ind As Long)
'  UCLVAddon  
Dim pole As String
Dim tmp As String, tmps As String
Dim stars As Single
Dim ind As Integer
Dim mType As String

'    ?

On Error Resume Next

'UCLV.Visible = False ' 
With ListView.ListItems(ListView.SelectedItem.Index)

    'UCLV.Controls("textMName") = CheckNoNullVal(dbMovieNameInd)
    UCLV.Controls("textMName") = .Text

    ''' 

    UCLV.Controls("textGenre") = .SubItems(dbGenreInd)    'CheckNoNullVal(dbGenreInd)

    tmp = .SubItems(dbYearInd)
    pole = .SubItems(dbCountryInd)
    If Len(pole) <> 0 Then
        pole = pole & ", " & tmp
    Else
        pole = tmp
    End If
    UCLV.Controls("textCountry") = pole

    UCLV.Controls("textAuthor") = .SubItems(dbDirectorInd)

    UCLV.Controls("textRole") = .SubItems(dbActerInd)

    UCLV.Controls("textTime") = .SubItems(dbTimeInd)

    tmp = .SubItems(dbResolutionInd)
    pole = .SubItems(dbFpsInd)
    If Len(pole) <> 0 Then
        If Len(tmp) <> 0 Then
            tmp = tmp & ", " & pole
        Else
            tmp = pole
        End If
    End If
    pole = .SubItems(dbVideoInd)
    If Len(pole) <> 0 Then
        If Len(tmp) <> 0 Then
            UCLV.Controls("textVideo") = tmp & ", " & pole
        Else
            UCLV.Controls("textVideo") = pole
        End If
    Else
        UCLV.Controls("textVideo") = tmp
    End If

    UCLV.Controls("textAudio") = .SubItems(dbAudioInd)

    'pole = .SubItems(dbFileLenInd)

    pole = .SubItems(dbMediaTypeInd)
    'tmp = .SubItems(dbsnDiskInd)
    'UCLV.Controls("textCDN") = Trim$(.SubItems(dbCDNInd) & " " & pole & " " & tmp)
    UCLV.Controls("textCDN") = Trim$(.SubItems(dbCDNInd) & " " & pole)

    'pole = .SubItems(dbFileNameInd)
    UCLV.Controls("textUser") = .SubItems(dbDebtorInd)
    'pole = .SubItems(dbsnDiskInd)
    UCLV.Controls("textOther") = .SubItems(dbOtherInd)

    UCLV.Controls("textLang") = .SubItems(dbLanguageInd)
    UCLV.Controls("textSubt") = .SubItems(dbSubTitleInd)

    UCLV.Controls("textFile") = .SubItems(dbFileNameInd)
    UCLV.Controls("textLabel") = .SubItems(dbLabelInd)
    UCLV.Controls("textDebtor") = .SubItems(dbDebtorInd)

    pole = .SubItems(dbRatingInd)
    pole = Replace2Regional(pole)
    If IsNumeric(pole) Then
        stars = Abs(CSng(pole))
    Else
        stars = 0
    End If
    UCLV.ShowStars stars

    '  
    'dvd, avi, vcd, svcd
    '  dvd

    ind = 0

    tmp = UCLV.Controls("textFile")
    tmps = UCLV.Controls("textVideo")

'   UCLV
    'dvd
    If InStr(1, tmp, "vts_", vbTextCompare) > 0 Then
        If InStr(1, tmp, ".ifo", vbTextCompare) > 0 Then
            ind = 3
            mType = "DVD"
        ElseIf InStr(1, tmp, ".vob", vbTextCompare) > 0 Then
            ind = 3
            mType = "DVD"
        End If
    End If
    'mpg
    If ind = 0 Then
        If LCase$(right$(tmp, 4)) = ".mpg" Then
        mType = "MPG"
            ind = 4
        End If
    End If
    'divx
    If ind = 0 Then
        If InStr(1, tmps, "divx", vbTextCompare) > 0 Then
            ind = 6
            mType = "DIVX"
        End If
    End If
    'divx
    If ind = 0 Then
        If InStr(1, tmps, "xvid", vbTextCompare) > 0 Then
            ind = 7
            mType = "XVID"
        End If
    End If
    'divx
    If ind = 0 Then
        If InStr(1, tmps, "wmv", vbTextCompare) > 0 Then
        mType = "WMV"
            ind = 8
        End If
    End If
    'avi,  divx  xvid   wmv
    If ind = 0 Then
        If LCase$(right$(tmp, 4)) = ".avi" Then
            ind = 5
             mType = "AVI"
        End If
    End If
    'mov
    If ind = 0 Then
        If LCase$(right$(tmp, 4)) = ".mov" Then
            ind = 9
             mType = "MOV"
        End If
    End If


    If ind <> 0 Then
        'UCLV.Controls("imgType").Picture = ImageList.ListImages(ind).Picture
        ' 
        UCLV.Controls("imgType").Picture = ImageList.ListImages(mType).Picture
    Else
        Set UCLV.Controls("imgType").Picture = Nothing
    End If


End With
'UCLV.Visible = True
End Sub

Private Sub LVActClick()
'      LV 
Dim temp As String, temp2 As String
Dim i As Integer
Dim txtlen As Integer
Dim ch As String

If ars.RecordCount = 0 Then Exit Sub
If LVActer.ListItems.Count < 1 Then Exit Sub
'If LVActer.SelectedItem.Index < 1 Then Exit Sub

'If ActEditFlag Then ComCancelAct_Click: Exit Sub
ActNewFlag = False
If ars.EditMode Then ActEditFlag = True


RSGotoAct LVActer.SelectedItem.Key
CurAct = LVActer.SelectedItem.Index
LastIndAct = LVActer.ListItems(LVActer.SelectedItem.Index).SubItems(1)
CurActKey = LVActer.SelectedItem.Key

'Screen.MousePointer = vbHourglass
'
Set PicActFoto.Picture = Nothing
If GetPic(PicActFoto, 2, "Face") Then  '2
    'PicActFoto.Picture = PicActFoto.Image
    'PicActFoto.Refresh
Else
    PicActFoto.Height = 0: PicActFoto.Width = 0 ' 
End If

PicActFotoScroll_Resize
   'If ma_cScroll.Visible(efsHorizontal) Then PicActFoto.Left = -Screen.TwipsPerPixelX * ma_cScroll.Value(efsHorizontal)
   'If ma_cScroll.Visible(efsVertical) Then PicActFoto.Top = -Screen.TwipsPerPixelY * ma_cScroll.Value(efsVertical)
   If ma_cScroll.Visible(efsHorizontal) Then ma_cScroll.Value(efsHorizontal) = 0
   If ma_cScroll.Visible(efsVertical) Then ma_cScroll.Value(efsVertical) = 0

'
'Call SendMessage(TextActBio.hwnd, WM_SETREDRAW, 0, 0)
TextActName.Text = vbNullString: TextActBio.Text = vbNullString
GetAFields
'Call SendMessage(TextActBio.hwnd, WM_SETREDRAW, 1, 0)

' listb
'DoEvents
ListBActHid.Clear

temp = Trim$(LVActer.ListItems(LVActer.SelectedItem.Index).Text)
Do
    temp2 = GetWord(temp)
    txtlen = Len(temp2)
    For i = 1 To txtlen
        ch = Mid$(temp2, i, 1)
        If ch < "A" Then Mid$(temp2, i, 1) = " "
        'If ch < Chr(13) Then Mid$(temp2, i, 1) = " "
        'Or ch > "~"
    Next i
    'Debug.Print Asc("A"), Asc(" "), Asc("")
    temp2 = Trim$(temp2)
    If LenB(temp2) = 0 Then Exit Do
    ListBActHid.AddItem temp2
Loop

ActNotManualClick = False
ComSelMovIcon.Enabled = False
Screen.MousePointer = vbNormal

If ActEditFlag Then
'Debug.Print " Key=" & LVActer.SelectedItem.Key
ToDebug "ActKey=" & LVActer.SelectedItem.Key
Else
'Debug.Print "Click L=" & LastIndAct & " C=" & CurAct & " Key=" & LVActer.SelectedItem.Key
End If

End Sub


Private Sub CDSerialCur_Change()
Mark2Save
End Sub

Private Sub ChBTT_Click()
Dim c As Control
Dim rflag As Boolean
Dim i As Integer, j As Integer

VerticalMenu.SetFocus
If ChBTT.Value = vbUnchecked Then
'                                                   
 Screen.MousePointer = vbNormal
 
FormObjects.Add FrmMain, "FrmMain"
If frmOptFlag Then FormObjects.Add FrmOptions, "FrmOptions"
If frmFilterFlag Then FormObjects.Add FrmFilter, "FrmFilter"
If frmSRFlag Then FormObjects.Add frmSR, "frmSR"

'If frmOptFlag Then FormObjects.Add FrmOptions, "FrmOptions"
'If frmOptFlag Then FormObjects.Add FrmOptions, "FrmOptions"

For j = 1 To FormObjects.Count '   

 For Each c In FormObjects(j).Controls 'Frame1.Parent
  'Debug.Print ctrl.Name
  rflag = False
  
  If TypeOf c Is CommandButton Then rflag = True: GoTo nextc
  If TypeOf c Is ComboBox Then rflag = True: GoTo nextc
  If TypeOf c Is CheckBox Then rflag = True: GoTo nextc
  If TypeOf c Is TextBox Then rflag = True: GoTo nextc
  'If TypeOf c Is Menu Then rflag = True: GoTo nextc
  If TypeOf c Is PictureBox Then rflag = True: GoTo nextc
  If c.name = "VerticalMenu" Then rflag = True: GoTo nextc
  If TypeOf c Is ListBox Then rflag = True: GoTo nextc
  If TypeOf c Is ListView Then rflag = True: GoTo nextc
  If TypeOf c Is Slider Then rflag = True: GoTo nextc
  If TypeOf c Is TabStrip Then rflag = True: GoTo nextc
  If TypeOf c Is XpB Then rflag = True: GoTo nextc
  If TypeOf c Is UCLVaddon Then rflag = True: GoTo nextc
  If TypeOf c Is OptionButton Then rflag = True: GoTo nextc


nextc:
        
  If rflag Then
   If c.name = "VerticalMenu" Then
    For i = 1 To 8
     Select Case i
      Case 1:  TT.RemoveToolTip (c.hwnd1)
      Case 2:  TT.RemoveToolTip (c.hwnd2)
      Case 3:  TT.RemoveToolTip (c.hwnd3)
      Case 4:  TT.RemoveToolTip (c.hwnd4)
      Case 5:  TT.RemoveToolTip (c.hwnd5)
      Case 6:  TT.RemoveToolTip (c.hwnd6)
      Case 7:  TT.RemoveToolTip (c.hwnd7)
      Case 8:  TT.RemoveToolTip (c.hwnd8)
     End Select
    Next i
                
   Else
    
    TT.RemoveToolTip (c.hWnd)
   End If
        
  End If 'flag
 Next 'control
 Next j

Set FormObjects = Nothing

 '  -   
 'Call TT.DestroyToolTip
 'If Not DebugMode Then
 '   AttachMessage Me, Me.hwnd, WM_GETMINMAXINFO
 'End If
 
Else
'                                                      
 'Debug.Print lngFileName
 Call TT.CreateToolTip(Me.hWnd, TTS_BALLOON, icoTTInfo, "Sur Video Catalog", 80, 1, -1, RGB(224, 240, 255), RGB(0, 0, 78))
 TT.DelayTime(TTDT_AUTOMATIC) = &HFFFF
 TT.DelayTime(TTDT_AUTOPOP) = &H7FFF '16384
 TT.DelayTime(TTDT_INITIAL) = 0
 TT.DelayTime(TTDT_RESHOW) = 0
    
 ReadTTINI lngFileName & ".btt"
    
End If

End Sub
Private Sub ReadTTINI(iFn As String)
Dim WFD As WIN32_FIND_DATA
Dim ret As Long
Dim temp As String
Dim c As Control
Dim rflag As Boolean
Dim i As Integer, j As Integer

On Error Resume Next

'check ini
ret = FindFirstFile(iFn, WFD)
If ret < 0 Then Exit Sub ' 

FormObjects.Add FrmMain, "FrmMain"
If frmOptFlag Then FormObjects.Add FrmOptions, "FrmOptions"
If frmFilterFlag Then FormObjects.Add FrmFilter, "FrmFilter"
If frmSRFlag Then FormObjects.Add frmSR, "frmSR"

'FormObjects.Add FrmOptions, "FrmOptions"
'If frmAutoFlag Then FormObjects.Add FrmAuto, "FrmAuto"
'If frmOptFlag Then FormObjects.Add FrmOptions, "FrmOptions"

For j = 1 To FormObjects.Count '   
For Each c In FormObjects(j).Controls
 rflag = False
 If TypeOf c Is CommandButton Then rflag = True: GoTo nextc
 If TypeOf c Is ComboBox Then rflag = True: GoTo nextc
 If TypeOf c Is CheckBox Then rflag = True: GoTo nextc
 If TypeOf c Is TextBox Then rflag = True: GoTo nextc
 'If TypeOf c Is Menu Then rflag = True: GoTo nextc
 If TypeOf c Is PictureBox Then rflag = True: GoTo nextc
 If c.name = "VerticalMenu" Then rflag = True: GoTo nextc
 If TypeOf c Is ListBox Then rflag = True: GoTo nextc
 If TypeOf c Is ListView Then rflag = True: GoTo nextc
 If TypeOf c Is Slider Then rflag = True: GoTo nextc
 If TypeOf c Is TabStrip Then rflag = True: GoTo nextc
 If TypeOf c Is XpB Then rflag = True: GoTo nextc
 If TypeOf c Is UCLVaddon Then rflag = True: GoTo nextc
 If TypeOf c Is OptionButton Then rflag = True: GoTo nextc
  
nextc:

 If rflag Then
  If c.name = "VerticalMenu" Then
   For i = 1 To 8
    temp = VBGetPrivateProfileString("TTGlobal", c.name & i, iFn)
    temp = Change2lfcr(temp)
    Select Case i
     Case 1:  Call TT.AddToolTip(c.hwnd1, temp)
     Case 2:  Call TT.AddToolTip(c.hwnd2, temp)
     Case 3:  Call TT.AddToolTip(c.hwnd3, temp)
     Case 4:  Call TT.AddToolTip(c.hwnd4, temp)
     Case 5:  Call TT.AddToolTip(c.hwnd5, temp)
     Case 6:  Call TT.AddToolTip(c.hwnd6, temp)
     Case 7:  Call TT.AddToolTip(c.hwnd7, temp)
     Case 8:  Call TT.AddToolTip(c.hwnd8, temp)
    End Select
   Next i
  Else
   temp = VBGetPrivateProfileString("TTGlobal", c.name, iFn)
   temp = Change2lfcr(temp)
   'Debug.Print c.name
   Call TT.AddToolTip(c.hWnd, temp)
  End If
 End If
Next 'control
Next j

Set FormObjects = Nothing
End Sub

Private Sub ChCentrP_Click()
If NoPicFrontFaceFlag Or ChPrintPix.Value = vbUnchecked Then
Else
 Select Case TabStripCover.SelectedItem.Index
  Case 1: PutPrintPixStandard
  Case 2: PutPrintPixConvert
  Case 3: PutPrintPixDVD
 End Select
End If
End Sub

Private Sub ChInFilFl_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)
Static working As Boolean
If working Then Exit Sub
working = True
Select Case ChInFilFl.Value
Case Unchecked
    ChInFilFl.Value = Checked
Case Gray
    ChInFilFl.Value = Unchecked
Case Checked
    ChInFilFl.Value = Gray
End Select
working = False
ReleaseCapture
End Sub

Private Sub ChPrintChecked_Click()
If TabStripCover.SelectedItem.Index <> 4 Then ChPrintCheckedFlag = ChPrintChecked.Value
End Sub

Private Sub ChPrintPix_Click()
Select Case TabStripCover.SelectedItem.Index
Case 1
 If NoPicFrontFaceFlag Or ChPrintPix.Value = vbUnchecked Then
  PicCoverPaper.PaintPicture ImBlankHid.Picture, 35.1, 25.1, 119.9, 119.9
  PicFaceV.Picture = PicFaceV.Image
 Else
  PutPrintPixStandard
 End If
Case 2
 If NoPicFrontFaceFlag Or ChPrintPix.Value = vbUnchecked Then
  PicCoverPaper.PaintPicture ImBlankHid.Picture, 35.1, 145.2, 119.9, 119.9
  PicFaceV.Picture = PicFaceV.Image
 Else
  PutPrintPixConvert
 End If
Case 3
 If NoPicFrontFaceFlag Or ChPrintPix.Value = vbUnchecked Then
  PicCoverPaper.PaintPicture ImBlankHid.Picture, 153.1, 15.3, 130, 179.7
  PicFaceV.Picture = PicFaceV.Image
 Else
  PutPrintPixDVD
 End If
End Select

End Sub

Private Sub chPrnAllOne_Click()
'If TabStripCover.SelectedItem.Index <> 4 Then ChPrintAllOneFlag = chPrnAllOne.Value
TabStripCover_Click
End Sub

Private Sub ChPropP_Click()

If NoPicFrontFaceFlag Or ChPrintPix.Value = vbUnchecked Then
Else
  Select Case TabStripCover.SelectedItem.Index
   Case 1
    PutPrintPixStandard
   Case 2
    PutPrintPixConvert
   Case 3
    PutPrintPixDVD
  End Select
End If
End Sub

Private Sub ChScaleP_Click()
If ChScaleP.Value = Unchecked Then
 ChPropP.Value = Checked
 ChPropP.Enabled = False
Else
 ChPropP.Enabled = True
End If

If NoPicFrontFaceFlag Or ChPrintPix.Value = vbUnchecked Then
Else
 Select Case TabStripCover.SelectedItem.Index
 Case 1
  PutPrintPixStandard
 Case 2
  PutPrintPixConvert
 Case 3
  PutPrintPixDVD
 End Select
End If
End Sub

Private Sub CmdPrint_Click()
Dim printDlg As PrinterDlg
Dim strsetting As String
Dim M As Integer
Dim NewPrinterName As String
Dim objPrinter As Printer

Set printDlg = New PrinterDlg
ToDebug ""
On Error Resume Next

printDlg.PrinterName = Printer.DeviceName
printDlg.DriverName = Printer.DriverName
printDlg.Port = Printer.Port
printDlg.PaperSize = 9 '(A4)
printDlg.PaperBin = Printer.PaperBin

    Select Case TabStripCover.SelectedItem.Index
        Case 1, 2, 4
            printDlg.Orientation = vbPRORPortrait '1 '"Portrait."
        Case 3
            printDlg.Orientation = vbPRORLandscape  '2  '"Landscape." dvd
    End Select

    printDlg.Flags = VBPrinterConstants.cdlPDNoSelection _
                 Or VBPrinterConstants.cdlPDNoPageNums _
                 Or VBPrinterConstants.cdlPDReturnDC
    Printer.TrackDefault = False

' When CancelError is set to True the ShowPrinterDlg will return error
' 32755. You can handle the error to know when the Cancel button was
' clicked. Enable this by uncommenting the lines prefixed with "'**".
'**printDlg.CancelError = True

' Add error handling for Cancel.
'**On Error GoTo Cancel
If Not printDlg.ShowPrinter(Me.hWnd) Then
    ToDebug " : " & err.Description
    Exit Sub
End If

'Turn off Error Handling for Cancel.
'**On Error GoTo 0
'Dim strsetting As String

' Locate the printer that the user selected in the Printers collection.
NewPrinterName = UCase$(printDlg.PrinterName)
If Printer.DeviceName <> NewPrinterName Then
    For Each objPrinter In Printers
       If UCase$(objPrinter.DeviceName) = NewPrinterName Then
            Set Printer = objPrinter
       End If
    Next
End If

' Copy user input from the dialog box to the properties of the selected printer.
Printer.Copies = printDlg.Copies
Printer.Orientation = printDlg.Orientation
Printer.ColorMode = printDlg.ColorMode
Printer.Duplex = printDlg.Duplex
Printer.PaperBin = printDlg.PaperBin
Printer.PaperSize = printDlg.PaperSize
Printer.PrintQuality = printDlg.PrintQuality
' Display the results in the immediate (Debug) window.
' NOTE: Supported values for PaperBin and Size are printer specific. Some
' common defaults are defined in the Win32 SDK in MSDN and in Visual Basic.
' Print quality is the number of dots per inch.
With Printer
'Debug.Print .DeviceName
ToDebug ": " & .DeviceName
    If .Orientation = 1 Then
        strsetting = "Portrait. "
    Else
        strsetting = "Landscape. "
    End If
'Debug.Print "Copies = " & .Copies, "Orientation = " &  strsetting
ToDebug ": " & .Copies & ", : " & strsetting
    If .ColorMode = 1 Then
        strsetting = "Black and White. "
    Else
        strsetting = "Color. "
    End If
'Debug.Print "ColorMode = " & strsetting
ToDebug "colorMode = " & strsetting
'    If .Duplex = 1 Then
'        strsetting = "None. "
'    ElseIf .Duplex = 2 Then
'        strsetting = "Horizontal/Long Edge. "
'    ElseIf .Duplex = 3 Then
'        strsetting = "Vertical/Short Edge. "
'    Else
'        strsetting = "Unknown. "
'    End If
'Debug.Print "Duplex = " & strsetting
'Debug.Print "PaperBin = " & .PaperBin
'Debug.Print "PaperSize = " & .PaperSize
ToDebug "PaperSize = " & .PaperSize
'Debug.Print "PrintQuality = " & .PrintQuality
ToDebug "PrintQuality = " & .PrintQuality
    If (printDlg.Flags And VBPrinterConstants.cdlPDPrintToFile) = _
       VBPrinterConstants.cdlPDPrintToFile Then
'Debug.Print "Print to File Selected"
ToDebug "Print to File Selected"
    Else
ToDebug "Print to File Not Selected"
    End If
'Debug.Print "hDC = " & printDlg.hdc
End With

MousePointer = vbHourglass

If ChPrintChecked Then '  
    ToDebug " "
    CmdPrint.Enabled = False
    Screen.MousePointer = vbHourglass

    For M = 1 To UBound(CheckRows)
        'rs.MoveFirst: rs.Move CheckRows(M)
        
        'RSMOVE CheckRows(M), "CmdPrint_Click"
        RSGoto CheckRowsKey(M)
        
        If TabStripCover.SelectedItem.Index = 1 Then Call ShowCoverStandard
        If TabStripCover.SelectedItem.Index = 2 Then Call ShowCoverConvert
    
        PicCoverPaper.Picture = PicCoverPaper.Image
        PicCoverPaper.Refresh
        
        DoEvents
        Printer.PaintPicture PicCoverPaper.Picture, 0, 0
        Printer.EndDoc
    Next M

    CmdPrint.Enabled = True

    ' . .  
    RestoreBasePos

    Screen.MousePointer = vbNormal

Else '  

    DoEvents
    ToDebug " "
    PicCoverPaper.Picture = PicCoverPaper.Image
    Printer.PaintPicture PicCoverPaper.Picture, 0, 0 'Printer.CurrentX, Printer.CurrentY ', 0, 0
'Debug.Print Printer.CurrentX, Printer.CurrentY
    Printer.EndDoc
End If

err.Clear
On Error GoTo 0

MousePointer = vbDefault
'Exit Sub
'**Cancel:
'**If Err.Number = 32755 Then
'**Debug.Print "Cancel Selected"
'**Else
'**Debug.Print "A nonCancel Error Occured - "; Err.Number
'**End If


End Sub


Private Sub ComActDel_Click()
Dim okk As Integer

If BaseAReadOnly Then myMsgBox msgsvc(25), vbInformation, , Me.hWnd: Exit Sub
If BaseAReadOnlyU Then myMsgBox msgsvc(23), vbInformation, , Me.hWnd: Exit Sub
If ars.RecordCount = 0 Then Exit Sub
okk = myMsgBox(msgsvc(15), vbOKCancel, , Me.hWnd)
If okk = 2 Then Exit Sub

ActFlag = False

LockWindowUpdate TextActBio.hWnd

ars.Delete

'  
LVActer.ListItems.Remove LVActer.SelectedItem.Index

If LVActer.ListItems.Count = 0 Then
' 
    Set PicActFoto = Nothing
    TextActBio = vbNullString: TextActName = vbNullString
    ListBActHid.Clear
'    ComActDel.Enabled = False
    ComActEdit.Enabled = False
    
Else
' 
'   GotoLVAct ars("Key")
    LVActClick
End If

FrameActer.Caption = FrameActerCaption & LVActer.ListItems.Count & ")"

LockWindowUpdate 0
End Sub

Private Sub ComActEdit_Click()
Dim i As Integer

If BaseAReadOnly Then myMsgBox msgsvc(25), vbInformation, , Me.hWnd: Exit Sub
If BaseAReadOnlyU Then myMsgBox msgsvc(23), vbInformation, , Me.hWnd: Exit Sub
If ars.RecordCount = 0 Then Exit Sub
If LVActer.ListItems.Count = 0 Then Exit Sub

ComActSave.BackColor = &HC0C0E0
TextActName.BackColor = &HFFFFFF
TextActBio.BackColor = &HFFFFFF
PicActFotoScroll.BackColor = &HFFFFFF

ActEditFlag = True
ComActSave.Enabled = True
ComActPast.Enabled = True
ComActFile.Enabled = True
ComActFotoDel.Enabled = True
'ComCancelAct.Enabled = True
'ComActDel.Enabled = False
ComAddAct.Enabled = False
ComActEdit.Enabled = False
TextSearchLVActTypeHid.Enabled = False

TextActName.SetFocus
ActFlag = True
LastIndAct = LVActer.ListItems(LVActer.SelectedItem.Index).SubItems(1)
CurActKey = LVActer.SelectedItem.Key

RSGotoAct CurActKey

'ars.MoveFirst
'ars.Move LVActer.ListItems(LVActer.SelectedItem.Index).SubItems(1) - 1

For i = 0 To OptActOnlyFotoHid.Count - 1
    OptActOnlyFotoHid(i).Enabled = False
Next i

ars.Edit
'Debug.Print "  Key=" & CurActKey
ToDebug "CActEdKey=" & CurActKey
End Sub

Private Sub ComActFile_Click()
Dim iFile As String
Dim TifPngFlag As Boolean

On Error GoTo err ' 

iFile = pLoadPixDialog
If LCase$(getExtFromFile(iFile)) = "png" Then TifPngFlag = True
If left$(LCase$(getExtFromFile(iFile)), 3) = "tif" Then TifPngFlag = True

If iFile <> vbNullString Then

    If TifPngFlag Then
        PicActFoto.Picture = LoadPictureWIA(iFile)
    Else
        PicActFoto.Picture = LoadPicture(iFile)
    End If

    SavePicActFlag = True
    'ComActSave.BackColor = &HC0C0E0
    PicActFotoScroll_Resize
End If

Exit Sub
err:
ToDebug "Err_ComAF: " & err.Description
MsgBox err.Description, vbCritical
End Sub

Private Sub ComActFotoDel_Click()

If myMsgBox(msgsvc(4), vbOKCancel, , Me.hWnd) = vbCancel Then Exit Sub

If ars.EditMode Then
Else
    ars.Edit
End If

'ComActSave.BackColor = &HC0C0E0
Set PicActFoto = Nothing
ars.Fields("Face") = vbNullString
PicActFoto.Width = 0: PicActFoto.Height = 0: PicActFotoScroll_Resize
End Sub
Private Sub ComActPast_Click()
'Dim f As Integer
'Clipboard.GetFormat (f)
'Debug.Print f
If Clipboard.GetFormat(vbCFDIB) Then
 PicActFoto.Picture = Clipboard.GetData
 SavePicActFlag = True
 'ComActSave.BackColor = &HC0C0E0
 PicActFotoScroll_Resize
End If
End Sub


Private Sub ComActSave_Click()
Dim akey As String '   ()
Dim i As Integer

If BaseAReadOnly Then myMsgBox msgsvc(25), vbInformation, , Me.hWnd: Exit Sub
'If BaseAReadOnlyU Then myMsgBox msgsvc(23), vbInformation, , Me.hwnd: Exit Sub
If Len(TextActName.Text) = 0 Then myMsgBox msgsvc(39), vbInformation, , Me.hWnd: Exit Sub

TextActName.BackColor = LVBackColor
TextActBio.BackColor = LVBackColor
PicActFotoScroll.BackColor = LVBackColor

ComActSave.Enabled = False
ComActPast.Enabled = False
ComActFile.Enabled = False
ComActFotoDel.Enabled = False
ComActEdit.Enabled = True
'ComActDel.Enabled = True
ComAddAct.Enabled = True
'ComCancelAct.Enabled = False
TextSearchLVActTypeHid.Enabled = True
PicActFotoScroll.Visible = False

If ars.EditMode = 0 Then ars.Edit

'  
If SavePicActFlag Then Pic2JPG PicActFoto, 2, "Face"
SavePicActFlag = False

'  
PutAFields

akey = ars("Key") & """" '  1
ars.Update '                2

'Debug.Print LastIndAct

If ActNewFlag Then
    LVActer.Visible = False: LVActer.Sorted = False
    
    '  LV
    LastIndAct = LVActer.ListItems.Count + 1
    LVActer.ListItems.Add(, akey, TextActName.Text).ListSubItems.Add 1, , LastIndAct
        'LVActer.ListItems(LastIndAct).SubItems(1) = LastIndAct
    
    GotoLVAct akey ' ...  
    'Set LVActer.SelectedItem = LVActer.ListItems(LastIndAct)
    
    RSGotoAct akey '   

    LVActer.Sorted = True: LVActer.Visible = True
    CurAct = LVActer.SelectedItem.Index
    FrameActer.Caption = FrameActerCaption & LastIndAct & ")"

    'ars.MoveFirst: ars.MoveLast
    ActNewFlag = False

'Debug.Print "Save New L=" & LastIndAct & " C=" & CurAct & " Key=" & akey
    'Debug.Print "Save New Field = " & ars.Fields("Name")

ElseIf ActEditFlag Then

    LVActer.ListItems(CurAct).Text = TextActName.Text
    ActEditFlag = False
    'LVActer.Sorted = True ' 

End If

ActFlag = False

'LVActer.SelectedItem.EnsureVisible
LV_EnsureVisible LVActer, LVActer.SelectedItem.Index

PicActFotoScroll_Resize
PicActFotoScroll.Visible = True

For i = 0 To OptActOnlyFotoHid.Count - 1
OptActOnlyFotoHid(i).Enabled = True
Next i

ComActSave.BackColor = &HFFFFFF
FrameActer.Caption = FrameActerCaption & LVActer.ListItems.Count & ")"

'Debug.Print " . Key=" & akey
ToDebug "ActSavedKey=" & akey
End Sub

Private Sub comActSearchInBIO_Click()
Dim itmX As MSComctlLib.ListItem
'in annot
'mzt Dim nxt As Long
Dim temp As String
Dim ret As Long
Dim i As Long

If LVActer.ListItems.Count = 0 Then Exit Sub

Screen.MousePointer = vbHourglass

For i = LVActer.SelectedItem.Index + 1 To LVActer.ListItems.Count

    Set itmX = LVActer.ListItems(i)
    
    'ars.MoveFirst: ars.Move itmX.SubItems(1) - 1
    RSGotoAct LVActer.ListItems(i).Key


    'Debug.Print ars("Name")
    If ars.Fields("Bio").Value <> vbNullString Then
        temp = ars.Fields("Bio")
    Else
        temp = vbNullString
    End If

    ret = InStr(1, temp, TextSearchLVActTypeHid.Text, vbTextCompare)
    If ret > 0 Then

        Set LVActer.SelectedItem = itmX            'LVActer.ListItems.Item(nxt)
        LVActClick 'itmX
        LVActer.SetFocus
        'LVActer.ListItems(LVActer.SelectedItem.Index).EnsureVisible
        LV_EnsureVisible LVActer, LVActer.SelectedItem.Index
        
        TextActBio.SetFocus
        TextActBio.SelStart = ret - 1
        TextActBio.SelLength = Len(TextSearchLVActTypeHid.Text)
        
        Exit For
    End If
Next

Screen.MousePointer = vbNormal
End Sub

Private Sub ComAdd_Click()
'Append new file
Dim tmpdrive As String
Dim tmpSerial As String

aviName = pLoadDialog(ComAdd.Caption)
DoEvents

If LenB(aviName) = 0 Then Exit Sub

ToDebug "."

'
NewDiskAddFlag = False    '  
tmpdrive = left$(LCase$(aviName), 3)
If DriveType(tmpdrive) = "CD-ROM" Then
    tmpSerial = Hex$(GetSerialNumber(tmpdrive))
    If tmpSerial <> "0" Then
    
        If MediaSN = tmpSerial Then
            IsSameCdFlag = True '   
        Else
            IsSameCdFlag = False
            MediaSN = tmpSerial '  cd
        End If

        If InStr(1, CDSerialCur, tmpSerial, vbTextCompare) = 0 Then
            '  
            If Len(CDSerialCur) = 0 Then
                ' 
                CDSerialCur = tmpSerial
            Else
                '  
                CDSerialCur = CDSerialCur & ", " & tmpSerial
                NewDiskAddFlag = True
            End If
        End If    'instr
    End If
    
        '
        If IsSameCdFlag Then '   
            ComboNos.Text = MediaType
        Else
            ComboNos.Text = ComboNos.Text & ", " & GetOptoInfo(left$(aviName, 2)) ' 
            MediaType = ComboNos.Text
        End If
        
Else
    'ComboNos.Text = vbNullString '   
End If    'drivetype


OpenAddmovFlag = True

AppendMovieFlag = True
ComOpen_Click
AppendMovieFlag = False
'Call SubAdd

End Sub


Private Sub ComAddAct_Click()
If BaseAReadOnly Then myMsgBox msgsvc(25), vbInformation, , Me.hWnd: Exit Sub

Dim i As Integer

ComActSave.BackColor = &HC0C0E0
TextActName.BackColor = &HFFFFFF
TextActBio.BackColor = &HFFFFFF
Set PicActFoto.Picture = Nothing
PicActFotoScroll.BackColor = &HFFFFFF

TextActName.Text = vbNullString
TextActBio.Text = vbNullString
ListBActHid.Clear
PicActFoto.Width = 0: PicActFoto.Height = 0: PicActFotoScroll_Resize

If rs.EditMode Then rs.CancelUpdate

TextSearchLVActTypeHid.Enabled = False

ComActSave.Enabled = True
ComAddAct.Enabled = False
ComActEdit.Enabled = False
'ComActDel.Enabled = False
ActNewFlag = True
ComActPast.Enabled = True
ComActFile.Enabled = True
ComActFotoDel.Enabled = True
'ComCancelAct.Enabled = True
ActFlag = True

TextActName.SetFocus

For i = 0 To OptActOnlyFotoHid.Count - 1
    OptActOnlyFotoHid(i).Enabled = False
Next i

ars.AddNew
ToDebug "AddActNewKey=" & ars("Key") '& CurActKey
End Sub

Public Sub ComAutoScrShots_Click()
Dim tmp As Currency
'Dim tmpsi As Single

Mark2Save
Screen.MousePointer = vbHourglass

'                                                               AVI
If isAVIflag And (Not aferror) Then
    AutoScrShots (Frames)
End If

'                                                               MPEG
If isMPGflag Or isDShflag Then

    'objPosition.CurrentPosition = Position.Value / 100
    tmp = (TimesX100 - TimesX100 * 0.05) / 3    '4
    pos1 = 1 + (Rnd() * tmp)    '1-4
    pos2 = tmp + (Rnd() * tmp)    '4-8
    pos3 = tmp * 2 + (Rnd() * tmp)    '8-12

    'Position.Value = pos3
    MPGPosScroll

    On Error Resume Next    '  objPosition.CurrentPosition,   

    Position.Value = pos1
    objPosition.CurrentPosition = Position.Value / 100
    Sleep 500
    ComCap_Click 0
    Screen.MousePointer = vbHourglass

    PicSS1.Refresh: DoEvents
    Sleep 500
    Position.Value = pos2
    objPosition.CurrentPosition = Position.Value / 100
    Sleep 500
    ComCap_Click 1
    Screen.MousePointer = vbHourglass

    PicSS2.Refresh: DoEvents
    Sleep 500
    Position.Value = pos3
    objPosition.CurrentPosition = Position.Value / 100
    Sleep 500
    ComCap_Click 2

End If    'mpeg

SavePic1Flag = True: SavePic2Flag = True: SavePic3Flag = True
NoPic1Flag = False: NoPic2Flag = False: NoPic3Flag = False

If Not frmAutoFlag Then Me.SetFocus

Screen.MousePointer = vbNormal
End Sub

Private Sub CombFind_Click()
ComNext.Enabled = True
' 
If CombFind.ItemData(CombFind.ListIndex) = 5 Then ComShowAn_Click
If FrameView.Visible Then
 If CombFind.ItemData(CombFind.ListIndex) = 6 Then TextFind.Text = Hex$(GetSerialNumber(ComboCDHid_Text))
End If
End Sub

Private Sub CombFind_KeyPress(KeyAscii As Integer)
KeyAscii = 0
End Sub

Private Sub ComboNos_Change()
Mark2Save
End Sub

Private Sub ComboNos_Click()
Mark2Save
End Sub

Private Sub ComboNos_LostFocus()
ComboNos.Text = sTrimChars(ComboNos.Text, vbNewLine)
End Sub

Private Sub ComClsEd_Click()
'   ,   

AutoFillStore
DoEvents

TextMName.SetFocus: SendKeys "{Del}", True
TextLabel.SetFocus: SendKeys "{Del}", True
TextGenre.SetFocus: SendKeys "{Del}", True
TextCountry.SetFocus: SendKeys "{Del}", True
TextYear.SetFocus: SendKeys "{Del}", True
TextAuthor.SetFocus: SendKeys "{Del}", True
TextOther.SetFocus: SendKeys "{Del}", True

TextLang.SetFocus: SendKeys "{Del}", True
TextSubt.SetFocus: SendKeys "{Del}", True
TextRate.SetFocus: SendKeys "{Del}", True

TextRole.SetFocus: TextRole.SelStart = 0: TextRole.SelLength = Len(TextRole.Text)
SendKeys "{Del}", True ''SendKeys "^A": win2000?

TextAnnotation.SetFocus:  TextAnnotation.SelStart = 0: TextAnnotation.SelLength = Len(TextAnnotation.Text)
SendKeys "{Del}", True ''SendKeys "^A": win2000?

TextMName.SetFocus
End Sub


Private Sub ComFilter_ShiftClick(Shift As Integer)
'    2   
' 
' frmfilter.CommShowAll

Dim strSQL As String
On Error Resume Next '       

If FiltPersonFlag Or FiltValidationFlag Or FilteredFlag Then
'
Else
    Exit Sub
End If

LastInd = FrmMain.ListView.SelectedItem.SubItems(lvIndexPole)

If GroupedFlag And Len(LastSQLGroupString) <> 0 Then
'   
strSQL = "Select * From Storage Where " & LastSQLGroupString
Else
' 
strSQL = "Select * From Storage"
End If

Set rs = DB.OpenRecordset(strSQL)

FiltPersonFlag = False '    
FiltValidationFlag = False
FilteredFlag = False '   () 1

FillListView

FrmMain.ComFilter.BackColor = &HFFFFFF
End Sub

Private Sub ComGetCover_Click()
'      URL
Dim tmp As String

'pix
If Len(TextCoverURL) <> 0 Then
    '        tmp = UrlEncode(cBasePicURL & TextCoverURL)
    tmp = cBasePicURL & TextCoverURL
    'Debug.Print tmp
    OpenURLProxy tmp, "pic"
Else
    'Set ImgPrCov = Nothing: Set PicFrontFace = Nothing: Set picCanvas = Nothing
    'NoPicFrontFaceFlag = True
End If
End Sub

Private Sub ComInterGoHid_Click(Index As Integer)

Dim temp As Long
Dim strPath As String
Dim site As String

strPath = Space$(255)

Select Case Index
Case 0
    site = ComboSites.Text
Case 1
    site = TextMovURL.Text
End Select

temp = FindExecutable(site, "", strPath)
Select Case temp
Case 31
    myMsgBox msgsvc(17), vbInformation, , Me.hWnd
    Exit Sub
Case 2
End Select

temp = ShellExecute(GetDesktopWindow(), "open", site, vbNull, vbNull, 1)
ToDebug "InterGo_ret=" & temp
End Sub
'*******************************
'*** Get minimum of three values
'*******************************

Private Function Minimum(ByVal a As Integer, _
                         ByVal B As Integer, _
                         ByVal c As Integer) As Integer
Dim mi As Integer
                          
  mi = a
  If B < mi Then
    mi = B
  End If
  If c < mi Then
    mi = c
  End If
  
  Minimum = mi
                          
End Function

'********************************
'*** Compute Levenshtein Distance
'********************************

Public Function LD(ByVal s As String, ByVal t As String) As Integer
Dim d() As Integer ' matrix
Dim M As Integer ' length of t
Dim n As Integer ' length of s
Dim i As Integer ' iterates through s
Dim j As Integer ' iterates through t
Dim s_i As String ' ith character of s
Dim t_j As String ' jth character of t
Dim cost As Integer ' cost
  
  ' Step 1
  
  n = Len(s)
  M = Len(t)
  If n = 0 Then
    LD = M
    Exit Function
  End If
  If M = 0 Then
    LD = n
    Exit Function
  End If
  ReDim d(0 To n, 0 To M) As Integer
  
  ' Step 2
  
  For i = 0 To n
    d(i, 0) = i
  Next i
  
  For j = 0 To M
    d(0, j) = j
  Next j

  ' Step 3

  For i = 1 To n
    
    s_i = Mid$(s, i, 1)
    
    ' Step 4
    
    For j = 1 To M
      
      t_j = Mid$(t, j, 1)
      
      ' Step 5
      
      If s_i = t_j Then
        cost = 0
      Else
        cost = 1
      End If
      
      ' Step 6
      
      d(i, j) = Minimum(d(i - 1, j) + 1, d(i, j - 1) + 1, d(i - 1, j - 1) + cost)
    
    Next j
    
  Next i
  
  ' Step 7
  
  LD = d(n, M)
  Erase d

End Function




Private Sub Command2_Click()
'
'
Dim i As Long
Dim R() As String
Dim rsArr() As String
Dim arrKeys() As String    ' 0
Dim Pers As String
Dim sSQL As String
Dim rsTmp As DAO.Recordset
Dim sKeys As String
Dim Itm As MSComctlLib.ListItem

On Error GoTo err
Screen.MousePointer = vbHourglass
DoEvents

ReDim rsArr(0)
ReDim arrKeys(0)

ars.MoveFirst

Do While Not ars.EOF
    If IsNull(ars("Name")) Then    ' 
    ElseIf Len(ars("Name")) = 0 Then    ' 
    Else
        Pers = ars("Name")
        
'   
For Each Itm In LVActer.ListItems
i = LD(Pers, Itm.Text)
If i > 0 Then
If i < 15 Then
'
                        arrKeys(UBound(arrKeys)) = ars("Key")
                        ReDim Preserve arrKeys(UBound(arrKeys) + 1)
Exit For
End If
End If
Next
'        If InStrB(Pers, "(") > 0 Then Pers = Replace(Pers, "(", ",")
'        If InStrB(Pers, ")") > 0 Then Pers = Replace(Pers, ")", ",")
'        If InStrB(Pers, "/") > 0 Then Pers = Replace(Pers, "/", ",")
'Pers = Replace(Pers, " ", ",")
'        If InStrB(Pers, "-") > 0 Then Pers = Replace(Pers, "-", ",")
'        'Pers = Replace(Pers, ".", ",")
'        If InStr(Pers, "jr") > 0 Then Pers = Replace(Pers, "jr", ",")
'        'SQLCompatible Pers
'        If InStrB(Pers, "'") > 0 Then Pers = Replace(Pers, "'", "''")
'        If Tokenize05(Pers, r(), ",", 4) > -1 Then   '     >      ' False-    .
'            If SQLSeparQuery(r(), 3, sSQL) Then '  - 
'            'Debug.Print sSQL
'            ' 
'            Set rsTmp = ADB.OpenRecordset(sSQL)

'  ars ,   >1
'If Not (rsTmp.BOF And rsTmp.EOF) Then
'If rsTmp(0) > 1 Then
'                        arrKeys(UBound(arrKeys)) = ars("Key")
'                        ReDim Preserve arrKeys(UBound(arrKeys) + 1)
'End If
'End If
'
'
'            End If
'        End If

End If
    'Exit Sub
    
    ars.MoveNext
Loop

Set rsTmp = Nothing
'Exit Sub

'  

',    count
TriQuickSortString arrKeys            'sorts your string array
remdups arrKeys                       'removes dups

Screen.MousePointer = vbNormal
If UBound(arrKeys) = 0 Then Exit Sub '  

sKeys = Join(arrKeys, ",")
'Debug.Print sKeys

'    
Set ars = ADB.OpenRecordset("Select * From Acter Where Key In (" & sKeys & ")")


Call OptActOnlyFotoHid_Click(6)
Exit Sub

err:
Screen.MousePointer = vbNormal
MsgBox err.Description
'ToDebug "Err_ActFuzz"
'MsgBox msgsvc(46), vbExclamation    ': ToDebug err.Description

End Sub
Private Function SQLSeparQuery(R() As String, n As Integer, ByRef qstr As String) As Boolean

'n      2,3,4
Dim i As Integer, j As Integer, k As Integer, M As Integer
Dim s As String
Dim ubr As Long

On Local Error GoTo err    '    

'sLike = "Name Like '**' And Name Like '**'"
'"Select * From Acter Where Name In (Select Name From Acter Group By Name HAVING Count(Name) > 1)")
' 
'sSQL = "Select Key From Acter Where (" & sLike & ")"
' 
'            sSQL = sSQL & " And InStr(Name, '" & r(i) & "') > 0"
'            sSQL = right$(sSQL, Len(sSQL) - 5)    '-  AND

ubr = UBound(R)
''If UBound(r) + 1 < n Then n = UBound(r) + 1
'If UBound(R) + 1 < n Then Exit Function
'If UBound(R) > 6 Then Exit Function
If ubr + 1 < n Then Exit Function
If ubr > 6 Then Exit Function

Select Case n
Case 1
    For i = 0 To ubr
        's = s & " Or (InStr(Name, '" & r(i) & "') > 0)"
        s = s & " Or (Name Like '*" & R(i) & "*')"
    Next i

Case 2
    For i = 0 To ubr
        For j = i + 1 To ubr
            's = r(i) & r(j) & " " & s
            's = s & " Or (InStr(Name, '" & r(i) & "') > 0 And InStr(Name, '" & r(j) & "') > 0)"
            s = s & " Or (Name Like '*" & R(i) & "*' And Name Like '*" & R(j) & "*')"
        Next j
    Next i

Case 3
    For i = 0 To ubr
        For j = i + 1 To ubr
            For k = j + 1 To ubr
                's = r(i) & r(j) & r(k) & " " & s
                's = s & " Or (InStr(Name, '" & r(i) & "') > 0 And InStr(Name, '" & r(j) & "' ) > 0 And InStr(Name, '" & r(k) & "' ) > 0)"
                s = s & " Or (Name Like '*" & R(i) & "*' And Name Like '*" & R(j) & "*' And Name Like '*" & R(k) & "*')"
            Next k
        Next j
    Next i

Case 4
    For i = 0 To ubr
        For j = i + 1 To ubr
            For k = j + 1 To ubr
                For M = k + 1 To ubr
                    's = r(i) & r(j) & r(k) & r(m) & " " & s
                    's = s & " Or (InStr(Name, '" & r(i) & "') > 0 And InStr(Name, '" & r(j) & "' ) > 0 And InStr(Name, '" & r(k) & "' ) > 0 And InStr(Name, '" & r(m) & "' ) > 0)"
                    s = s & " Or (Name Like '*" & R(i) & "*' And Name Like '*" & R(j) & "*' And Name Like '*" & R(k) & "*' And Name Like '*" & R(M) & "*')"
                Next M
            Next k
        Next j
    Next i

End Select

'SQLSeparQuery = s '
s = right$(s, Len(s) - 4)    '-  or
'qstr = "Select Name, Key From Acter Where (" & s & ")"
qstr = "Select Count(Name) From Acter Where (" & s & ")"

SQLSeparQuery = True
Exit Function

err:
SQLSeparQuery = False
End Function

Private Sub Command1_Click()
'  , 
' ,   1(    ) 2  3  4  (N)
'a b c (e f g)  -
'   N-  SQLSeparQuery() as  
'        
'  . .....
'
'
Dim i As Long
Dim R() As String
Dim rsArr() As String
Dim arrKeys() As String    ' 0
Dim Pers As String
Dim sSQL As String
Dim rsTmp As DAO.Recordset
Dim sKeys As String
Dim ubr As Long

On Error GoTo err
Screen.MousePointer = vbHourglass
DoEvents

'ReDim rsArr(0)
ReDim arrKeys(0)

ars.MoveFirst
Dim t As Long
t = GetTickCount

Do While Not ars.EOF
    If IsNull(ars("Name")) Then    ' 
    ElseIf Len(ars("Name")) = 0 Then    ' 
    Else
        Pers = ars("Name")
'        If InStrB(Pers, "(") > 0 Then Pers = Replace(Pers, "(", ",")
'        If InStrB(Pers, ")") > 0 Then Pers = Replace(Pers, ")", ",")
'        If InStrB(Pers, "/") > 0 Then Pers = Replace(Pers, "/", ",")
'        If InStrB(Pers, "-") > 0 Then Pers = Replace(Pers, "-", ",")
        If InStrB(Pers, Chr(40)) > 0 Then Pers = Replace(Pers, "(", ",")
        If InStrB(Pers, Chr(41)) > 0 Then Pers = Replace(Pers, ")", ",")
        If InStrB(Pers, Chr(47)) > 0 Then Pers = Replace(Pers, "/", ",")
        If InStrB(Pers, Chr(45)) > 0 Then Pers = Replace(Pers, "-", ",")

Pers = Replace(Pers, " ", ",")
        'Pers = Replace(Pers, ".", ",")
        'If InStr(Pers, "jr") > 0 Then Pers = Replace(Pers, "jr", ",")
        'SQLCompatible Pers
If InStrB(Pers, Chr(39)) > 0 Then Pers = Replace(Pers, "'", "''")

ubr = Tokenize05(Pers, R(), ",", 0)
        If ubr > -1 Then   '     >      ' False-    .
    '    If ubr > -1 And ubr < 2 Then '     >      ' False-    .

            If SQLSeparQuery(R(), 1, sSQL) Then  '  - 

            'Debug.Print sSQL

            ' 
            Set rsTmp = ADB.OpenRecordset(sSQL)

'  ars ,   >1
If Not (rsTmp.BOF And rsTmp.EOF) Then
If rsTmp(0) > 1 Then
                        arrKeys(UBound(arrKeys)) = ars("Key")
                        ReDim Preserve arrKeys(UBound(arrKeys) + 1)
End If
End If
Set rsTmp = Nothing
'            '    arrKeys
'            If Not (rsTmp.BOF And rsTmp.EOF) Then
'                rsTmp.MoveLast
'                rsTmp.MoveFirst
'                If rsTmp.RecordCount > 1 Then
'                    For i = 1 To rsTmp.RecordCount
'                        ' Do While Not rsTmp.EOF
'                        arrKeys(UBound(arrKeys)) = rsTmp("Key")
'                        'If i <> rsTmp.RecordCount Then
'                        ReDim Preserve arrKeys(UBound(arrKeys) + 1)
'
'                        rsTmp.MoveNext
'                        'ReDim Preserve arrKeys(UBound(arrKeys) + 1)
'                        'Loop
'                    Next i
'                End If
'            End If


            End If
        End If
    End If
    'Exit Sub
    ars.MoveNext

Loop

Debug.Print GetTickCount - t

Set rsTmp = Nothing
'Exit Sub

'  

',    count
'TriQuickSortString arrKeys            'sorts your string array
'remdups arrKeys                       'removes dups

Screen.MousePointer = vbNormal
If UBound(arrKeys) = 0 Then Exit Sub '  

sKeys = Join(arrKeys, ",")
'Debug.Print sKeys

'    
Set ars = ADB.OpenRecordset("Select * From Acter Where Key In (" & sKeys & ")")


Call OptActOnlyFotoHid_Click(6)
Exit Sub

err:
Screen.MousePointer = vbNormal
MsgBox err.Description
'ToDebug "Err_ActFuzz"
'MsgBox msgsvc(46), vbExclamation    ': ToDebug err.Description


End Sub



Public Sub ComPlusHid_Click(Index As Integer)
Select Case Index

Case 0
    If LenB(Trim$(ComboGenre.Text)) = 0 Then Exit Sub    ''    
    If LenB(Trim$(TextGenre.Text)) = 0 Then
        TextGenre.Text = ComboGenre.Text
    Else
        TextGenre.Text = TextGenre.Text & ", " & ComboGenre.Text
    End If

Case 1
    If LenB(Trim$(ComboCountry.Text)) = 0 Then Exit Sub
    If LenB(Trim$(TextCountry.Text)) = 0 Then
        TextCountry.Text = ComboCountry.Text
    Else
        TextCountry.Text = TextCountry.Text & ", " & ComboCountry.Text
    End If

Case 3
    ' 
    If LenB(Trim$(ComboOther.Text)) = 0 Then Exit Sub
    If LenB(Trim$(TextOther.Text)) = 0 Then
        TextOther.Text = ComboOther.Text
    Else
        TextOther.Text = TextOther.Text & ", " & ComboOther.Text
    End If

Case 2

    ' 
    Dim arr() As String
    Dim i As Integer
    Dim tmpL As Long, tmpL1 As Long

    '  ", "
    If right$(TextTimeHid.Text, 2) = ", " Then TextTimeHid.Text = left$(TextTimeHid.Text, Len(TextTimeHid.Text) - 2)

    If Len(TextTimeHid.Text) <> 0 Then
        arr = Split(TextTimeHid.Text, ",")
        If UBound(arr) > 0 Then
            TextTimeHidText = TextTimeHid.Text
            For i = 0 To UBound(arr)
                tmpL1 = Time2sec(arr(i))
                If tmpL1 > -1 Then tmpL = tmpL + tmpL1
            Next i
            If tmpL > 0 Then TextTimeHid.Text = FormatTime(tmpL)
        Else
            '
            If Len(TextTimeHidText) <> 0 Then
                'TextTimeHidText
                TextTimeHid.Text = TextTimeHidText
                TextTimeHidText = vbNullString
            End If
        End If
    End If

End Select

End Sub

Private Sub ComRHid_Click(Index As Integer)

Dim tmp As String
Dim temp As Long
Dim strPath As String
Dim site As String

On Error GoTo err

strPath = Space$(255)

Select Case Index
Case 0 '  
    tmp = Replace(TextActName.Text, "(", vbNullString)
    tmp = Replace(tmp, ")", vbNullString)
    tmp = Replace(tmp, "/", vbNullString)

    'site = "http://images.yandex.ru/yandsearch?stype=image&text=" & tmp
    site = "http://images.google.com/images?q=" & tmp
    
Case 1 '  
    tmp = Replace(TxtIName.Text, "(", vbNullString)
    tmp = Replace(tmp, ")", vbNullString)
    tmp = Replace(tmp, "/", vbNullString)

    site = "http://www.google.com/search?q=" & tmp
End Select


temp = FindExecutable(site, "", strPath)
Select Case temp
Case 31
myMsgBox msgsvc(17), vbInformation, , Me.hWnd
Exit Sub
Case 2
End Select

temp = ShellExecute(GetDesktopWindow(), "open", site, vbNull, vbNull, 1)
ToDebug "crh_ret=" & temp

Exit Sub
err:
ToDebug "Err_RHid: " & err.Description
End Sub


Private Sub Form_KeyPress(KeyAscii As Integer)
'Debug.Print KeyAscii

On Error Resume Next

Select Case KeyAscii

Case 14 '^N
    'Select Case True
    '    Case FrameView.Visible
            Call mnuAddNewMov_Click
    '    Case FrameActer.Visible
    '        ComAddAct_Click
    '    Case FrameAddEdit.Visible
    '        ComOpen_Click
    'End Select
    
Case 15 '^O
    Select Case True
    '    Case FrameView.Visible
    '        Call mnuAddNewMov_Click
        Case FrameActer.Visible
            ComAddAct_Click
        Case FrameAddEdit.Visible
            ComOpen_Click
    End Select
    
Case 19 '^S
    Select Case True
    '    Case FrameView.Visible
    '        Call mnuAddNewMov_Click
        Case FrameActer.Visible
            ComActSave_Click
        Case FrameAddEdit.Visible
            ComSaveRec_Click
    End Select
    
Case 5 '^E
    If FrameView.Visible Then
        Call mnuEditMov_Click
    End If
    
Case 6 'crtl+F
    If FrameView.Visible Then
        Call mSR_Click '
    End If

Case 17 'crtl+Q
    If FrameView.Visible Then
        Call ComFilter_Click '
    End If
    
End Select
End Sub

Private Sub FrSplitD_Vert_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)
' Tracking is initialised by entering the control:
FrSplitD_Vert.MousePointer = 9
If Not (m_SS_Vert.Tracking) Then m_SS_Vert.StartMouseTracking
End Sub

Private Sub FrSplitD_Vert_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)
'  
If Opt_NoSlideShow Then
    SplitLVD = ((x + picScrollBoxV.Width) * 100) / SSCoverAnnotW
Else
    SplitLVD = ((x + FrameImageHid.Width) * 100) / SSCoverAnnotW
End If
Form_Resize
End Sub

Private Sub ImgPrCov_Click()
Call picCanvas_Click
End Sub

Private Sub ListBActHid_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)
'  
If Button = vbRightButton Then OptActOnlyFotoHid_Click 4
End Sub

Private Sub ListView_Click()
LVCLICK
End Sub


Private Sub ListView_KeyDown(KeyCode As Integer, Shift As Integer)
Timer2.Enabled = False

'Debug.Print KeyCode, Shift

Select Case KeyCode
    
Case 46 'Del
 If Shift = 0 Then ' sel
    mDelSel_Click
 Else ' ch
    mDelCh_Click
 End If
 
End Select

End Sub

Private Sub ListView_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)
' ,  
On Error Resume Next
'If Not FormShowPicLoaded Then
If LstFiles.Visible Then Exit Sub
If frmSRFlag Then
    If frmSR.Visible Then Exit Sub
End If
If TextItemHid.SelLength > 0 Then Exit Sub

If GetForegroundWindow = Me.hWnd Then
If ActiveControl.name <> "ListView" Then ListView.SetFocus
End If
End Sub

Private Sub ListView_OLEGiveFeedback(Effect As Long, DefaultCursors As Boolean)
If SelCount = 1 Then
    If ListView.SelectedItem.Index <> CurSearch Then
        LVCLICK
    End If
End If
End Sub

Private Sub LstFiles_Click()
If LstFiles.ListIndex > -1 Then
 LstFiles.Visible = False
 PlayMovie LstFiles.Text
End If
End Sub

Private Sub LstFiles_LostFocus()
LstFiles.Visible = False
End Sub

Private Sub LVActer_Click()
LVActClick
End Sub

Private Sub LVActer_DblClick()
If ars.RecordCount = 0 Then Exit Sub
If LVActer.ListItems.Count < 1 Then Exit Sub

TextSearchLVActTypeHid = LVActer.ListItems(LVActer.SelectedItem.Index)

End Sub

Private Sub LVActer_KeyUp(KeyCode As Integer, Shift As Integer)
    LVActClick
End Sub

Private Sub LVActer_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)
On Error Resume Next
If ActNewFlag Or ActEditFlag Then Exit Sub
If TextActBio.SelLength <> 0 Then Exit Sub
If TextActName.SelLength <> 0 Then Exit Sub

If GetForegroundWindow = Me.hWnd Then
If ActiveControl.name = "TextSearchLVActTypeHid" Then Exit Sub
If ActiveControl.name <> "LVActer" Then LVActer.SetFocus
End If
End Sub


Private Sub mCh2Excel_Click()
If CheckCount = 0 Then Exit Sub
Export2Excel True
End Sub

Private Sub mChSel_Click()
' 
If SelCount < 1 Then Exit Sub

Dim Itm As MSComctlLib.ListItem

For Each Itm In ListView.ListItems
 If Itm.Selected Then
  Itm.Checked = True
  ListView_ItemCheck Itm
 End If
Next
LVCLICK
End Sub

Private Sub mCombine_Click()
If CheckCount < 2 Then Exit Sub
JoinMovies True 'for checked
End Sub

Private Sub mConvert_Click()
Dim tmp As String
On Error Resume Next
tmp = App.Path & "\convert2svc.exe"
If FileExists(tmp) Then
    Shell tmp, vbNormalFocus
End If
End Sub

Private Sub mDelCh_Click()
If CheckCount = 0 Then Exit Sub
DelMovies True 'for checked
End Sub
Private Sub mDelSel_Click()
If SelCount < 1 Then Exit Sub
DelMovies False 'for selected
End Sub

Private Sub mFiltAct_Click()
'       
'    
'   ,  

If Len(sPerson) = 0 Then Exit Sub

Dim strSQL As String

Screen.MousePointer = vbHourglass
LastSQLPersonString = "Director Like '*" & sPerson & "*' Or Acter Like '*" & sPerson & "*'"
strSQL = "SELECT * FROM Storage WHERE (" & LastSQLPersonString & ")"

If GroupedFlag Then
    '   
    strSQL = strSQL & " AND (" & LastSQLGroupString & ")"
'Else
'    strSQL = strSQL & ")"
End If

'Debug.Print "mFA:" & strSQL

On Error GoTo err
Set rs = DB.OpenRecordset(strSQL)

FillListView
' 
FiltPersonFlag = True
FrmMain.ComFilter.BackColor = &HC0C0FF

Screen.MousePointer = vbNormal
Exit Sub

err:
Screen.MousePointer = vbNormal
ToDebug "Err_mFiltA:" & err.Description
End Sub

Private Sub mFiltActAll_Click()
'    ,        
'      

Dim j As Long
Dim R() As String
Dim ArrFlag As Boolean
Dim rsArr() As String
Dim Pers As String
Dim sSQL As String

Screen.MousePointer = vbHourglass
DoEvents

Pers = CheckNoNull("Director") & "," & CheckNoNull("Acter")
Pers = Replace(Pers, "(", ",")
Pers = Replace(Pers, ")", ",")
Pers = Replace(Pers, "/", ",")
Pers = Replace(Pers, "-", ",")
'Pers = Replace(Pers, ".", ",")
Pers = Replace(Pers, "jr", ",")
SQLCompatible Pers

ReDim rsArr(0)

If Len(Pers) < 5 Then      '  
Screen.MousePointer = vbNormal
Else
    If Tokenize04(Pers, R(), ",", False) > -1 Then                  ' False   .
      TriQuickSortString R    'sorts your string array
      remdups R    'removes all duplicates

        For j = 0 To UBound(R)
            If ArrFlag Then ' 
                ReDim Preserve rsArr(UBound(rsArr) + 1)
                'join  
                If Len(R(j)) > 6 Then rsArr(UBound(rsArr)) = "Or Name Like '*" & Trim$(R(j)) & "*'"
            Else '
                ArrFlag = True
                ' ,       Or
                If Len(R(j)) > 6 Then rsArr(UBound(rsArr)) = " Name Like '*" & Trim$(R(j)) & "*'"
            End If

        Next j
    End If

  '      TriQuickSortString rsArr    'sorts your string array
  '      remdups rsArr    'removes all duplicates

    If (UBound(rsArr) = 0) And (Not ArrFlag) Then
        '
        Screen.MousePointer = vbNormal
    Else
        'UBound(rsArr) + 1 , 
        Pers = Join(rsArr)
If left$(Pers, 3) = " Or" Then Pers = right$(Pers, Len(Pers) - 3)

        '  sSQL = "Select * From Acter Where Name In (" & Pers & ")"

        sSQL = "Select * From Acter Where" & Pers

'Debug.Print sSQL

        On Error GoTo err
        Set ars = ADB.OpenRecordset(sSQL)

        Call OptActOnlyFotoHid_Click(5)
        VerticalMenu_MenuItemClick 5, 0
        Screen.MousePointer = vbNormal

    End If
End If
Exit Sub

err:
Screen.MousePointer = vbNormal
'MsgBox err.Description
ToDebug "Err_FActAll"
MsgBox msgsvc(46), vbExclamation ': ToDebug err.Description

End Sub

Private Sub mGetCoverCh_Click()
InetGetPics True
End Sub

Private Sub mGetCoverSel_Click()
InetGetPics False
End Sub

Private Sub mGotoURL_Click()
Dim temp As Long
Dim strPath As String
Dim site As String

On Error GoTo err
If SelCount < 1 Then Exit Sub
strPath = Space$(255)

site = CheckNoNull("MovieURL")
If Len(site) = 0 Then Exit Sub

temp = FindExecutable(site, "", strPath)
Select Case temp
Case 31
myMsgBox msgsvc(17), vbInformation, , Me.hWnd
Exit Sub
Case 2
End Select

temp = ShellExecute(GetDesktopWindow(), "open", site, vbNull, vbNull, 1)
ToDebug "goMURL=" & temp

Exit Sub
err:
ToDebug "Err_goMURL: " & err.Description
End Sub

Private Sub mGroup_Click(Index As Integer)
'GroupedFlag = True
GroupColumnHeader = vbNullString
GroupInd = Index - 1
Select Case GroupInd
Case -1
'    GroupedFlag = False
    GroupColumnHeader = NamesStore(8)
    GroupField = vbNullString
'    InitFlag = True
'    TabLVHid_Click
'    Exit Sub
Case dbMovieNameInd: GroupField = "MovieName": GroupColumnHeader = ListView.ColumnHeaders(dbMovieNameInd + 1)
Case dbLabelInd: GroupField = "Label": GroupColumnHeader = ListView.ColumnHeaders(dbLabelInd + 1)
Case dbGenreInd: GroupField = "Genre": GroupColumnHeader = ListView.ColumnHeaders(dbGenreInd + 1)
Case dbYearInd: GroupField = "Year": GroupColumnHeader = ListView.ColumnHeaders(dbYearInd + 1)
Case dbCountryInd: GroupField = "Country": GroupColumnHeader = ListView.ColumnHeaders(dbCountryInd + 1)
Case dbDirectorInd: GroupField = "Director": GroupColumnHeader = ListView.ColumnHeaders(dbDirectorInd + 1)
Case dbActerInd: GroupField = "Acter": GroupColumnHeader = ListView.ColumnHeaders(dbActerInd + 1)
Case dbTimeInd: GroupField = "Time": GroupColumnHeader = ListView.ColumnHeaders(dbTimeInd + 1)
Case dbResolutionInd: GroupField = "Resolution": GroupColumnHeader = ListView.ColumnHeaders(dbResolutionInd + 1)
Case dbAudioInd: GroupField = "Audio": GroupColumnHeader = ListView.ColumnHeaders(dbAudioInd + 1)
Case dbFpsInd: GroupField = "FPS": GroupColumnHeader = ListView.ColumnHeaders(dbFpsInd + 1)
Case dbFileLenInd: GroupField = "FileLen": GroupColumnHeader = ListView.ColumnHeaders(dbFileLenInd + 1)
Case dbCDNInd: GroupField = "CDN": GroupColumnHeader = ListView.ColumnHeaders(dbCDNInd + 1)
Case dbMediaTypeInd: GroupField = "MediaType": GroupColumnHeader = ListView.ColumnHeaders(dbMediaTypeInd + 1)
Case dbVideoInd: GroupField = "Video": GroupColumnHeader = ListView.ColumnHeaders(dbVideoInd + 1)
Case dbSubTitleInd: GroupField = "SubTitle": GroupColumnHeader = ListView.ColumnHeaders(dbSubTitleInd + 1)
Case dbLanguageInd: GroupField = "Language": GroupColumnHeader = ListView.ColumnHeaders(dbLanguageInd + 1)
Case dbRatingInd: GroupField = "Rating": GroupColumnHeader = ListView.ColumnHeaders(dbRatingInd + 1)
Case dbFileNameInd: GroupField = "FileName": GroupColumnHeader = ListView.ColumnHeaders(dbFileNameInd + 1)
Case dbDebtorInd: GroupField = "Debtor": GroupColumnHeader = ListView.ColumnHeaders(dbDebtorInd + 1)
Case dbsnDiskInd: GroupField = "snDisk": GroupColumnHeader = ListView.ColumnHeaders(dbsnDiskInd + 1)
Case dbOtherInd: GroupField = "Other": GroupColumnHeader = ListView.ColumnHeaders(dbOtherInd + 1)
Case dbCoverPathInd: GroupField = "CoverPath": GroupColumnHeader = ListView.ColumnHeaders(dbCoverPathInd + 1)
Case dbMovieURLInd: GroupField = "MovieURL": GroupColumnHeader = ListView.ColumnHeaders(dbMovieURLInd + 1)

End Select
If right$(GroupColumnHeader, 2) = " >" Or right$(GroupColumnHeader, 2) = " <" Then GroupColumnHeader = left$(GroupColumnHeader, Len(GroupColumnHeader) - 2)
GroupColumnHeader = "<" & GroupColumnHeader & ">"
tvGroup.ColumnHeaders(1).Text = GroupColumnHeader
FillTVGroup
End Sub

Private Sub mInvCh_Click()
' 
If ListView.ListItems.Count < 1 Then Exit Sub

Dim Itm As MSComctlLib.ListItem

For Each Itm In ListView.ListItems
    Itm.Checked = Not Itm.Checked
    ListView_ItemCheck Itm
Next
LVCLICK
End Sub

Private Sub mInvSel_Click()
' 
If ListView.ListItems.Count < 1 Then Exit Sub
Dim SelIt As Boolean

Dim Itm As MSComctlLib.ListItem

For Each Itm In ListView.ListItems
If Itm.Index = CurSearch Then
    If Itm.Selected Then
        SelIt = False
    Else
        SelIt = True
    End If
End If

   Itm.Selected = Not Itm.Selected
Next
    
ListView.ListItems(CurSearch).Selected = True
ListView.ListItems(CurSearch).Selected = SelIt

LVCLICK
End Sub

Private Sub mnuAddNewAuto_Click()
If BaseReadOnly Or BaseReadOnlyU Then
myMsgBox msgsvc(24), vbInformation, , Me.hWnd
Exit Sub
End If

FrmAuto.Show 1, Me
'If LastVMI <> 1 Then VerticalMenu_MenuItemClick 1
End Sub

Private Sub mnuCard_Click()
DoEvents
mnuCard.Checked = Not mnuCard.Checked
Opt_UCLV_Vis = mnuCard.Checked
If Not Opt_UCLV_Vis Then UCLV.Clear
Form_Resize
LVCLICK

optsaved = False
End Sub

Private Sub mnuCopyRow_Click()
Call MakeDupCurrent
End Sub

Private Sub mnuCoverCopy_Click()
Clipboard.Clear
'PicFaceV.Picture = PicFaceV.Image
Clipboard.SetData PicCoverPaper.Picture ', vbCFBitmap
End Sub

Private Sub mnuCoverSave_Click()
'      
SavePicFromPic PicCoverPaper, FrmMain.hWnd
End Sub

Private Sub mnuGroup_Click()
Dim ret As Long

mnuGroup.Checked = Not mnuGroup.Checked
Opt_Group_Vis = mnuGroup.Checked
Form_Resize
'Form_Resize
If Opt_Group_Vis Then
    'FillTVGroup
    If Not GroupedFlag Then mGroup_Click 0    '
Else
    If GroupedFlag Then
        ret = myMsgBox(msgsvc(42), vbYesNo, , FrmMain.hWnd)    ' ?
        If ret = vbNo Then InitFlag = True    '     
        TabLVHid.Tabs(CurrentBaseIndex).Selected = True
    End If
End If

optsaved = False
End Sub

Private Sub mnuLabelCheck_Click()
If CheckCount > 0 Then Call MNU_Label(False) 'Check
End Sub

Private Sub mnuLabelSel_Click()
If SelCount < 1 Then Exit Sub
Call MNU_Label(True) 'sel
End Sub



Private Sub mnuUndo_Click()
Call SendMessage(ActiveControl.hWnd, WM_UNDO, 0, ByVal 0&)
End Sub

Private Sub mSel2Excel_Click()
If SelCount < 1 Then Exit Sub
DoEvents
Export2Excel False
End Sub

Private Sub mSelCh_Click()
' 
If CheckCount = 0 Then Exit Sub
Dim SelIt As Boolean
Dim Itm As MSComctlLib.ListItem

For Each Itm In ListView.ListItems

If Itm.Index = CurSearch Then
    If Itm.Selected Then
        SelIt = True
    Else
       If Itm.Checked Then SelIt = True Else SelIt = False
    End If
End If

 If Itm.Checked Then
  Itm.Selected = True
  'ListView_ItemCheck Itm
 End If
Next

ListView.ListItems(CurSearch).Selected = True
ListView.ListItems(CurSearch).Selected = SelIt
LVCLICK

End Sub

Private Sub mSR_Click()
If ListView.ListItems.Count < 1 Then Exit Sub
frmSR.Show , Me
End Sub

Private Sub mUnChSel_Click()
'  
If SelCount < 1 Then Exit Sub

Dim Itm As MSComctlLib.ListItem

For Each Itm In ListView.ListItems
 If Itm.Selected Then
  Itm.Checked = False
  ListView_ItemCheck Itm
 End If
Next
LVCLICK

End Sub

Private Sub mUnSelCh_Click()
'  
If CheckCount = 0 Then Exit Sub

Dim Itm As MSComctlLib.ListItem

For Each Itm In ListView.ListItems
 If Itm.Checked Then
  Itm.Selected = False
  'ListView_ItemCheck Itm
 End If
Next
LVCLICK

End Sub

Private Sub mValid_Click()
'   ,   -
Dim UniSelect As String ' 
'1             a
'1             b
'2             c
'2             d
'3             e
'4             e
'5             f
'6             g
Dim strSQL1 As String, strSQL2 As String '  (1, 2)  .     > 1
'    
'1   e
'2
Dim strSQL As String '  In 

DoEvents

UniSelect = "(select label,sndisk from storage group by label,sndisk)"
strSQL1 = "(select label from " & UniSelect & " group by label HAVING Count(Label) > 1)"
strSQL2 = "(select sndisk from " & UniSelect & " group by sndisk HAVING Count(sndisk) > 1)"
strSQL = "select * From Storage Where (Label In (" & strSQL1 & ") Or sndisk In (" & strSQL2 & "))"

'Debug.Print strSQL

Screen.MousePointer = vbHourglass
On Error GoTo err
Set rs = DB.OpenRecordset(strSQL)

FillListView
' 
FiltValidationFlag = True
FrmMain.ComFilter.BackColor = &HC0C0FF

Screen.MousePointer = vbNormal
Exit Sub

err:
Screen.MousePointer = vbNormal
ToDebug "Err_mValid:" & err.Description
End Sub

Private Sub OptActOnlyFotoHid_Click(Index As Integer)
'    Set ars = ADB.OpenRecordset("Select * From Acter Where " & tmp)
'Dim strSQL As String

Select Case Index
Case 0    'all
    'Set ars = ADB.OpenRecordset("Select * From Acter")
    Set ars = ADB.OpenRecordset("Acter", dbOpenTable)
    ars.Index = "KeyAct"
    FilterActFlag = False
    ToDebug " ..."

Case 1    'with foto
    Set ars = ADB.OpenRecordset("Select * From Acter Where Face <> ''")
    FilterActFlag = True
    ToDebug "  ..."
Case 2    'w/out foto
    Set ars = ADB.OpenRecordset("Select * From Acter Where Face Is Null")
    FilterActFlag = True
    ToDebug "  ..."

Case 3
    Set ars = ADB.OpenRecordset("Select * From Acter Where Name In (Select Name From Acter Group By Name HAVING Count(Name) > 1)")
    FilterActFlag = True
    ToDebug "  "

    'work Set ars = ADB.OpenRecordset("Select * From Acter Where Left(Name,10) In (Select Left(Name,10) From Acter Group By Left(Name,10) HAVING Count(Left(Name,10)) > 1)")


    'Dim tmp As String
    'Dim rstemp As DAO.Recordset
    'Dim i As Integer
    ''tmp = "Select Left(Name,10) From Acter Group By Left(Name,10)" ' HAVING Count(Left(Name,5)) > 1"
    'tmp = "Select Left(Name,8) From Acter" ' Group By Name HAVING Count(Left(Name,1)) > 1"
    'tmp = "Select * From Acter Where Left(Name,8) in (Select Left(Name,8) From Acter Group By Left(Name,8) HAVING Count(Left(Name,8)) > 1)"
    'Debug.Print tmp
    'Set rstemp = ADB.OpenRecordset(tmp)
    'rstemp.MoveFirst: For i = 0 To 10: Debug.Print rstemp(0): rstemp.MoveNext: Next i
    ''tmp = "Select * From Acter Where Name Like (Select Left$(Name,5) From Acter Group By Name HAVING Count(Name) > 1)"
    ''Debug.Print tmp
    ''Set ars = ADB.OpenRecordset(tmp)
    ''Set ars = ADB.OpenRecordset("Select * From Acter Where Name In (Select Left$(Name,5) From Acter Group By Name HAVING Count(Name) > 1)")
    ''Set ars = ADB.OpenRecordset("Select * From Acter Where Left$(Name,5) In (Select Name From Acter Group By Name HAVING Count(Name) > 1)")


Case 4    '    
    '  
    Dim i As Integer
    Dim tmp As String
    If ListBActHid.SelCount < 1 Then Exit Sub
ToDebug "  "
    For i = 0 To ListBActHid.ListCount - 1
        If ListBActHid.Selected(i) Then
            tmp = tmp & " And InStr(name, '" & ListBActHid.List(i) & "') > 0"
        End If
    Next i
    tmp = right$(tmp, Len(tmp) - 5)    '-  AND
    Set ars = ADB.OpenRecordset("Select * From Acter Where " & tmp)

    FilterActFlag = True
    ' 
    For i = 0 To 3
        OptActOnlyFotoHid(i).Value = False
    Next i

Case 5 '      
ToDebug "   "

 FilterActFlag = True
     ' 
    For i = 0 To 3
        OptActOnlyFotoHid(i).Value = False
    Next i

Case 6
'  2 
 FilterActFlag = True
     ' 
    For i = 0 To 3
        OptActOnlyFotoHid(i).Value = False
    Next i
    
On Error GoTo err


End Select


If FilterActFlag Then
'OptActOnlyFotoHid(0).BackColor = &HFF&
FrameActer.ForeColor = &HC0&      '&HFFFF&
Else
'OptActOnlyFotoHid(0).BackColor = &H8000000F
FrameActer.ForeColor = &H80000012
End If


'  1
If ars.RecordCount > 0 Then CurAct = 1

If ars.RecordCount = 0 Then
    '  
    PicActFoto.Height = 0: PicActFoto.Width = 0    ' 
    LVActer.ListItems.Clear
    Set PicActFoto.Picture = Nothing
    TextActName.Text = vbNullString
    TextActBio.Text = vbNullString
    FrameActer.Caption = FrameActerCaption & "0)"
    ListBActHid.Clear
    ComActEdit.Enabled = False
   ' ComActDel.Enabled = False

    Exit Sub
End If

ComActEdit.Enabled = True
'ComActDel.Enabled = True

'  
FillActListView

'
LVActClick

If LVActer.ListItems.Count > 0 Then LVActer.SelectedItem.EnsureVisible

Exit Sub
err:
MsgBox err.Description

End Sub

Private Sub optAspect_Click(Index As Integer)
On Error Resume Next
If ChangeFromCode_optAspect Then Exit Sub

DoEvents

Select Case Index
Case 0    '4:3
    MMI_Format_str = "4/3"
    MMI_Format = 1.333
    ToDebug "UserAspect-4:3"
Case 1    '16:9
    MMI_Format_str = "16/9"
    MMI_Format = 1.777
    ToDebug "UserAspect-16:9"
Case 2    'w:h
    'MMI_Format_str = "1/1"
    MMI_Format = 1.333 ' ...
    MMI_Format = objVideo.SourceWidth / objVideo.SourceHeight
    ToDebug "UserAspect-w:h"
    If err Then ToDebug "Err_VideoObj"

End Select

If Not (objVideo Is Nothing) Then
PixelRatio = objVideo.SourceHeight * MMI_Format / objVideo.SourceWidth
PixelRatioSS = ScrShotEd_W / MMI_Format
End If

movie.SetFocus

End Sub

Private Sub PicActFoto_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)
On Error Resume Next
If ActNewFlag Or ActEditFlag Then Exit Sub
If GetForegroundWindow = Me.hWnd Then
If ActiveControl.name <> "PicActFoto" Then PicActFoto.SetFocus
End If
End Sub



Private Sub PicActFoto_OLEDragDrop(Data As DataObject, Effect As Long, Button As Integer, Shift As Integer, x As Single, y As Single)
PicActFoto.Picture = Data.GetData(vbCFDIB)
 SavePicActFlag = True
' ComActSave.BackColor = &HC0C0E0
 PicActFotoScroll_Resize
End Sub

Private Sub PicActFoto_OLEDragOver(Data As DataObject, Effect As Long, Button As Integer, Shift As Integer, x As Single, y As Single, State As Integer)
' A drop is OK only if bitmap data is available.
If Data.GetFormat(vbCFBitmap) Or Data.GetFormat(vbCFDIB) Then
 If ActFlag Then Effect = vbDropEffectCopy Else Effect = vbDropEffectNone
Else
 Effect = vbDropEffectNone
End If

End Sub

Private Sub PicActFotoScroll_OLEDragDrop(Data As DataObject, Effect As Long, Button As Integer, Shift As Integer, x As Single, y As Single)
PicActFoto.Picture = Data.GetData(vbCFDIB)
 SavePicActFlag = True
' ComActSave.BackColor = &HC0C0E0
 PicActFotoScroll_Resize
End Sub

Private Sub PicActFotoScroll_OLEDragOver(Data As DataObject, Effect As Long, Button As Integer, Shift As Integer, x As Single, y As Single, State As Integer)
' A drop is OK only if bitmap data is available.
If Data.GetFormat(vbCFBitmap) Or Data.GetFormat(vbCFDIB) Then
 If ActFlag Then Effect = vbDropEffectCopy Else Effect = vbDropEffectNone
Else
 Effect = vbDropEffectNone
End If

End Sub

Private Sub picCanvas_Click()

If NoPicFrontFaceFlag Then Exit Sub
If NoDBFlag Then Exit Sub

PicTempHid(1).Picture = PicFrontFace.Image
IsCoverShowFlag = True
ViewScrShotFlag = False
FormShowPic.Visible = False

'  
'FormShowPic.hb_cScroll.Visible(efsHorizontal) = False
FormShowPic.PicHB.Visible = False

PicManualFlag = True

ShowInShowPic 1

FormShowPic.Visible = True

End Sub

Private Sub PicCoverPaper_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)
If Button = 2 Then
Me.PopupMenu Me.popCoverHid, vbPopupMenuCenterAlign
End If
End Sub



Private Sub TextActBio_GotFocus()
'     
'Dim word As String
Dim temp As String
Dim itmX As MSComctlLib.ListItem
Dim i As Long ', j As Integer
Dim VsegoSlov As Integer, Podhodit As Integer

If ActNewFlag Then
 TextActName.Text = sTrimChars(TextActName.Text, vbNewLine)
 If TextActName.Text <> vbNullString Then

For Each itmX In LVActer.ListItems
 i = i + 1
 temp = TextActName.Text
 VsegoSlov = 0: Podhodit = 0
    
 Do While temp <> vbNullString
  VsegoSlov = VsegoSlov + 1
  If InStr(1, itmX.Text, GetWord(temp), vbTextCompare) <> 0 Then Podhodit = Podhodit + 1
 Loop 'temp <> vbNullString
    
 If Podhodit = VsegoSlov Then
 
  ActNotManualClick = True
  Set LVActer.SelectedItem = LVActer.ListItems.Item(i)
  'LVActer.ListItems(i).EnsureVisible
  LV_EnsureVisible LVActer, i
  ActNotManualClick = False
  Exit Sub
 End If

'Debug.Print "itmX.Text=" & itmX.Text, "VsegoSlov=" & VsegoSlov, "Podhodit=" & Podhodit, "pos=" & i
Next 'itmX


End If 'TextActName.Text <> vbNullString
End If 'actflag
End Sub

Private Sub TextActBio_OLEDragDrop(Data As DataObject, Effect As Long, Button As Integer, Shift As Integer, x As Single, y As Single)
Dim plus As String
'IsTypingAct = False
'TextActBio.Text = sTrimChars(TextActBio.Text, vbNewLine)
If Data.GetFormat(1) Then
 If TextActBio.Text <> vbNullString Then plus = TextActBio.Text & vbCrLf
 TextActBio.Text = plus & Data.GetData(1)
End If
'TextActBio.Text = StrConv(TextActBio.Text, vbProperCase, LCID)

End Sub

Private Sub TextActBio_OLEDragOver(Data As DataObject, Effect As Long, Button As Integer, Shift As Integer, x As Single, y As Single, State As Integer)
If Not Data.GetFormat(vbCFText) Then Effect = vbDropEffectNone
If Not ActFlag Then Effect = vbDropEffectNone
End Sub

Private Sub TextActName_OLEDragDrop(Data As DataObject, Effect As Long, Button As Integer, Shift As Integer, x As Single, y As Single)
Dim plus As String
'IsTypingAct = False
TextActName.Text = sTrimChars(TextActName.Text, vbNewLine)
If Data.GetFormat(1) Then
If x > TextActName.Width / 2 Then
 If TextActName.Text <> vbNullString Then plus = TextActName.Text & " "
 TextActName.Text = plus & Data.GetData(1)
Else
 If TextActName.Text <> vbNullString Then plus = " " & TextActName.Text
 TextActName.Text = Data.GetData(1) & plus
End If

End If
TextActName.Text = StrConv(TextActName.Text, vbProperCase, LCID)
TextActName.Text = Replace(TextActName.Text, "  ", " ")
TextActName.Text = Trim$(TextActName.Text)

End Sub

Private Sub TextActName_OLEDragOver(Data As DataObject, Effect As Long, Button As Integer, Shift As Integer, x As Single, y As Single, State As Integer)
If Not Data.GetFormat(vbCFText) Then Effect = vbDropEffectNone
If Not ActFlag Then Effect = vbDropEffectNone

End Sub

Private Sub TextAudioHid_Change()
Mark2Save
End Sub

Private Sub TextCountry_Change()
Mark2Save
If Len(TextCountry.Text) > 255 Then TextCountry.Text = left$(TextCountry.Text, 255)
'SendMessage TextCountry.hWnd, CB_SHOWDROPDOWN, 1, ByVal 0
End Sub

Private Sub ComboInfoSites_KeyPress(KeyAscii As Integer)
KeyAscii = 0
End Sub

Private Sub ComCancel_Click()
OpenAddmovFlag = False
addflag = False
If rs.EditMode Then rs.CancelUpdate
NoPicFrontFaceFlag = False: NoPic1Flag = False: NoPic2Flag = False: NoPic3Flag = False
VerticalMenu_MenuItemClick 1, 0
End Sub

Private Sub ComCancelAct_Click()
'ComCancelAct.Enabled = False

TextActName.BackColor = LVBackColor
TextActBio.BackColor = LVBackColor
PicActFotoScroll.BackColor = LVBackColor

ComActSave.Enabled = False
ComActPast.Enabled = False
ComActFile.Enabled = False
ComActFotoDel.Enabled = False
ComActEdit.Enabled = True
'ComActDel.Enabled = True
ComAddAct.Enabled = True
TextSearchLVActTypeHid.Enabled = True
'PicActFotoScroll.Visible = False

If ars.EditMode Then ars.CancelUpdate
ActEditFlag = False: ActNewFlag = False: ActFlag = False
If ars.RecordCount = 0 Then Exit Sub

LVActClick

ComActSave.BackColor = &HFFFFFF

Dim i As Integer
For i = 0 To OptActOnlyFotoHid.Count - 1
OptActOnlyFotoHid(i).Enabled = True
Next i

ToDebug " "
End Sub

Private Sub ComCap_AVI(Index As Integer)
On Error GoTo ex
Screen.MousePointer = vbHourglass

Mark2Save
'If rs.EditMode = 0 Then rs.Edit

Select Case Index
''''''''''''''''''''''''''''''''''''0
Case 0
 Set PicSS1Big = Nothing
 NoPic1Flag = False
 PicSS1.Cls
 pos1 = Position.Value
 SavePic1Flag = True ' , 

If Opt_PicRealRes Then '
   
   PicSS1Big.Width = ScaleX(AviWidth, vbPixels, vbTwips)
   PicSS1Big.Height = ScaleY(AviHeight, vbPixels, vbTwips)
   m_cAVI.DrawFrame PicSS1Big.hdc, Position.Value, 0, 0, Transparent:=False
   PicSS1Big.Picture = PicSS1Big.Image
End If
   '   
   PicSS1.Height = PicSS1.Width * movie.Height / movie.Width
   PicSS1.PaintPicture movie.Image, 0, 0, PicSS1.ScaleWidth, PicSS1.ScaleHeight
   PicSS1.Picture = PicSS1.Image
   
   
''''''''''''''''''''''''''''''''''''1
Case 1
 Set PicSS2Big = Nothing
 NoPic2Flag = False
 PicSS2.Cls
 pos2 = Position.Value
 SavePic2Flag = True ' , 

If Opt_PicRealRes Then '
    
  PicSS2Big.Width = ScaleX(AviWidth, vbPixels, vbTwips)
  PicSS2Big.Height = ScaleY(AviHeight, vbPixels, vbTwips)
  m_cAVI.DrawFrame PicSS2Big.hdc, Position.Value, 0, 0, Transparent:=False
  PicSS2Big.Picture = PicSS2Big.Image
End If
   '   
   PicSS2.Height = PicSS2.Width * movie.Height / movie.Width
   PicSS2.PaintPicture movie.Image, 0, 0, PicSS2.ScaleWidth, PicSS2.ScaleHeight
   PicSS2.Picture = PicSS2.Image
    
''''''''''''''''''''''''''''''''''''2
Case 2
 Set PicSS3Big = Nothing
 NoPic3Flag = False
 PicSS3.Cls
 pos3 = Position.Value
 SavePic3Flag = True ' , 

 If Opt_PicRealRes Then '
    
   PicSS3Big.Width = ScaleX(AviWidth, vbPixels, vbTwips)
   PicSS3Big.Height = ScaleY(AviHeight, vbPixels, vbTwips)
   m_cAVI.DrawFrame PicSS3Big.hdc, Position.Value, 0, 0, Transparent:=False
   PicSS3Big.Picture = PicSS3Big.Image
 End If
   '   
   PicSS3.Height = PicSS3.Width * movie.Height / movie.Width
   PicSS3.PaintPicture movie.Image, 0, 0, PicSS3.ScaleWidth, PicSS3.ScaleHeight
   PicSS3.Picture = PicSS3.Image
   
End Select

ToDebug "ScrShotsPosAvi: " & pos1 & " " & pos2 & " " & pos3

ex:
If err.Number <> 0 Then ToDebug "ComCap_AVI: " & err.Description

If Not frmAutoFlag Then Me.SetFocus
Screen.MousePointer = vbNormal

End Sub

Private Sub ComCap_DSh(Index As Integer)
'   
On Error GoTo ex
Screen.MousePointer = vbHourglass

Mark2Save
'If rs.EditMode = 0 Then rs.Edit
ToDebug "Cap_DSh: " & Round(objVideo.SourceWidth, 0) & "x" & objVideo.SourceHeight

Select Case Index
''''''''''''''''''''''''''''''''''''0
Case 0
 Set PicSS1Big = Nothing
 NoPic1Flag = False
 PicSS1.Cls
 pos1 = Position.Value
 SavePic1Flag = True ' , 

 If Opt_PicRealRes Then '
    
   MPGCaptureBasicVideo PicSS1Big
   If MPGCaptured = False Then SavePic1Flag = False: GoTo ex
   PicSS1Big.Width = ScaleX(objVideo.SourceWidth, vbPixels, vbTwips)
   PicSS1Big.Height = ScaleY(objVideo.SourceHeight, vbPixels, vbTwips)
   PicSS1Big.PaintPicture PicSS1Big.Picture, 0, 0, PicSS1Big.ScaleWidth, PicSS1Big.ScaleHeight
   PicSS1Big.Picture = PicSS1Big.Image
   PicSS1.Cls
   PicSS1.PaintPicture PicSS1Big.Picture, 0, 0, PicSS1.ScaleWidth, PicSS1.ScaleHeight
   PicSS1.Picture = PicSS1.Image
   
 Else ' 
    MPGCaptureBasicVideo PicSS1Big
    If MPGCaptured = False Then SavePic1Flag = False: GoTo ex
    PicSS1Big.Width = ScaleX(objVideo.SourceWidth, vbPixels, vbTwips)
    PicSS1Big.Height = ScaleY(objVideo.SourceHeight, vbPixels, vbTwips)
    PicSS1Big.PaintPicture PicSS1Big.Picture, 0, 0, PicSS1Big.ScaleWidth, PicSS1Big.ScaleHeight
    PicSS1Big.Picture = PicSS1Big.Image
    PicSS1.Cls
    PicSS1.PaintPicture PicSS1Big.Picture, 0, 0, PicSS1.ScaleWidth, PicSS1.ScaleHeight
    PicSS1.Picture = PicSS1.Image
   
End If

''''''''''''''''''''''''''''''''''''1
Case 1
 Set PicSS2Big = Nothing
 NoPic2Flag = False
 PicSS2.Cls
 pos2 = Position.Value
 SavePic2Flag = True ' , 

 If Opt_PicRealRes Then '
    
  MPGCaptureBasicVideo PicSS2Big
  If MPGCaptured = False Then SavePic2Flag = False: GoTo ex
  PicSS2Big.Width = ScaleX(objVideo.SourceWidth, vbPixels, vbTwips)
  PicSS2Big.Height = ScaleY(objVideo.SourceHeight, vbPixels, vbTwips)
  PicSS2Big.PaintPicture PicSS2Big.Picture, 0, 0, PicSS2Big.ScaleWidth, PicSS2Big.ScaleHeight
  PicSS2Big.Picture = PicSS2Big.Image
  PicSS2.Cls
  PicSS2.PaintPicture PicSS2Big.Picture, 0, 0, PicSS2.ScaleWidth, PicSS2.ScaleHeight
  PicSS2.Picture = PicSS2.Image

 Else ' 

    MPGCaptureBasicVideo PicSS2Big
    If MPGCaptured = False Then SavePic2Flag = False: GoTo ex
    PicSS2Big.Width = ScaleX(objVideo.SourceWidth, vbPixels, vbTwips)
    PicSS2Big.Height = ScaleY(objVideo.SourceHeight, vbPixels, vbTwips)
    PicSS2Big.PaintPicture PicSS2Big.Picture, 0, 0, PicSS2Big.ScaleWidth, PicSS2Big.ScaleHeight
    PicSS2Big.Picture = PicSS2Big.Image
    PicSS2.Cls
    PicSS2.PaintPicture PicSS2Big.Picture, 0, 0, PicSS2.ScaleWidth, PicSS2.ScaleHeight
    PicSS2.Picture = PicSS2.Image

End If

''''''''''''''''''''''''''''''''''''2
Case 2
 Set PicSS3Big = Nothing
 NoPic3Flag = False
 PicSS3.Cls
 pos3 = Position.Value
 SavePic3Flag = True ' , 

 If Opt_PicRealRes Then '
    
   MPGCaptureBasicVideo PicSS3Big
   If MPGCaptured = False Then SavePic3Flag = False: GoTo ex
   PicSS3Big.Width = ScaleX(objVideo.SourceWidth, vbPixels, vbTwips)
   PicSS3Big.Height = ScaleY(objVideo.SourceHeight, vbPixels, vbTwips)
   PicSS3Big.PaintPicture PicSS3Big.Picture, 0, 0, PicSS3Big.ScaleWidth, PicSS3Big.ScaleHeight
   PicSS3Big.Picture = PicSS3Big.Image
   PicSS3.Cls
   PicSS3.PaintPicture PicSS3Big.Picture, 0, 0, PicSS3.ScaleWidth, PicSS3.ScaleHeight
   PicSS3.Picture = PicSS3.Image

 Else

   MPGCaptureBasicVideo PicSS3Big
   If MPGCaptured = False Then SavePic3Flag = False: GoTo ex
   PicSS3Big.Width = ScaleX(objVideo.SourceWidth, vbPixels, vbTwips)
   PicSS3Big.Height = ScaleY(objVideo.SourceHeight, vbPixels, vbTwips)
   PicSS3Big.PaintPicture PicSS3Big.Picture, 0, 0, PicSS3Big.ScaleWidth, PicSS3Big.ScaleHeight
   PicSS3Big.Picture = PicSS3Big.Image
   PicSS3.Cls
   PicSS3.PaintPicture PicSS3Big.Picture, 0, 0, PicSS3.ScaleWidth, PicSS3.ScaleHeight
   PicSS3.Picture = PicSS3.Image
 End If

End Select

ex:
If err.Number <> 0 Then Debug.Print err.Description

If Not frmAutoFlag Then Me.SetFocus
Screen.MousePointer = vbNormal

End Sub

Private Sub ComCap_DSh_A(Index As Integer)
'c 
On Error GoTo ex

Screen.MousePointer = vbHourglass

Mark2Save

ToDebug "PixelRatio_DS_A = " & PixelRatio
ToDebug "Cap_DSh_A: " & Round(objVideo.SourceWidth * PixelRatio, 0) & "x" & objVideo.SourceHeight

Select Case Index
    ''''''''''''''''''''''''''''''''''''0
Case 0
    Set PicSS1Big = Nothing
    NoPic1Flag = False
    PicSS1.Cls
    pos1 = Position.Value    'objPosition.CurrentPosition * 100
    SavePic1Flag = True    ' , 

    If Opt_PicRealRes Then    '

        MPGCaptureBasicVideo PicSS1Big
        If MPGCaptured = False Then SavePic1Flag = False: GoTo ex

        ResizeWIA PicSS1Big, _
                  objVideo.SourceWidth * PixelRatio, _
                  objVideo.SourceHeight

        PicSS1.Cls
        PicSS1.Height = PixelRatioSS
        PicSS1.PaintPicture PicSS1Big.Picture, 0, 0, PicSS1.ScaleWidth, PicSS1.ScaleHeight
        PicSS1.Picture = PicSS1.Image

    Else    ' 
        MPGCaptureBasicVideo PicSS1Big
        If MPGCaptured = False Then SavePic1Flag = False: GoTo ex

        ResizeWIA PicSS1Big, _
                  objVideo.SourceWidth * PixelRatio, _
                  objVideo.SourceHeight

        PicSS1.Cls
        PicSS1.Height = PixelRatioSS
        PicSS1.PaintPicture PicSS1Big.Picture, 0, 0, PicSS1.ScaleWidth, PicSS1.ScaleHeight
        PicSS1.Picture = PicSS1.Image

    End If

    ''''''''''''''''''''''''''''''''''''1
Case 1
    Set PicSS2Big = Nothing
    NoPic2Flag = False
    PicSS2.Cls
    pos2 = Position.Value
    SavePic2Flag = True    ' , 

    If Opt_PicRealRes Then    '

        MPGCaptureBasicVideo PicSS2Big
        If MPGCaptured = False Then SavePic2Flag = False: GoTo ex

        ResizeWIA PicSS2Big, _
                  objVideo.SourceWidth * PixelRatio, _
                  objVideo.SourceHeight

        PicSS2.Cls
        PicSS2.Height = PixelRatioSS
        PicSS2.PaintPicture PicSS2Big.Picture, 0, 0, PicSS2.ScaleWidth, PicSS2.ScaleHeight
        PicSS2.Picture = PicSS2.Image

    Else    ' 

        MPGCaptureBasicVideo PicSS2Big
        If MPGCaptured = False Then SavePic2Flag = False: GoTo ex

        ResizeWIA PicSS2Big, _
                  objVideo.SourceWidth * PixelRatio, _
                  objVideo.SourceHeight

        PicSS2.Cls
        PicSS2.Height = PixelRatioSS
        PicSS2.PaintPicture PicSS2Big.Picture, 0, 0, PicSS2.ScaleWidth, PicSS2.ScaleHeight
        PicSS2.Picture = PicSS2.Image

    End If

    ''''''''''''''''''''''''''''''''''''2
Case 2
    Set PicSS3Big = Nothing
    NoPic3Flag = False
    PicSS3.Cls
    pos3 = Position.Value
    SavePic3Flag = True    ' , 

    If Opt_PicRealRes Then    '

        MPGCaptureBasicVideo PicSS3Big
        If MPGCaptured = False Then SavePic3Flag = False: GoTo ex

        ResizeWIA PicSS3Big, _
                  objVideo.SourceWidth * PixelRatio, _
                  objVideo.SourceHeight

        PicSS3.Cls
        PicSS3.Height = PixelRatioSS
        PicSS3.PaintPicture PicSS3Big.Picture, 0, 0, PicSS3.ScaleWidth, PicSS3.ScaleHeight
        PicSS3.Picture = PicSS3.Image

    Else

        MPGCaptureBasicVideo PicSS3Big
        If MPGCaptured = False Then SavePic3Flag = False: GoTo ex

        ResizeWIA PicSS3Big, _
                  objVideo.SourceWidth * PixelRatio, _
                  objVideo.SourceHeight

        PicSS3.Cls
        PicSS3.Height = PixelRatioSS
        PicSS3.PaintPicture PicSS3Big.Picture, 0, 0, PicSS3.ScaleWidth, PicSS3.ScaleHeight
        PicSS3.Picture = PicSS3.Image
    End If

End Select

ex:
If err.Number <> 0 Then Debug.Print err.Description

If Not frmAutoFlag Then Me.SetFocus
Screen.MousePointer = vbNormal

End Sub



Private Sub ComCap_Click(Index As Integer)

If isAVIflag Then

    ComCap_AVI Index
    Exit Sub

ElseIf isMPGflag Or isDShflag Then

    If Opt_UseAspect Then    ' 
        ComCap_DSh_A Index
    Else                     '  
        ComCap_DSh Index
    End If
    Exit Sub

Else
    '  ,     
    Dim tmp As String
    tmp = pLoadDialog
    ToDebug "Open for capture"
    If Len(tmp) <> 0 Then OpenMovieForCapture (tmp)
End If

End Sub

Private Sub ComDel_Click()
'If BaseReadOnly Then myMsgBox msgsvc(24), vbInformation, , Me.hwnd: LastVMI = 3: VerticalMenu_MenuItemClick 1, 1: Exit Sub
'If BaseReadOnlyU Then myMsgBox msgsvc(22), vbInformation, , Me.hwnd: LastVMI = 3: VerticalMenu_MenuItemClick 1, 1: Exit Sub
'Dim tmpL As Long
Dim okk As Integer
Dim ComDelEnabled As Boolean
Dim itmX As MSComctlLib.ListItem
Dim i As Long
Dim temp As Long

okk = myMsgBox(msgsvc(15), vbOKCancel, , Me.hWnd)
If okk = 2 Then Exit Sub

ComDel.Enabled = False: ComDelEnabled = True    '    
ToDebug "DelKey=" & rs("Key")
ClearVideo

If rs.RecordCount > 0 Then

    '?   LV    
    For Each itmX In ListView.ListItems
        If Val(itmX.Key) = rs("Key") Then ListView.ListItems.Remove itmX.Index: Exit For
    Next
    '?   -  
    'For Each itmX In ListView.ListItems
    '    If Val(itmX.Key) = rs("Key") Then itmX.Key = "": Exit For
    'Next

    '     LV ?   ...
    ListView.Sorted = False
    For i = 1 To ListView.ListItems.Count
        ListView.ListItems(i).SubItems(lvIndexPole) = i - 1
    Next i
    '   -  
    If LVSortColl > 0 Then LVSOrt (LVSortColl)
    If LVSortColl = -1 Then SortByCheck 0


    rs.Delete    '  

    'InitFlag = True    ' 
    'delFlag = True
    If rs.RecordCount < 1 Then
        ComDelEnabled = False: VerticalMenu.SetFocus
        'VerticalMenu_MenuItemClick 3, 0 ' 
        NoListClear
        VerticalMenu_MenuItemClick 1, 0
        'rs.AddNew
        Exit Sub
    End If


Else    'rs.RecordCount <= 0
    Exit Sub
End If

'     .
rs.MoveNext
If rs.EOF Then
    rs.MovePrevious
    If rs.BOF Then
        ComDelEnabled = False: VerticalMenu.SetFocus
        '        delFlag = True
    End If
End If
'If rs.RecordCount < 1 Then ComDelEnabled = False: VerticalMenu.SetFocus

If rs.EditMode Then
    editFlag = True    ' ,   
Else
    '
    ComSaveRec.BackColor = &HC0E0C0
End If

ToDebug "..."

' .
ToDebug "LoadKey=" & rs("Key")
GetEditPix

Mark2SaveFlag = False
GetFields
Mark2SaveFlag = True

'
temp = GotoLVLong(rs("Key"))
If temp > -1 Then
    Set ListView.SelectedItem = ListView.ListItems(temp)
End If

If ComDelEnabled Then ComDel.Enabled = True: ComDel.SetFocus    '

End Sub

Private Sub ComFilter_Click()
On Error Resume Next
'If Opt_LoadOnlyTitles Then
'    FrmFilter.Show 0, FrmMain
'Else
'    '  
FrmFilter.FillFilter
FrmFilter.Show 0, FrmMain
'End If
End Sub


Private Sub ComFind_Click()
If ListView.ListItems.Count < 1 Then Exit Sub

Timer2.Enabled = False
ComNext.Enabled = True
'LockWindowUpdate ListView.hwnd
Dim FindText As String
'FindText = UCase$(TextFind.Text)
FindText = TextFind.Text

Screen.MousePointer = vbHourglass
ToDebug ": " & FindText
ListView.MultiSelect = False

If CombFind.ListIndex < 0 Then CombFind.ListIndex = 0

Select Case CombFind.ItemData(CombFind.ListIndex)
Case 0
    SearchLV dbMovieNameInd, FindText, vbTextCompare
Case 1
    SearchLV dbLabelInd, FindText, vbTextCompare
Case 2
    SearchLV dbDirectorInd, FindText, vbTextCompare
Case 3
    SearchLV dbActerInd, FindText, vbTextCompare
Case 4
    SearchLV dbGenreInd, FindText, vbTextCompare
Case 5
    '
    ComShowAn_Click
    SearchNextDB dbAnnotationInd, FindText, 1, True, vbTextCompare
Case 6
    SearchLV dbsnDiskInd, FindText, vbTextCompare
Case 7
    SearchLV dbFileNameInd, FindText, vbTextCompare
Case 8
    SearchLV dbDebtorInd, FindText, vbTextCompare
End Select

ListView.MultiSelect = True

Screen.MousePointer = vbNormal
If FrameView.Visible Then Timer2.Enabled = True
End Sub



Private Sub ComFrontFaceFile_Click(Index As Integer)
Dim iFile As String
Dim temp As Single
Dim TifPngFlag As Boolean

iFile = pLoadPixDialog
If LCase$(getExtFromFile(iFile)) = "png" Then TifPngFlag = True
If left$(LCase$(getExtFromFile(iFile)), 3) = "tif" Then TifPngFlag = True

If iFile <> vbNullString Then

Mark2Save
'If rs.EditMode = 0 Then rs.Edit

    On Error GoTo err ' 

    Select Case Index
    Case 0
        Set PicFrontFace = Nothing
        Set picCanvas = Nothing

        If TifPngFlag Then
            PicFrontFace.Picture = LoadPictureWIA(iFile)
        Else
            PicFrontFace.Picture = LoadPicture(iFile)
        End If

        NoPicFrontFaceFlag = False
        SaveCoverFlag = True
        DrawCoverEdit


    Case 1
        If TifPngFlag Then
            PicSS1Big.Picture = LoadPictureWIA(iFile)
        Else
            PicSS1Big.Picture = LoadPicture(iFile)
        End If

        NoPic1Flag = False
        SavePic1Flag = True    ' , 
        PicSS1.Cls
        temp = PicSS1Big.Width / ScrShotEd_W '3360
        PicSS1.Width = ScrShotEd_W '3360
        If PicSS1Big.Height / PicSS1Big.Width < 1 Then PicSS1.Height = PicSS1Big.Height / temp 'Else PicSS1.Height = ScrShotEd_W '3360

        PicSS1.PaintPicture PicSS1Big.Picture, 0, 0, PicSS1.ScaleWidth, PicSS1.ScaleHeight
        PicSS1.Picture = PicSS1.Image

    Case 2
        If TifPngFlag Then
            PicSS2Big.Picture = LoadPictureWIA(iFile)
        Else
            PicSS2Big.Picture = LoadPicture(iFile)
        End If

        NoPic2Flag = False
        SavePic2Flag = True    ' , 
        PicSS2.Cls
        temp = PicSS2Big.Width / ScrShotEd_W
        PicSS2.Width = ScrShotEd_W
        If PicSS2Big.Height / PicSS2Big.Width < 1 Then PicSS2.Height = PicSS2Big.Height / temp 'Else PicSS2.Height = ScrShotEd_W

        PicSS2.PaintPicture PicSS2Big.Picture, 0, 0, PicSS2.ScaleWidth, PicSS2.ScaleHeight
        PicSS2.Picture = PicSS2.Image

    Case 3
        If TifPngFlag Then
            PicSS3Big.Picture = LoadPictureWIA(iFile)
        Else
            PicSS3Big.Picture = LoadPicture(iFile)
        End If

        NoPic3Flag = False
        SavePic3Flag = True    ' , 
        PicSS3.Cls
        temp = PicSS3Big.Width / ScrShotEd_W
        PicSS3.Width = ScrShotEd_W
        If PicSS3Big.Height / PicSS3Big.Width < 1 Then PicSS3.Height = PicSS3Big.Height / temp 'Else PicSS3.Height = ScrShotEd_W

        PicSS3.PaintPicture PicSS3Big.Picture, 0, 0, PicSS3.ScaleWidth, PicSS3.ScaleHeight
        PicSS3.Picture = PicSS3.Image

    End Select

End If    'iFile <> vbNullString

Exit Sub
err:
'Call err.Clear
MsgBox err.Description, vbCritical

End Sub

Private Sub ComInetFind_Click()
Dim SearchString As String 'lcase
Dim i As Integer

Dim iFile As Long
Dim s As String

On Error Resume Next

If Len(ComboInfoSites.Text) = 0 Then Exit Sub    '  
SearchString = LCase$(TxtIName.Text)
If Len(SearchString) = 0 Then
    'myMsgBox msgsvc(29)
'   Exit Sub
End If

'Set ImgPrCov = Nothing

' 
iFile = FreeFile
'ComboInfoSites.Text
ToDebug ": " & ComboInfoSites

Open App.Path & "\Scripts\" & ComboInfoSites.Text For Binary As #iFile
s = Space$(LOF(iFile))
Get #iFile, , s
Close #iFile

' 
Set SC = Nothing
Set SC = CreateObject("ScriptControl")
SC.Language = "VBScript"
SC.Timeout = 35000
SC.AddCode s
'UI 
'SC.SitehWnd = TextUI.hWnd
'SC.AllowUI = True 'False
' 
SC.AddObject "SVC", objScript

ToDebug " : " & SearchString
ComInetFind.Enabled = False
lbInetMovieList.Clear

'   url = "http://www.videoguide.ru/find.asp?Search=Simple&types=film&titles="
url = SC.CodeObject.url & SearchString
'url = SC.CodeObject.url & UrlEncode(SearchString)

ComboSites.Text = url
'url = "file://" & App.Path & "\Scripts\inet_dvdempire1.htm"

'ToDebug ": " & url
PageText = OpenURLProxy(url, "txt")
' 
PageArray() = Split(PageText, vbLf)

'Egg
If frmPeopleFlag Then
    FrmPeople.List1.Visible = False
    FrmPeople.List1.Clear
    For i = LBound(PageArray) To UBound(PageArray)
        FrmPeople.List1.AddItem i & " |" & PageArray(i)
    Next i
    FrmPeople.SetListboxScrollbar FrmPeople.List1
    FrmPeople.List1.Visible = True
End If

' main
SC.Run "AnalyzePage"
If err.Number <> 0 Or SC.Error.Number <> 0 Then GoTo ErrorHandler

'  
For i = 0 To UBound(SC.CodeObject.MTitles)
    '      If err.Number <> 0 Or SC.Error.Number <> 0 Then GoTo ErrorHandler
    If Len(SC.CodeObject.MTitles(i)) <> 0 Then
        lbInetMovieList.AddItem SC.CodeObject.MTitles(i)
        lbInetMovieList.ItemData(i) = SC.CodeObject.MData(i)
    End If
Next i
SetListboxScrollbar lbInetMovieList

err.Clear

If (Len(SC.CodeObject.MTitles(0)) <> 0) Or (UBound(SC.CodeObject.MTitles) > 0) Then
    ToDebug ": " & i & " (" & err.Description & ")"
Else
    ToDebug ": " & 0
End If

FrmMain.ComInetFind.FontBold = False
ComInetFind.Enabled = True
Erase PageArray
'  Set SC = Nothing

Exit Sub
ErrorHandler:

If SC.Error.Number <> 0 Then
    MsgBox "Script Error : " & SC.Error.Number _
           & ": " & SC.Error.Description & "  " & SC.Error.Line _
           & "  " & SC.Error.Column, vbCritical

    Set SC = Nothing
Else
    If err.Number <> 0 Then
        'Select Case err.Number
        'Case 9
        '    MsgBox "Nothing found or may be script error"
        'Resume Next
        'Case Else
        MsgBox err.Description, vbCritical
        ToDebug "Err_IFind: " & err.Description
        'End Select
    End If
End If

FrmMain.ComInetFind.FontBold = False
ComInetFind.Enabled = True
End Sub

Private Sub ComKeyAvi_Click(Index As Integer)
Select Case Index
Case 0
KeyNext
Case 1
KeyPrev
End Select

End Sub
Private Sub KeyNext()
lastRendedAVI = m_cAVI.AVIStreamNearestNextKeyFrame(lastRendedAVI)
Position.Value = lastRendedAVI
PosScroll
End Sub
Private Sub KeyPrev()
lastRendedAVI = m_cAVI.AVIStreamNearestPrevKeyFrame(lastRendedAVI)
'pRenderFrame lastRendedAVI
Position.Value = lastRendedAVI
PosScroll
End Sub





Private Sub ComNext_Click()
If ListView.ListItems.Count < 1 Then Exit Sub

Dim FindText As String

Timer2.Enabled = False

Screen.MousePointer = vbHourglass

'LockWindowUpdate ListView.hwnd
'FindText = UCase$(TextFind.Text)
FindText = TextFind.Text

'ToDebug " : " & FindText
If ChMarkFindHid Then: Else ListView.MultiSelect = False

If CombFind.ListIndex < 0 Then CombFind.ListIndex = 0

Select Case CombFind.ItemData(CombFind.ListIndex)
Case 0
    FindNextLV 0, FindText
Case 1
    FindNextLV dbLabelInd, FindText
Case 2
    FindNextLV dbDirectorInd, FindText
Case 3
    FindNextLV dbActerInd, FindText
Case 4
    FindNextLV dbGenreInd, FindText
Case 5
    ComShowAn_Click
    SearchNextDB dbAnnotationInd, FindText, ListView.SelectedItem.Index, False, vbTextCompare
Case 6
    FindNextLV dbsnDiskInd, FindText

Case 7
    FindNextLV dbFileNameInd, FindText

Case 8
    FindNextLV dbDebtorInd, FindText

End Select

ListView.MultiSelect = True
'LvClick
If FrameView.Visible Then Timer2.Enabled = True
'LockWindowUpdate 0
Screen.MousePointer = vbNormal

End Sub


Private Sub ComFrontFace_Click(Index As Integer)
'  
Dim temp As Single

If Clipboard.GetFormat(vbCFDIB) Then

    Mark2Save
    'If rs.EditMode = 0 Then rs.Edit

    Select Case Index

    Case 0
        Set PicFrontFace = Nothing
        Set picCanvas = Nothing

        NoPicFrontFaceFlag = False
        PicFrontFace.Picture = Clipboard.GetData
        SaveCoverFlag = True
        DrawCoverEdit

    Case 1
        PicSS1Big.Picture = Clipboard.GetData
        'Debug.Print "1b", "h:" & PicSS1Big.Height, "sh:" & PicSS1Big.ScaleHeight
        NoPic1Flag = False
        SavePic1Flag = True    ' , 
        PicSS1.Cls
        temp = PicSS1Big.Width / ScrShotEd_W    '3360
        PicSS1.Width = ScrShotEd_W    '3360
        If PicSS1Big.Height / PicSS1Big.Width < 1 Then PicSS1.Height = PicSS1Big.Height / temp Else PicSS1.Height = ScrShotEd_W    '3360
        PicSS1.PaintPicture PicSS1Big.Picture, 0, 0, PicSS1.ScaleWidth, PicSS1.ScaleHeight
        PicSS1.Picture = PicSS1.Image

    Case 2
        PicSS2Big.Picture = Clipboard.GetData
        NoPic2Flag = False
        SavePic2Flag = True    ' , 
        PicSS2.Cls
        temp = PicSS2Big.Width / ScrShotEd_W
        PicSS2.Width = ScrShotEd_W
        If PicSS2Big.Height / PicSS2Big.Width < 1 Then PicSS2.Height = PicSS2Big.Height / temp Else PicSS2.Height = ScrShotEd_W
        PicSS2.PaintPicture PicSS2Big.Picture, 0, 0, PicSS2.ScaleWidth, PicSS2.ScaleHeight
        PicSS2.Picture = PicSS2.Image

    Case 3
        PicSS3Big.Picture = Clipboard.GetData
        NoPic3Flag = False
        SavePic3Flag = True    ' , 
        PicSS3.Cls
        temp = PicSS3Big.Width / ScrShotEd_W
        PicSS3.Width = ScrShotEd_W
        If PicSS3Big.Height / PicSS3Big.Width < 1 Then PicSS3.Height = PicSS3Big.Height / temp Else PicSS3.Height = ScrShotEd_W
        PicSS3.PaintPicture PicSS3Big.Picture, 0, 0, PicSS3.ScaleWidth, PicSS3.ScaleHeight
        PicSS3.Picture = PicSS3.Image
    End Select

End If    'Clipboard.GetFormat(vbCFDIB)
End Sub


Public Sub LangChange()
Dim Contrl As Control
Dim i As Integer
'Dim temp As String
Dim tmp As String
Dim iPos As Integer

On Error GoTo err

If Not FileExists(lngFileName) Then
    'If Dir(lngFileName, vbNormal Or vbReadOnly Or vbHidden Or vbSystem Or vbArchive) = vbNullString Or Len(lngFileName) = 0 Then
    ' ,  
    lngFileName = App.Path & "\rus.lng"
    If FileExists(lngFileName) Then
        ' 
    Else
        '  
        Call myMsgBox("   !  ." & vbCrLf & "Reinstall application! Language file not found: " & vbCrLf & lngFileName, vbCritical, , Me.hWnd)
        lngFileName = vbNullString
    End If
End If

If Not FileExists(userFile) Then
'  user.lng
    MakeUserFile userFile
End If

If Len(lngFileName) <> 0 Then
    ' 
    If LastLangFile = lngFileName Then Exit Sub
Else
    Exit Sub
End If

Screen.MousePointer = vbHourglass

ToDebug " " & lngFileName

LockWindowUpdate Me.hWnd

For Each Contrl In FrmMain.Controls
    'If (TypeOf Contrl Is ComboBox _
     Or TypeOf Contrl Is ListView _
     Or TypeOf Contrl Is Label _
     Or TypeOf Contrl Is Frame _
     Or TypeOf Contrl Is Slider _
     Or TypeOf Contrl Is CommandButton _
     Or TypeOf Contrl Is PictureBox _
     Or TypeOf Contrl Is Image _
     Or TypeOf Contrl Is VerticalMenu _
     ) Then
    'msgbox
    'popup menu
    'checkbox

    If right$(Contrl.name, 3) <> "Hid" Then

        If Contrl.name = "VerticalMenu" Then        '                      VerticalMenu
            VerticalMenu.Controls("LVMB")(0) = ReadLang(Contrl.name & ".MenuItemCaption" & 1, VerticalMenu.Controls("LVMB")(0).Caption)
            VerticalMenu.Controls("LVMB")(1) = ReadLang(Contrl.name & ".MenuItemCaption" & 2, VerticalMenu.Controls("LVMB")(1).Caption)
            VerticalMenu.Controls("LVMB")(2) = ReadLang(Contrl.name & ".MenuItemCaption" & 3, VerticalMenu.Controls("LVMB")(2).Caption)
            VerticalMenu.Controls("LVMB")(3) = ReadLang(Contrl.name & ".MenuItemCaption" & 4, VerticalMenu.Controls("LVMB")(3).Caption)
            VerticalMenu.Controls("LVMB")(4) = ReadLang(Contrl.name & ".MenuItemCaption" & 5, VerticalMenu.Controls("LVMB")(4).Caption)
            VerticalMenu.Controls("LVMB")(5) = ReadLang(Contrl.name & ".MenuItemCaption" & 6, VerticalMenu.Controls("LVMB")(5).Caption)
            VerticalMenu.Controls("LVMB")(6) = ReadLang(Contrl.name & ".MenuItemCaption" & 7, VerticalMenu.Controls("LVMB")(6).Caption)
            VerticalMenu.Controls("LVMB")(7) = ReadLang(Contrl.name & ".MenuItemCaption" & 8, VerticalMenu.Controls("LVMB")(7).Caption)
        End If        'Contrl Is VerticalMenu

        If TypeOf Contrl Is Label Then        '                           Label
            If Contrl.name = "LTech" Then
                LTech(Contrl.Index).Caption = ReadLang("LTech(" & Contrl.Index & ").Caption", LTech(Contrl.Index).Caption)
            Else
                Contrl.Caption = ReadLang(Contrl.name & ".Caption", Contrl.Caption)
            End If
        End If

        If TypeOf Contrl Is Frame Then        '                           Frame
            Contrl.Caption = ReadLang(Contrl.name & ".Caption", Contrl.Caption)
        End If

        AddEditCapt = FrameAddEdit.Caption


        If TypeOf Contrl Is MyFrame Then        '                           MyFrame
            Contrl.Caption = ReadLang(Contrl.name & ".Caption", Contrl.Caption)
        End If

        If TypeOf Contrl Is ListView Then        '                        ListView
            If Contrl.name = "ListView" Then
                For i = 1 To ListView.ColumnHeaders.Count
                    Contrl.ColumnHeaders(i).Text = ReadLang(Contrl.name & ".CH" & i, Contrl.ColumnHeaders(i).Text)
                Next i
            End If
            If Contrl.name = "tvGroup" Then Contrl.ColumnHeaders(1).Text = ReadLang(Contrl.name & ".CH1", Contrl.ColumnHeaders(1).Text)
        End If

        If TypeOf Contrl Is CommandButton Then        '                   CommandButton
            Contrl.Caption = ReadLang(Contrl.name & ".Caption", Contrl.Caption)
            ' Contrl.ToolTipText = ReadLang(Contrl.name & ".ToolTip", Contrl.ToolTipText)
        End If


        If TypeOf Contrl Is XpB Then        '                               XPB
            Contrl.Caption = ReadLang(Contrl.name & ".Caption", Contrl.Caption)
            ' Contrl.ToolTipText = ReadLang(Contrl.name & ".ToolTip", Contrl.ToolTipText)
            Contrl.pInitialize
        End If


        If TypeOf Contrl Is ComboBox Then             'Combo

            If Contrl.name = "CombFind" Then
                CombFind.Clear
                For i = 0 To 8
                    CombFind.AddItem (ReadLang("CombFind.Item" & i))
                    CombFind.ItemData(i) = i
                Next i
            End If
            
        End If

        'If TypeOf Contrl Is OptionButton Then '                     OptionButton
        'For i = OptHtml.LBound To OptHtml.UBound
        'OptHtml(i).Caption = ReadLang(Contrl.name & i & ".Caption")
        'Next
        'End If

        If TypeOf Contrl Is Menu Then        '                                     Menu
            Contrl.Caption = ReadLang(Contrl.name & ".Caption", Contrl.Caption)
            'Debug.Print Contrl.name, Contrl.Caption
            
            On Error Resume Next
            '   ,   
            tmp = Contrl.Caption: iPos = InStr(tmp, vbTab)
            If iPos > 0 Then tmp = left$(tmp, iPos - 1)

Select Case Contrl.name
Case "mnuCoverSave", "mnuMovieSaveFrame", "mnuSaveFace", "mnuSaveFoto", "mnuSavePic"
            cIM.IconIndex(tmp) = ImageList.ListImages("SAVE_ICON").Index - 1
Case "mnuCoverCopy", "mnuMovieCopyClip", "mnuCopyFace", "mnuCopyFoto", "mnuCopyPic"
            cIM.IconIndex(tmp) = ImageList.ListImages("mnuCopyLV").Index - 1
Case Else
            cIM.IconIndex(tmp) = ImageList.ListImages(Contrl.name).Index - 1
End Select
'            If err = 0 Then
'                Debug.Print
'            End If
            err.Clear
            On Error GoTo err
        End If


        If TypeOf Contrl Is CheckBox Then        '                         CheckBox
            Contrl.Caption = ReadLang(Contrl.name & ".Caption", Contrl.Caption)
        End If

        If TypeOf Contrl Is TabStrip Then        '                        TabStripCover
            Select Case Contrl.name
            Case "TabStripCover"
                Contrl.Tabs(1).Caption = ReadLang(Contrl.name & ".Tabs(1).Caption", Contrl.Tabs(1).Caption)
                Contrl.Tabs(2).Caption = ReadLang(Contrl.name & ".Tabs(2).Caption", Contrl.Tabs(2).Caption)
                Contrl.Tabs(3).Caption = ReadLang(Contrl.name & ".Tabs(3).Caption", Contrl.Tabs(3).Caption)
                Contrl.Tabs(4).Caption = ReadLang(Contrl.name & ".Tabs(4).Caption", Contrl.Tabs(4).Caption)
            Case "TabStrAdEd"
                Contrl.Tabs(1).Caption = ReadLang(Contrl.name & ".Tabs(1).Caption", Contrl.Tabs(1).Caption)
                Contrl.Tabs(2).Caption = ReadLang(Contrl.name & ".Tabs(2).Caption", Contrl.Tabs(2).Caption)
                Contrl.Tabs(3).Caption = ReadLang(Contrl.name & ".Tabs(3).Caption", Contrl.Tabs(3).Caption)
            End Select
        End If        '(TypeOf Contrl

    End If        '<> "Hid"
Next                                            '                               

' 
If FileExists(userFile) Then
Call FillUserCombo("Genre", ComboGenre)  '
Call FillUserCombo("Country", ComboCountry)  '
Call FillUserCombo("Language", TextLang)  '
Call FillUserCombo("Subtitle", TextSubt)  '
Call FillUserCombo("Comments", ComboOther)  '
Call FillUserCombo("Media", ComboNos)  '
Call FillUserCombo("Site", ComboSites)  '
Call FillUserCombo("Site", cBasePicURL)  '
End If

' 
ComPlusHid(0).pInitialize: ComPlusHid(1).pInitialize: ComPlusHid(2).pInitialize: ComPlusHid(3).pInitialize

'  ,   
ReDim TranslatedFieldsNames(ListView.ColumnHeaders.Count - 1)
For i = 0 To ListView.ColumnHeaders.Count - 2
    TranslatedFieldsNames(i) = ListView.ColumnHeaders(i + 1).Text
Next i
TranslatedFieldsNames(i) = LAnnot.Caption        '+ 


'                                                           NamesStore()
For i = 1 To ListView.ColumnHeaders.Count - 1        'mGroup.Count - 1 'indexpole
    mGroup(i).Caption = ListView.ColumnHeaders(i)
Next i
mGroup(0).Caption = "* " & ReadLang("NamesStore8") & " *"

For i = 0 To UBound(NamesStore)
    NamesStore(i) = ReadLang("NamesStore" & i)
Next i

'                                                           msgbox
For i = 1 To UBound(msgsvc)
    msgsvc(i) = Change2lfcr(ReadLang("msg" & i))
Next i

'                                                         UserControl LVaddon
UCLV.Controls("LAct") = LAct.Caption & ":"
UCLV.Controls("LAudio") = LTech(6).Caption & ":"        'LAudio.Caption & ":"
UCLV.Controls("LCountry") = LCountry.Caption & ":"
'UCLV.L_FPS = LFPS.Caption & ":"
UCLV.Controls("LGenre") = LGenre.Caption & ":"
UCLV.Controls("LMName") = LMName.Caption & ":"
UCLV.Controls("LNcd") = LTech(0).Caption & ":"        'LNcd.Caption & ":"
UCLV.Controls("LOther") = LOther.Caption & ":"
UCLV.Controls("LRes") = LRes.Caption & ":"
'UCLV.L_Resol = LResol.Caption & ":"
UCLV.Controls("LTime") = LTech(2).Caption & ":"        'LTime.Caption & ":"
'UCLV.Controls("LUser") = LUser.Caption & ":"
UCLV.Controls("LVideo") = LTech(3).Caption & ":"        'LVideo.Caption & ":"
'UCLV.L_Year = LYear.Caption & ":"

UCLV.Controls("LLang") = LLang.Caption & ":"
UCLV.Controls("LSubt") = LSubt.Caption & ":"
UCLV.Controls("LRate") = LRate.Caption & ":"

UCLV.Controls("LFile") = LTech(7).Caption & ":"        'LFile.Caption & ":"
UCLV.Controls("LLabel") = LLabel.Caption & ":"
UCLV.Controls("LDebtor") = LTech(11).Caption & ":"        'LUser.Caption & ":"


For Each Contrl In UCLV.Controls
    If TypeOf Contrl Is Label Then
        ' 
        Contrl.MousePointer = 99
        Contrl.MouseIcon = FrmMain.ImageList.ListImages("LArr").Picture
    End If
Next

'
'   

mnuLVCheckedCaption = mnuLVChecked.Caption
mnuLVSelectedCaption = mnuLVSelected.Caption

FrameViewCaption = FrameView.Caption
FrameView.Caption = FrameViewCaption & " " & ListView.ListItems.Count & " )"

FrameActerCaption = FrameActer.Caption
FrameActer.Caption = FrameActerCaption & LVActer.ListItems.Count & ")"


LActMarkCountCaption = LActMarkCount.Caption
ChPrintCheckedCaption = ChPrintChecked.Caption

LockWindowUpdate 0
LastLangFile = lngFileName

Screen.MousePointer = vbNormal

Exit Sub

err:
LockWindowUpdate 0
Screen.MousePointer = vbNormal
If err <> 0 Then ToDebug "Err_MainLCh:" & err.Description
End Sub


Private Function FindNextLV(ind As Integer, ftext As String) As Integer
'    
Dim itmX As MSComctlLib.ListItem
Dim itmRet As MSComctlLib.ListItem
Dim i As Long    ', j As Integer
Dim temp As String

If ListView.SelectedItem.Index = ListView.ListItems.Count Then ComNext.Enabled = False: Exit Function
If ListView.SelectedItem.Index < CurSearch Then CurSearch = ListView.SelectedItem.Index

For Each itmX In ListView.ListItems
    i = i + 1

    If ind = 0 Then
        temp = itmX.Text
    Else
        temp = itmX.SubItems(ind)
    End If

    If i > CurSearch Then
        If InStr(1, temp, ftext, vbTextCompare) <> 0 Then
            Set itmRet = itmX
            ListView.SelectedItem = ListView.ListItems.Item(i)
            If ListView.Visible Then ListView.SetFocus
            
'ListView.ListItems(i).EnsureVisible
LV_EnsureVisible ListView, i

            '    
            If ChMarkFindHid Then ListView.ListItems(i).Checked = True

            'rs.MoveFirst: rs.Move ListView.SelectedItem.SubItems(lvIndexPole)
            'RSMOVE ListView.SelectedItem.SubItems(lvIndexPole), "FindNextLV"
            RSGoto ListView.SelectedItem.Key

            If ListView.Visible Then
                LVCLICK
                Exit For
            End If
            FindNextLV = FindNextLV + 1
        End If

    End If      'i >
Next        'For Each

If i = ListView.ListItems.Count Then ComNext.Enabled = False

CurSearch = i
End Function


Private Sub ComPlay_ShiftClick(Shift As Integer)
PlayMovieFolderFlag = True
Call ComPlay_Click
' ,    PlayMovieFolderFlag = False
End Sub
Private Sub ComPlay_Click()
Dim a() As String
Dim tmp As String
Dim i As Integer

LstFiles.Visible = False
If SelCount < 1 Then Exit Sub
LstFiles.Clear
tmp = CheckNoNullVal(dbFileNameInd)
If Len(tmp) <> 0 Then ' 
    If Tokenize04(tmp, a(), "|", False) > -1 Then
        If UBound(a) > 0 Then
            For i = 0 To UBound(a)
                LstFiles.AddItem Trim$(a(i))
            Next i
                SetListboxScrollbar LstFiles
                LstFiles.ZOrder 0
                LstFiles.Visible = True
                LstFiles.SetFocus
        Else
            PlayMovie tmp
        End If
    End If
Else '
    PlayMovie vbNullString
End If

End Sub


Private Sub ComOpen_Click()
'
'If rs.EditMode = 0 Then rs.Edit
OpenNewMovie
End Sub

Private Sub ComRND_Click(Index As Integer)
Dim tmp As Long
'Dim tmpsi As Single

Mark2Save

Screen.MousePointer = vbHourglass
'                                                                AVI
If isAVIflag Then
    Select Case Index
        Case 0: AutoScrShotsN Frames, 1: SavePic1Flag = True: NoPic1Flag = False
        Case 1: AutoScrShotsN Frames, 2: SavePic2Flag = True: NoPic2Flag = False
        Case 2: AutoScrShotsN Frames, 3: SavePic3Flag = True: NoPic3Flag = False
    End Select
ToDebug "ScrShotsPos Avi: " & pos1 & " " & pos2 & " " & pos3
End If


'                                                               MPEG
If isMPGflag Or isDShflag Then
tmp = TimesX100 / 3 '4

On Error Resume Next 'objPosition.CurrentPosition

    Select Case Index
        Case 0
            pos1 = 1 + (Rnd() * tmp)
            Position.Value = pos1
            objPosition.CurrentPosition = Position.Value / 100
            Sleep 500
            ComCap_Click 0
        
        Case 1
            pos2 = tmp + (Rnd() * tmp)
            Position.Value = pos2
            objPosition.CurrentPosition = Position.Value / 100
            Sleep 500
            ComCap_Click 1

        Case 2: pos3 = tmp * 2 + (Rnd() * tmp)
            Position.Value = pos3
            objPosition.CurrentPosition = Position.Value / 100
            Sleep 500
            ComCap_Click 2
    End Select

MPGPosScroll
End If

Screen.MousePointer = vbNormal


End Sub

Public Sub ComSaveRec_Click()
Dim curKey As String

FirstLVFill = False

ToDebug "SaveClick..."
ToDebug " EditMode: " & rs.EditMode

If rs.EditMode Then
    If Not addflag Then editFlag = True    ' ,   
    'editFlag = True ' ,   
Else
    If rs.RecordCount < 1 Then Exit Sub
    rs.Edit
    editFlag = True
End If

ToDebug " AddFlag: " & addflag
ToDebug " EditFlag: " & editFlag

curKey = rs("Key") '  .      

ToDebug " SaveRecKey=" & curKey

If SavePic1Flag Then
    If NoPic1Flag Then
        rs.Fields("SnapShot1") = vbNullString
ToDebug " Pic1 - no"
    Else
        If Opt_PicRealRes Then    '
            Pic2JPG PicSS1Big, 1, "SnapShot1"
ToDebug " Pic1 - big"
        Else    '
            Pic2JPG PicSS1, 1, "SnapShot1"
ToDebug " Pic1 - small"
        End If
    End If
End If
If SavePic2Flag Then
    If NoPic2Flag Then
        rs.Fields("SnapShot2") = vbNullString
ToDebug " Pic2 - no"
    Else
        If Opt_PicRealRes Then    '
            Pic2JPG PicSS2Big, 1, "SnapShot2"
ToDebug " Pic2 - big"
        Else    '
            Pic2JPG PicSS2, 1, "SnapShot2"
ToDebug " Pic2 - small"
        End If
    End If
End If
If SavePic3Flag Then
    If NoPic3Flag Then
        rs.Fields("SnapShot3") = vbNullString
ToDebug " Pic3 - no"
    Else
        If Opt_PicRealRes Then    '
            Pic2JPG PicSS3Big, 1, "SnapShot3"
ToDebug " Pic3 - big"
        Else    '
            Pic2JPG PicSS3, 1, "SnapShot3"
ToDebug " Pic3 - small"
        End If
    End If
End If
If SaveCoverFlag Then
    If NoPicFrontFaceFlag Then
        rs.Fields("FrontFace") = vbNullString
ToDebug " Cover - no"
    Else
        Pic2JPG PicFrontFace, 1, "FrontFace"
ToDebug " Cover - yes"
    End If
End If
SavePic1Flag = False: SavePic2Flag = False: SavePic3Flag = False: SaveCoverFlag = False

'   
PutFields    '       

FrameAddEdit.Caption = AddEditCapt & " > " & TextMName.Text


If addflag Then    '

    RSGoto curKey

    ListView.Sorted = False

    ReDim Preserve lvItemLoaded(ListView.ListItems.Count + 1)    ' 1
    Add2LV ListView.ListItems.Count, ListView.ListItems.Count + 1    '2

    CurLVKey = rs("Key") & """"
    CurSearch = GotoLV(CurLVKey)
    '
    'If Not frmAutoFlag Then
    If ListView.ListItems.Count > 0 Then
        Set ListView.SelectedItem = ListView.ListItems(CurSearch)
    End If
    'End If

    addflag = False
End If

If editFlag Then
    ' Dim lvSelInd As Long

    ListView.Sorted = False
    ' lv

    CurLVKey = rs("Key") & """"
    CurSearch = GotoLV(CurLVKey)

    EditLV CurSearch

    ',     
    If Opt_LoadOnlyTitles = True Then    '  
        lvItemLoaded(CurSearch) = False
    End If

    '
    '         CurSearch
    Set ListView.SelectedItem = ListView.ListItems(CurSearch)
    'GotoLV CurLVKey

End If    'editflag


If delFlag Then
    '   
    InitFlag = True
Else
    InitFlag = False
End If


'   -  
If LVSortColl > 0 Then LVSOrt (LVSortColl)
If LVSortColl = -1 Then SortByCheck 0, True

'last DoEvents

'Set ListView.SelectedItem = ListView.ListItems(CurSearch)
If FrameView.Visible Then ListView.SelectedItem.EnsureVisible    ': LVCLICK

'On Error GoTo 0

AutoFillStore    '       

ComDel.Visible = True: ComDel.Enabled = True: ComSaveRec.BackColor = &HC0E0C0
ToDebug "..."

End Sub
Public Sub SaveAutoAdd()
Dim curKey As String

FirstLVFill = False

ToDebug "SaveAutoAdd"
'ToDebug "EditMode: " & rs.EditMode

curKey = rs("Key") '  .      

ToDebug "SaveAutKey=" & curKey

If SavePic1Flag Then
    If NoPic1Flag Then
        rs.Fields("SnapShot1") = vbNullString
ToDebug "Pic1 - no"
    Else
        If Opt_PicRealRes Then    '
            Pic2JPG PicSS1Big, 1, "SnapShot1"
ToDebug "Pic1 - big"
        Else    '
            Pic2JPG PicSS1, 1, "SnapShot1"
ToDebug "Pic1 - small"
        End If
    End If
End If
If SavePic2Flag Then
    If NoPic2Flag Then
        rs.Fields("SnapShot2") = vbNullString
ToDebug "Pic2 - no"
    Else
        If Opt_PicRealRes Then    '
            Pic2JPG PicSS2Big, 1, "SnapShot2"
ToDebug "Pic2 - big"
        Else    '
            Pic2JPG PicSS2, 1, "SnapShot2"
ToDebug "Pic2 - small"
        End If
    End If
End If
If SavePic3Flag Then
    If NoPic3Flag Then
        rs.Fields("SnapShot3") = vbNullString
ToDebug "Pic3 - no"
    Else
        If Opt_PicRealRes Then    '
            Pic2JPG PicSS3Big, 1, "SnapShot3"
ToDebug "Pic3 - big"
        Else    '
            Pic2JPG PicSS3, 1, "SnapShot3"
ToDebug "Pic3 - small"
        End If
    End If
End If
If SaveCoverFlag Then
    If NoPicFrontFaceFlag Then
        rs.Fields("FrontFace") = vbNullString
ToDebug "Cover - no"
    Else
        Pic2JPG PicFrontFace, 1, "FrontFace"
ToDebug "Cover - yes"
    End If
End If
SavePic1Flag = False: SavePic2Flag = False: SavePic3Flag = False: SaveCoverFlag = False

'   
PutFields    '       


    RSGoto curKey '  

    ListView.Sorted = False

    ReDim Preserve lvItemLoaded(ListView.ListItems.Count + 1)    ' 1
    Add2LV ListView.ListItems.Count, ListView.ListItems.Count + 1    '2

    CurLVKey = rs("Key") & """"
    
    CurSearch = GotoLV(CurLVKey)
    '  
    If ListView.ListItems.Count > 0 Then
        Set ListView.SelectedItem = ListView.ListItems(CurSearch)
    End If


'   -         -    
'If LVSortColl > 0 Then LVSOrt (LVSortColl)
'If LVSortColl = -1 Then SortByCheck 0, True

If FrameView.Visible Then ListView.SelectedItem.EnsureVisible    ': LVCLICK

ToDebug "...saved"
End Sub







Private Sub ComSelMovIcon_Click()
'     
Dim j As Integer, i As Integer
Dim tmpd As String, tmpa As String, tmp As String

If rs Is Nothing Then Exit Sub
If ListBActHid.ListCount < 0 Then Exit Sub

tmpd = "Director Like "
tmpa = "Acter Like "
For j = 0 To ListBActHid.ListCount - 1
  If ListBActHid.Selected(j) Then
  i = i + 1
  tmp = ListBActHid.List(j)
  SQLCompatible tmp
    If i = ListBActHid.SelCount Then  '
       tmpd = tmpd & "'*" & tmp & "*'"
      tmpa = tmpa & "'*" & tmp & "*'"
    Else
      tmpd = tmpd & "'*" & tmp & "*' And Director Like "
    tmpa = tmpa & "'*" & tmp & "*' And Acter Like "
    End If
  End If    'selected
 Next j

'Debug.Print "((" & tmpd & ") Or (" & tmpa & "))"
'Debug.Print
Call FilterMovieWithPers("(" & tmpd & ") Or (" & tmpa & ")")

'  FilterMovieWithPers
'clearLVIcon
'
'Dim itmX As MSComctlLib.ListItem
'Dim i As Long, j As Integer
'Dim temp As String
'Dim MarkSelect As Boolean
'
'InitFlag = False
'
'If rs Is Nothing Then
'    ' 
'Debug.Print "Test: rs = nothing, ComSelMovIcon_Click"
'    If LstBases_ListIndex = -1 Then
'        TabLVHid.Tabs(1).Selected = True
'    Else
'        TabLVHid.Tabs(LstBases_ListIndex + 1).Selected = True
'    End If
'End If
'
'i = 0: mcount = 0
'
''Dim itmX As MSComctlLib.ListItem
'For Each itmX In ListView.ListItems
'    i = i + 1
'    temp = itmX.SubItems(dbDirectorInd) + " " + itmX.SubItems(dbActerInd)     '    
'
'    MarkSelect = True
'    If ListBActHid.ListCount < 0 Then Set itmX = Nothing: Exit Sub
'
'    For j = 0 To ListBActHid.ListCount - 1
'        If ListBActHid.Selected(j) Then
'            If InStr(1, temp, ListBActHid.List(j), vbTextCompare) = 0 Then MarkSelect = False
'        End If    'selected
'    Next j
'
'    If MarkSelect Then
'        ListView.ListItems(i).SmallIcon = 1
'        ListView.ListItems(i).Checked = True
'
'        mcount = mcount + 1
'    End If    'MarkSelect
'
'    LActMarkCount.Caption = LActMarkCountCaption + " " + str$(mcount)
'Next        'For Each
'
'Set itmX = Nothing
End Sub

Public Sub ComShowAn_Click()
ComShowFa.Visible = True
ComShowAn.Visible = False

TextVAnnot.Visible = True

If Not Opt_NoSlideShow Then picScrollBoxV.Visible = False
End Sub

Private Sub ComShowBin_Click()

FrmBin.Show
'FrmMainState = FrmMain.WindowState
'FrmMain.WindowState = vbMinimized

End Sub

Public Sub ComShowFa_Click()

'If Not MultiSel Then

Set PicFaceV = Nothing

'If picScrollBoxV.Visible Then
GetPic PicFaceV, 1, "FrontFace" '22

If NoPicFrontFaceFlag Then
PicFaceV.Width = 0: PicFaceV.Height = 0 '  exit: picScrollBoxV_Resize
''GetPic Image0, 1, "SnapShot1" '19
If Not Opt_NoSlideShow Then Timer2.Enabled = True
'Exit Sub
End If

picScrollBoxV_Resize

ComShowAn.Visible = True: ComShowFa.Visible = False
If FrameView.Visible Then ComShowAn.SetFocus

If Not Opt_NoSlideShow Then picScrollBoxV.Visible = True: TextVAnnot.Visible = False

'End If 'multisel
End Sub


Private Sub ComX_Click(Index As Integer)

Select Case Index
 Case 0
  If PicSS1.Picture = 0 Then Exit Sub
 Case 1
  If PicSS2.Picture = 0 Then Exit Sub
 Case 2
  If PicSS3.Picture = 0 Then Exit Sub
 Case 3, 4
  If PicFrontFace.Picture = 0 Then Exit Sub
End Select

If myMsgBox(msgsvc(4), vbOKCancel, , Me.hWnd) = vbCancel Then Exit Sub '?

Mark2Save

Select Case Index

Case 0
Set PicSS1 = Nothing: Set PicSS1Big = Nothing: NoPic1Flag = True
SavePic1Flag = True

Case 1
Set PicSS2 = Nothing: Set PicSS2Big = Nothing: NoPic2Flag = True
SavePic2Flag = True

Case 2
Set PicSS3 = Nothing: Set PicSS3Big = Nothing: NoPic3Flag = True
SavePic3Flag = True

Case 3, 4
Set PicFrontFace = Nothing: NoPicFrontFaceFlag = True
Set picCanvas = Nothing
Set ImgPrCov = Nothing
SaveCoverFlag = True

End Select


End Sub



Private Sub ComX_MouseDown(Index As Integer, Button As Integer, Shift As Integer, x As Single, y As Single)
ComX(Index).BackColor = &HC0C0FF
End Sub

Private Sub ComX_MouseUp(Index As Integer, Button As Integer, Shift As Integer, x As Single, y As Single)
ComX(Index).BackColor = &HFFFFFF
End Sub

Private Sub Form_Activate()
On Error Resume Next
If FirstActivateFlag Then
If Opt_NoSlideShow Then picScrollBoxV_Resize
Timer2_Timer
End If

FirstActivateFlag = False
End Sub

Public Sub ReadINI(iFn As String)
Dim WFD As WIN32_FIND_DATA
Dim ret As Long
Dim temp As String
Dim i As Integer, tmpi As Integer    'mzt , j As Integer
Dim glob As String

On Error GoTo err

glob = "global"
INIFILE = iFn & ".ini"
ToDebug " " & INIFILE
'check ini
iniFileName = App.Path
If right$(iniFileName, 1) <> "\" Then iniFileName = iniFileName & "\"
iniFileName = iniFileName & INIFILE
ret = FindFirstFile(iniFileName, WFD)

If iFn = glob Then
    'GlobalFileFlagRW = True
    If ret < 0 Then
        If MakeINI(INIFILE) Then GlobalFileFlagRW = True
    Else
        '  
        If WFD.dwFileAttributes And FILE_ATTRIBUTE_READONLY Then
            GlobalFileFlagRW = False
        Else
            GlobalFileFlagRW = True
        End If
        If Not GlobalFileFlagRW Then ToDebug "ROnlyINI: " & iniFileName
    End If
Else
    'INIFileFlagRW = True
    If ret < 0 Then
        '    ,   
        If MakeINI(INIFILE) Then INIFileFlagRW = True
        ReadINI GetNameFromPathAndName(bdname): Exit Sub
    Else
        '  
        If WFD.dwFileAttributes And FILE_ATTRIBUTE_READONLY Then
            INIFileFlagRW = False
        Else
            INIFileFlagRW = True
        End If
        If Not INIFileFlagRW Then ToDebug "Read only INI: " & iniFileName
    End If
End If
FindClose ret


With ListView

    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    'vert
    temp = VBGetPrivateProfileString("FONT", "VFontName", iniFileName)
    If LenB(temp) = 0 Then
        FontVert.name = "Arial"
    Else
        FontVert.name = temp
    End If
    temp = VBGetPrivateProfileString("FONT", "VFontSize", iniFileName)
    If Not IsNumeric(temp) Then
        FontVert.Size = 12
    Else
        FontVert.Size = CDbl(Replace2Regional(temp))
    End If
    temp = VBGetPrivateProfileString("FONT", "VFontBold", iniFileName)
    FontVert.Bold = False
    If StrComp(temp, "true", vbTextCompare) = 0 Then FontVert.Bold = True
    temp = VBGetPrivateProfileString("FONT", "VFontItalic", iniFileName)
    FontVert.Italic = False
    If StrComp(temp, "true", vbTextCompare) = 0 Then FontVert.Italic = True
    temp = VBGetPrivateProfileString("FONT", "VFontColor", iniFileName)
    If Not IsNumeric(temp) Then
        VFontColor = 0
    Else
        VFontColor = Val(temp)
    End If

    'hor cover font
    temp = VBGetPrivateProfileString("FONT", "HFontName", iniFileName)
    If LenB(temp) = 0 Then
        FontHor.name = "MS Sans Serif"
    Else
        FontHor.name = temp
    End If
    temp = VBGetPrivateProfileString("FONT", "HFontSize", iniFileName)
    If Not IsNumeric(temp) Then
        FontHor.Size = CDbl(Replace2Regional("9.75"))
    Else
        FontHor.Size = CDbl(Replace2Regional(temp))
    End If
    temp = VBGetPrivateProfileString("FONT", "HFontBold", iniFileName)
    FontHor.Bold = False
    If StrComp(temp, "true", vbTextCompare) = 0 Then FontHor.Bold = True
    temp = VBGetPrivateProfileString("FONT", "HFontItalic", iniFileName)
    FontHor.Italic = False
    If StrComp(temp, "true", vbTextCompare) = 0 Then FontHor.Italic = True
    temp = VBGetPrivateProfileString("FONT", "HFontColor", iniFileName)
    If Not IsNumeric(temp) Then
        HFontColor = 0
    Else
        HFontColor = Int(CDbl(temp))
    End If

    'LV font
    temp = VBGetPrivateProfileString("FONT", "LVFontName", iniFileName)
    If LenB(temp) = 0 Then
        FontListView.name = "MS Sans Serif"
    Else
        FontListView.name = temp
    End If
    temp = VBGetPrivateProfileString("FONT", "LVFontSize", iniFileName)
    If Not IsNumeric(temp) Then
        FontListView.Size = CDbl(Replace2Regional("9.75"))
    Else
        FontListView.Size = CDbl(Replace2Regional(temp))    '  val
    End If
    temp = VBGetPrivateProfileString("FONT", "LVFontBold", iniFileName)
    FontListView.Bold = False
    If StrComp(temp, "true", vbTextCompare) = 0 Then FontListView.Bold = True
    temp = VBGetPrivateProfileString("FONT", "LVFontItalic", iniFileName)
    FontListView.Italic = False
    If StrComp(temp, "true", vbTextCompare) = 0 Then FontListView.Italic = True
    temp = VBGetPrivateProfileString("FONT", "LVFontColor", iniFileName)
    If Not IsNumeric(temp) Then
        LVFontColor = 0
    Else
        LVFontColor = CDbl(temp)
    End If


    'lv backcolor
    temp = VBGetPrivateProfileString("FONT", "LVBackColor", iniFileName)
    If Not IsNumeric(temp) Then
        LVBackColor = 12648447
    Else
        LVBackColor = Int(CDbl(temp))
    End If

    'CoverVertBackColor 
    temp = VBGetPrivateProfileString("FONT", "CoverVertBackColor", iniFileName)
    If Not IsNumeric(temp) Then
        CoverVertBackColor = vbWhite
    Else
        CoverVertBackColor = CDbl(temp)
    End If

    'CoverHorBackColor
    temp = VBGetPrivateProfileString("FONT", "CoverHorBackColor", iniFileName)
    If Not IsNumeric(temp) Then
        CoverHorBackColor = vbWhite
    Else
        CoverHorBackColor = temp
    End If

    temp = VBGetPrivateProfileString("FONT", "VMcolor", iniFileName)
    If Len(temp) <> 0 Then VMSameColor = CBool(temp) Else VMSameColor = False


    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

    If iFn = glob Then

        '                                                                      
        'LV
        '  
        ReloadLVHeaders lvHeaderIndexPole

        '   
        temp = VBGetPrivateProfileString("GLOBAL", "GetMediaType", iniFileName)
        If Len(temp) <> 0 Then Opt_GetMediaType = CBool(temp) Else Opt_GetMediaType = True
        '  sn  volume info
        temp = VBGetPrivateProfileString("GLOBAL", "GetVolumeInfo", iniFileName)
        If Len(temp) <> 0 Then Opt_GetVolumeInfo = CBool(temp) Else Opt_GetVolumeInfo = True

        '   cd
        temp = VBGetPrivateProfileString("GLOBAL", "CancelAutoPlay", iniFileName)
        If Len(temp) <> 0 Then Opt_QueryCancelAutoPlay = CBool(temp) Else Opt_QueryCancelAutoPlay = True

        '  AVI  DirectShow ( MPEG1/2)
        temp = VBGetPrivateProfileString("GLOBAL", "AviDirectShow", iniFileName)
        If Len(temp) <> 0 Then Opt_AviDirectShow = CBool(temp) Else Opt_AviDirectShow = False

        '      ,  .   = false
        temp = VBGetPrivateProfileString("GLOBAL", "InetGetPicUseTempFile", iniFileName)
        If Len(temp) <> 0 Then Opt_InetGetPicUseTempFile = CBool(temp) Else Opt_InetGetPicUseTempFile = False

    End If    '"global"


    If iFn <> glob Then                                             ' 

        '   
        'If Not frmOptFlag Then

        '                                                                        ListView
        '     LV '   LV
        .Visible = False
        For i = 1 To .ColumnHeaders.Count
            temp = VBGetPrivateProfileString("LIST", "P" & i, iniFileName)
            If IsNumeric(temp) Then .ColumnHeaders(i).Position = Int(Val(temp))
        Next i
'   (      ,  . ...)
        For i = 1 To .ColumnHeaders.Count
            temp = VBGetPrivateProfileString("LIST", "P" & i, iniFileName)
            If IsNumeric(temp) Then .ColumnHeaders(i).Position = Int(Val(temp))
            'Debug.Print i, .ColumnHeaders(i).Position, .ColumnHeaders(i).Text
            temp = VBGetPrivateProfileString("LIST", "C" & i, iniFileName)
            If IsNumeric(temp) Then .ColumnHeaders(i).Width = Int(Val(temp)) Else .ColumnHeaders(i).Width = 1500
        Next i
        ' .Visible = True
        '                                                                         
        temp = VBGetPrivateProfileString("GLOBAL", "SortOnStart", iniFileName)
        If Len(temp) <> 0 Then Opt_SortOnStart = CBool(temp) Else Opt_SortOnStart = False

        If Opt_SortOnStart Then
            '
            temp = VBGetPrivateProfileString("LIST", "LVSortColl", iniFileName)
            If IsNumeric(temp) Then LVSortColl = Int(Val(temp)) Else LVSortColl = 0
            temp = VBGetPrivateProfileString("LIST", "LVSortOrder", iniFileName)
            If IsNumeric(temp) Then LVSortOrder = Int(Val(temp)) Else LVSortOrder = 1

            ListView.SortOrder = LVSortOrder    'lvwAscending =0 ' lvwDescending =1
            '  -   
            '   <>
            If LVSortColl > 0 Then .ColumnHeaders(LVSortColl).Text = ChangeLVHSortMark(.ColumnHeaders(LVSortColl))
        Else
            LVSortColl = 0: ListView.SortOrder = 1
            '   -    ">"
            For i = 1 To ListView.ColumnHeaders.Count
                ListView.ColumnHeaders(i).Text = ReadLang("ListView.CH" & i)
            Next i

        End If

        .Visible = True

        '                                                                               Export
        For i = 0 To LstExport_ListCount    '- 1
            temp = VBGetPrivateProfileString("EXPORT", "L" & i, iniFileName)
            Select Case Trim$(LCase$(temp))
            Case "true", "1"
                LstExport_Arr(i) = True
            Case Else
                LstExport_Arr(i) = False
            End Select

        Next

        For i = 0 To 2    '012
            temp = VBGetPrivateProfileString("EXPORT", "OptHtml" & i & ".Caption", iniFileName)
            If StrComp(temp, "true", vbTextCompare) = 0 Then Opt_HtmlJpgName = i    'OptHtml(i).Value = True
        Next

        CurrentHtmlTemplate = VBGetPrivateProfileString("EXPORT", "Template", iniFileName)
        If Len(CurrentHtmlTemplate) = 0 Then
            temp = App.Path & "\Templates\svc_.htm"
            If FindFirstFile(temp, WFD) <> -1 Then
                CurrentHtmlTemplate = "svc_.htm"
            End If
        End If

        TxtNnOnPage_Text = VBGetPrivateProfileString("EXPORT", "NumsOnPage", iniFileName)
        If IsNumeric(TxtNnOnPage_Text) Then
            If Val(TxtNnOnPage_Text) < 1 Then TxtNnOnPage_Text = "30"
        Else
            TxtNnOnPage_Text = "30"
        End If

        ExportDelim = getExpDelim(VBGetPrivateProfileString("EXPORT", "ExportDelimiter", iniFileName))
        If Len(ExportDelim) = 0 Then ExportDelim = vbCrLf

        ComboCDHid_Text = VBGetPrivateProfileString("CD", "CDdrive", iniFileName)
        If Len(ComboCDHid_Text) = 0 Then ComboCDHid_Text = "D:\;C:\Video;C:\DVD;"

        ' 
        temp = Int(Val(VBGetPrivateProfileString("LIST", "LastItem", iniFileName)))
        If IsNumeric(temp) Then LastInd = Int(Val(temp)) Else LastInd = 1
        '  
        temp = Int(Val(VBGetPrivateProfileString("LIST", "LastItemAct", iniFileName)))
        If IsNumeric(temp) Then CurActKey = temp & """" Else CurActKey = vbNullString

        ' 
        QJPG = Int(Val(VBGetPrivateProfileString("GLOBAL", "QJPG", iniFileName)))
        If (QJPG < 1) Or (QJPG > 100) Then QJPG = 80


        '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''             

        temp = VBGetPrivateProfileString("GLOBAL", "UseAspect", iniFileName)
        If Len(temp) <> 0 Then Opt_UseAspect = CBool(temp) Else Opt_UseAspect = True

        temp = VBGetPrivateProfileString("GLOBAL", "SaveOptOnExit", iniFileName)
        If Len(temp) <> 0 Then Opt_AutoSaveOpt = CBool(temp) Else Opt_AutoSaveOpt = True

        temp = VBGetPrivateProfileString("LIST", "ColorDebt", iniFileName)
        If Len(temp) <> 0 Then Opt_Debtors_Colorize = CBool(temp) Else Opt_Debtors_Colorize = True

        'Old_Opt_UCLV_Vis = Opt_UCLV_Vis
        temp = VBGetPrivateProfileString("GLOBAL", "ListAndInfo", iniFileName)
        If Len(temp) <> 0 Then Opt_UCLV_Vis = CBool(temp) Else Opt_UCLV_Vis = False
        mnuCard.Checked = Opt_UCLV_Vis

        temp = VBGetPrivateProfileString("GLOBAL", "GroupWindow", iniFileName)
        If Len(temp) <> 0 Then Opt_Group_Vis = CBool(temp) Else Opt_Group_Vis = False
        mnuGroup.Checked = Opt_Group_Vis

        temp = VBGetPrivateProfileString("GLOBAL", "LoanAllSameLabels", iniFileName)
        If Len(temp) <> 0 Then Opt_LoanAllSameLabels = CBool(temp) Else Opt_LoanAllSameLabels = True

        'Old_Opt_NoSlideShow = Opt_NoSlideShow
        temp = VBGetPrivateProfileString("GLOBAL", "SlideShowWindow", iniFileName)
        If Len(temp) <> 0 Then Opt_NoSlideShow = CBool(temp) Else Opt_NoSlideShow = False
        If Opt_NoSlideShow Then
            FrmMain.picScrollBoxV.Visible = True: FrmMain.TextVAnnot.Visible = True
        Else
            If Me.Visible Then ComShowAn_Click    ' 
        End If

        '       
        temp = VBGetPrivateProfileString("COVER", "ShowColNames", iniFileName)
        If Len(temp) <> 0 Then Opt_ShowColNames = CBool(temp) Else Opt_ShowColNames = True

        ' 1:1 
        temp = VBGetPrivateProfileString("GLOBAL", "CenterShowPic", iniFileName)
        If Len(temp) <> 0 Then Opt_CenterShowPic = CBool(temp) Else Opt_CenterShowPic = False

        'grid
        temp = VBGetPrivateProfileString("LIST", "LVGrid", iniFileName)
        If Len(temp) <> 0 Then Opt_ShowLVGrid = CBool(temp) Else Opt_ShowLVGrid = False
        If Opt_ShowLVGrid Then
            ListView.GridLines = True
            tvGroup.GridLines = True
        Else
            ListView.GridLines = False
            tvGroup.GridLines = False
        End If


        '                                                                       
        temp = VBGetPrivateProfileString("LIST", "LVWidth%", iniFileName)
        If IsNumeric(temp) Then LVWidth = temp
        temp = VBGetPrivateProfileString("LIST", "TVWidth", iniFileName)    '             TV
        If IsNumeric(temp) Then
            If temp <> 0 Then
                TVWidth = temp
            Else
                TVWidth = 2800
            End If
        Else
            TVWidth = 2800
        End If
        temp = VBGetPrivateProfileString("LIST", "ScrShotWidth%", iniFileName)    ' SShots width
        If IsNumeric(temp) Then
            If temp <> 0 Then
                SplitLVD = temp
            Else
                SplitLVD = 40
            End If
        Else
            SplitLVD = 40
        End If


        '  tvGroup.ColumnHeaders(1).Width = TVWidth - tvGroup.ColumnHeaders(2).Width '

        ' ?
        temp = VBGetPrivateProfileString("GLOBAL", "LVLoadOnlyTitle", iniFileName)
        If Len(temp) <> 0 Then Opt_LoadOnlyTitles = CBool(temp) Else Opt_LoadOnlyTitles = False

        'ds filter
        temp = VBGetPrivateProfileString("GLOBAL", "FreeDVDFilters", iniFileName)
        If Len(temp) <> 0 Then Opt_UseOurMpegFilters = CBool(temp) Else Opt_UseOurMpegFilters = False

        temp = VBGetPrivateProfileString("GLOBAL", "SaveBigPix", iniFileName)
        If Len(temp) <> 0 Then Opt_PicRealRes = CBool(temp) Else Opt_PicRealRes = True



        '                                                   -
        '1000 -    (     ...)
        temp = VBGetPrivateProfileString("COVER", "txt_Stan_L", iniFileName)
        If IsNumeric(temp) Then cov_stan.l = temp Else cov_stan.l = 35.4
        If cov_stan.l > 1000 Then cov_stan.l = 35.4
        temp = VBGetPrivateProfileString("COVER", "txt_Stan_T", iniFileName)
        If IsNumeric(temp) Then cov_stan.t = temp Else cov_stan.t = 179.9
        If cov_stan.t > 1000 Then cov_stan.t = 179.9
        temp = VBGetPrivateProfileString("COVER", "txt_Stan_W", iniFileName)
        If IsNumeric(temp) Then cov_stan.w = temp Else cov_stan.w = 136.2
        If cov_stan.w > 1000 Then cov_stan.w = 136.2
        temp = VBGetPrivateProfileString("COVER", "txt_Stan_H", iniFileName)
        If IsNumeric(temp) Then cov_stan.H = temp Else cov_stan.H = 81.6
        If cov_stan.H > 1000 Then cov_stan.H = 81.6
        
        temp = VBGetPrivateProfileString("COVER", "txt_Conv_L", iniFileName)
        If IsNumeric(temp) Then cov_conv.l = temp Else cov_conv.l = 35.4
        If cov_conv.l > 1000 Then cov_conv.l = 35.4
        temp = VBGetPrivateProfileString("COVER", "txt_Conv_T", iniFileName)
        If IsNumeric(temp) Then cov_conv.t = temp Else cov_conv.t = 45.8
        If cov_conv.t > 1000 Then cov_conv.t = 45.8
        temp = VBGetPrivateProfileString("COVER", "txt_Conv_W", iniFileName)
        If IsNumeric(temp) Then cov_conv.w = temp Else cov_conv.w = 119.4
        If cov_conv.w > 1000 Then cov_conv.w = 119.4
        temp = VBGetPrivateProfileString("COVER", "txt_Conv_H", iniFileName)
        If IsNumeric(temp) Then cov_conv.H = temp Else cov_conv.H = 98
        If cov_conv.H > 1000 Then cov_conv.H = 98
        
        temp = VBGetPrivateProfileString("COVER", "txt_Dvd_L", iniFileName)
        If IsNumeric(temp) Then cov_dvd.l = temp Else cov_dvd.l = 11
        If cov_dvd.l > 1000 Then cov_dvd.l = 11
        temp = VBGetPrivateProfileString("COVER", "txt_Dvd_T", iniFileName)
        If IsNumeric(temp) Then cov_dvd.t = temp Else cov_dvd.t = 65.7
        If cov_dvd.t > 1000 Then cov_dvd.t = 65.7
        temp = VBGetPrivateProfileString("COVER", "txt_Dvd_W", iniFileName)
        If IsNumeric(temp) Then cov_dvd.w = temp Else cov_dvd.w = 128
        If cov_dvd.w > 1000 Then cov_dvd.w = 128
        temp = VBGetPrivateProfileString("COVER", "txt_Dvd_H", iniFileName)
        If IsNumeric(temp) Then cov_dvd.H = temp Else cov_dvd.H = 128.2
        If cov_dvd.H > 1000 Then cov_dvd.H = 128.2
        If cov_dvd.l + cov_dvd.w > 140 Then cov_dvd.l = 11: cov_dvd.w = 128
        If cov_dvd.t + cov_dvd.H > 195 Then cov_dvd.t = 65.7: cov_dvd.H = 128.2

        temp = VBGetPrivateProfileString("COVER", "txt_List_L", iniFileName)
        If IsNumeric(temp) Then cov_list.l = temp Else cov_list.l = 5
        If cov_list.l > 1000 Then cov_list.l = 5
        temp = VBGetPrivateProfileString("COVER", "txt_List_T", iniFileName)
        If IsNumeric(temp) Then cov_list.t = temp Else cov_list.t = 10
        If cov_list.t > 1000 Then cov_list.t = 10
        temp = VBGetPrivateProfileString("COVER", "txt_List_W", iniFileName)
        If IsNumeric(temp) Then cov_list.w = temp Else cov_list.w = 110
        If cov_list.w > 1000 Then cov_list.w = 110
        temp = VBGetPrivateProfileString("COVER", "txt_List_H", iniFileName)
        If IsNumeric(temp) Then cov_list.H = temp Else cov_list.H = 280
        If cov_list.H > 1000 Then cov_list.H = 280

        ' 
        Select Case TabStripCover.SelectedItem.Index
        Case 1
            PicCoverTextWnd.left = cov_stan.l
            PicCoverTextWnd.top = cov_stan.t
            PicCoverTextWnd.Width = cov_stan.w
            PicCoverTextWnd.Height = cov_stan.H
        Case 2
            PicCoverTextWnd.left = cov_conv.l
            PicCoverTextWnd.top = cov_conv.t
            PicCoverTextWnd.Width = cov_conv.w
            PicCoverTextWnd.Height = cov_conv.H
        Case 3
            PicCoverTextWnd.left = cov_dvd.l
            PicCoverTextWnd.top = cov_dvd.t
            PicCoverTextWnd.Width = cov_dvd.w
            PicCoverTextWnd.Height = cov_dvd.H
        Case 4
            PicCoverTextWnd.left = cov_list.l
            PicCoverTextWnd.top = cov_list.t
            PicCoverTextWnd.Width = cov_list.w
            PicCoverTextWnd.Height = cov_list.H
        End Select


        '                  Auto Add Movie                                      Auto Add Movie
        temp = VBGetPrivateProfileString("AutoAdd", "chSubFolders", iniFileName)
        If Val(temp) = 1 Then ch_chSubFolders = 1 Else ch_chSubFolders = 0
        temp = VBGetPrivateProfileString("AutoAdd", "chAvi", iniFileName)
        If Val(temp) = 1 Then ch_chAviHid = 1 Else ch_chAviHid = 0
        temp = VBGetPrivateProfileString("AutoAdd", "chDS", iniFileName)
        If Val(temp) = 1 Then ch_chDSHid = 1 Else ch_chDSHid = 0
        temp = VBGetPrivateProfileString("AutoAdd", "chShots", iniFileName)
        If Val(temp) = 1 Then ch_chShots = 1 Else ch_chShots = 0
        temp = VBGetPrivateProfileString("AutoAdd", "chNoMess", iniFileName)
        If Val(temp) = 1 Then ch_chNoMess = 1 Else ch_chNoMess = 0
        temp = VBGetPrivateProfileString("AutoAdd", "cAutoClose", iniFileName)
        If Val(temp) = 1 Then ch_cAutoClose = 1 Else ch_cAutoClose = 0
        temp = VBGetPrivateProfileString("AutoAdd", "cEjectMedia", iniFileName)
        If Val(temp) = 1 Then ch_cEjectMedia = 1 Else ch_cEjectMedia = 0


        'Select Case False
        'Case Opt_UCLV_Vis = Old_Opt_UCLV_Vis
        If Not FirstActivateFlag Then Form_Resize
        'Case Opt_NoSlideShow = Old_Opt_NoSlideShow
        'Form_Resize
        'End Select
    End If    '                                             global ----------------

    '                                                                    In Global
    If iFn = glob Then

        'get language
        temp = VBGetPrivateProfileString("Language", "LCount", iniGlobalFileName)
        If IsNumeric(temp) Then LangCount = Int(Val(temp)) Else LangCount = 2

        temp = VBGetPrivateProfileString("Language", "LastLang", iniFileName)
        If Len(temp) = 0 Then LastLanguage = "" Else LastLanguage = temp

        If LastLanguage <> vbNullString Then
            ReDim ComboLang(LangCount)
            For i = 1 To LangCount
                temp = VBGetPrivateProfileString("Language", "L" & i, iniGlobalFileName)
                ComboLang(i) = temp
                If temp = LastLanguage Then
                    lngFileName = App.Path + "\" + _
                                  VBGetPrivateProfileString("Language", "L" & i & "File", iniGlobalFileName)
                End If
            Next i
            LangChange    'change Language
        End If


        '                                                            BASES
        'temp = VBGetPrivateProfileString("GLOBAL", "LoadLastBD", iniFileName)
        'If Len(temp) <> 0 Then Opt_GoInCatalog = CBool(temp) Else Opt_GoInCatalog = True

        '   
        temp = VBGetPrivateProfileString("GLOBAL", "BDCount", iniFileName)
        If IsNumeric(temp) Then tmpi = Int(Val(temp)) Else tmpi = 1
        Erase LstBases_List: ReDim LstBases_List(tmpi)    ':  'LstBases.Clear
        For i = 1 To tmpi    ' i c 1 for BDname & i
            temp = VBGetPrivateProfileString("GLOBAL", "BDname" & i, iniFileName)
            'check and add to list
            If Len(temp) <> 0 Then
                ret = FindFirstFile(temp, WFD)
                If ret > -1 Then
                    'ReadINI GetNameFromPathAndName(temp)
                    '    
                    If Len(GetPathFromPathAndName(temp)) = 0 Then temp = App.Path & "\" & temp
                    LstBases_List(i) = temp
                Else
                    LstBases_List(i) = temp
                    ToDebug "Err_NoBase: " & temp
                    temp = vbNullString
                    
                End If
                FindClose ret
            Else '        
            
            End If
        Next i
        LstBases_ListCount = UBound(LstBases_List)
        'Debug.Print " :" & LstBases_ListCount

        'window size
        temp = VBGetPrivateProfileString("GLOBAL", "WindowWidth", iniFileName)
        If IsNumeric(temp) Then
            tmpi = Int(Val(temp))
            If tmpi > 12075 Then
                MeWidth = tmpi
            Else
                MeWidth = Me.Width
            End If
        Else
            MeWidth = 12075
        End If
        temp = VBGetPrivateProfileString("GLOBAL", "WindowHeight", iniFileName)
        If IsNumeric(temp) Then
            tmpi = Int(Val(temp))
            If tmpi > 9105 Then
                MeHeight = tmpi
            Else
                MeHeight = Me.Height
            End If
        Else
            MeHeight = 9105
        End If
        'winState
        temp = VBGetPrivateProfileString("GLOBAL", "WindowState", iniFileName)
        If IsNumeric(temp) Then
            Select Case temp
            Case vbNormal, vbMaximized
                Me.WindowState = temp
            Case 1
                Me.WindowState = vbNormal
            End Select
        End If

        'last base index
        temp = VBGetPrivateProfileString("GLOBAL", "LastBaseInd", iniFileName)
        If IsNumeric(temp) Then
            'LastBaseInd = temp
            CurrentBaseIndex = temp
        Else
            'LastBaseInd = 1
            CurrentBaseIndex = 1
        End If

        'InetProxy
        temp = VBGetPrivateProfileString("GLOBAL", "UseProxy", iniFileName)
        If IsNumeric(temp) Then
            If Val(temp) = 0 Or Val(temp) = 1 Or Val(temp) = 2 Then
                Opt_InetUseProxy = Val(temp)
            Else
                Opt_InetUseProxy = 1    'IE
            End If
        End If
        'server:port
        Opt_InetProxyServerPort = VBGetPrivateProfileString("GLOBAL", "ProxyServerPort", iniFileName)
        'user
        Opt_InetUserName = VBGetPrivateProfileString("GLOBAL", "ProxyUserName", iniFileName)
        'Pass
        'Opt_InetPassword = VBGetPrivateProfileString("GLOBAL", "ProxyPassword", iniFileName)
        'Secure
        temp = VBGetPrivateProfileString("GLOBAL", "ProxySecure", iniFileName)
        If Len(temp) <> 0 Then Opt_InetSecureFlag = CBool(temp) Else Opt_InetSecureFlag = False

        '  
        temp = VBGetPrivateProfileString("GLOBAL", "GetMediaType", iniFileName)
        If Len(temp) <> 0 Then Opt_GetMediaType = CBool(temp) Else Opt_GetMediaType = True

        ' AVI  DirectShow ( MPEG1/2)
        temp = VBGetPrivateProfileString("GLOBAL", "AviDirectShow", iniFileName)
        If Len(temp) <> 0 Then Opt_AviDirectShow = CBool(temp) Else Opt_AviDirectShow = False


        '''''''''''''''''

    End If    'global
End With

'Debug.Print " " & iniFileName

Exit Sub
err:
If err.Number <> 0 Then
Debug.Print "ReadINI.Err: " & err.Description
ToDebug "Err_ReadINI: " & err.Description
End If
End Sub



Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)

On Error Resume Next    '  
Timer2.Enabled = False

'Debug.Print KeyCode, Shift

Select Case KeyCode
    
Case 81 'alt+q
    If Shift = 4 Then Call ComFilter_ShiftClick(2)
    
Case 45 'Insert auto add
    If Shift = 0 Then FrmAuto.Show 1, Me

Case 116 'F5 '
   If FrameView.Visible Then mnuGroup_Click
    
Case 117 'F6 ' /
    Opt_NoSlideShow = Not Opt_NoSlideShow
        If Opt_NoSlideShow Then
            picScrollBoxV.Visible = True: TextVAnnot.Visible = True
            If FrameView.Visible Then ComShowFa_Click
                    ' Set Image0 = Nothing
        Else

            ComShowAn.Visible = False: ComShowFa.Visible = True
            Timer2_Timer ' 
        End If
    Form_Resize

Case 119 'F8 
   If FrameView.Visible Then mnuCard_Click

Case 114 '  F3
   If FrameView.Visible Then ComNext_Click
    

'If PrevVMI <> 0 Then
'If KeyCode = 27 Then VerticalMenu_MenuItemClick PrevVMI
'End If

Case 27 'esc
    VerticalMenu_MenuItemClick 1, 0
    
Case 123 'f12
    FormDebug.Show , FrmMain    ': FrmMain.SetFocus ' F12
    
Case 122 'f11
    FrmPeople.Show , FrmMain   ': FrmMain.SetFocus ' F11
    
Case 121 'F10 options
  If Not frmOptFlag Then VerticalMenu_MenuItemClick 6, 0

Case 112 'F1
    If ChBTT.Value = 0 Then ChBTT.Value = 1 Else ChBTT.Value = 0

Case 80   'P play DXShow
    If MpegMediaOpen Then
        If TabStrAdEd.SelectedItem.Index = 1 Then
            If MediaState = 2 Then    ',  
                mobjManager.Pause
                tPlay.Enabled = False
'                ' 
'                If isMPGflag Or isDShflag Then MPGPosScroll: lastRendedMPG = Position.Value
            Else
                mobjManager.Run
                tPlay.Enabled = True
            End If
        End If
    End If

Case 83   'S sound DXShow
    If MpegMediaOpen Then
        If TabStrAdEd.SelectedItem.Index = 1 Then
            Set objAudio = mobjManager
            If objAudio.Volume = 0 Then objAudio.Volume = -10000 Else objAudio.Volume = 0
            Set objAudio = Nothing
        End If
    End If


End Select
End Sub

Private Sub Form_Load()

Dim WFD As WIN32_FIND_DATA

'
AutoShots = True

'PicSplitLVUHid.BorderStyle = 0:
PicSplitLVDHid.BorderStyle = 0
FirstLVFill = True ':     filllv

'   
CoverVertBackColor = vbWhite
CoverHorBackColor = vbWhite

oldTabStripCoverInd = 1 '  
oldTabLVInd = 0 '  LV

ChBTT.Move 2, 2

Randomize Timer

iniGlobalFileName = App.Path & "\global.ini"
CodecsFileName = App.Path & "\AVCodecList.svc"
userFile = App.Path & "\user.lng"

SendMessage PBar.hWnd, &H2001, 0, ByVal RGB(255, 255, 100) 'PBar Forecolor
SendMessage PBar.hWnd, &H409, 0, ByVal ForeColor 'RGB(50, 150, 0) 'PBar Backcolor

'  
fnd = FreeFile
DebugFileFlagRW = True
On Error Resume Next
Open App.Path & "\svcdebug.log" For Output As fnd Len = 1
If err.Number <> 0 Then DebugFileFlagRW = False
'If DebugFileFlagRW Then Print #fnd, Date & " Ver: " & App.Major & "." & App.Minor & "." & App.Revision
err.Clear
On Error GoTo 0

ListView.MultiSelect = False
FirstActivateFlag = True

KeepFormOnScreen FrmMain

ToDebug Date & " SVC ver: " & App.Major & "." & App.Minor & "." & App.Revision
InitFlag = True
isWindowsNt = Environ$("OS") <> vbNullString
ToDebug "WinNT = " & isWindowsNt & " (" & winver & ")"
Me.ScaleMode = vbPixels
Ratio = 1

'  -  readINI
'SeparadorDecimal = GetDecimalSymbol
SeparadorDecimal = Format$(0, ".")
ToDebug "Separator - (" & SeparadorDecimal & ")"

ToDebug "ACP: " & GetACP
LCID = GetSystemDefaultLCID
ToDebug "LCID: " & LCID

'For Each Contrl In FrmMain.Controls
'If TypeOf Contrl Is TextBox Then 'Or (TypeOf Contrl Is ComboBox) Then
'Contrl.Font.Charset = 204
'End If
'Next
'FontVert.name = "Arial Cyr"
'FontHor.name = "Arial Cyr"

'  
Const TBM_SETTOOLTIPS = &H41D
SendMessage Position.hWnd, TBM_SETTOOLTIPS, 0, 0
SendMessage PositionP.hWnd, TBM_SETTOOLTIPS, 0, 0

' 
Set m_LV_Vert = New cMouseTrack
m_LV_Vert.AttachMouseTracking FrLV_Vert
Set m_TV_Vert = New cMouseTrack
m_TV_Vert.AttachMouseTracking FrTV_Vert
Set m_SS_Vert = New cMouseTrack
m_SS_Vert.AttachMouseTracking FrSplitD_Vert

Call ChangeComboHeights

'''                                          
OpenActDB

' 
FillTemplateCombo App.Path & "\Scripts\", ComboInfoSites

' 
'SetMenuIcon '( readini, )

ReadINI "global"

'   - no auto CD,  ( readini)
If Not DebugMode Then
'or use DbgWProc.dll
'ToDebug "Subclassing..."
    If Opt_QueryCancelAutoPlay Then
        m_RegMsg = RegisterWindowMessage(RegMsg)
    End If
   Call HookWindow(Me.hWnd, Me) 'Friend Function WindowProc
   AttachMessage Me, Me.hWnd, WM_GETMINMAXINFO
End If

'                                                        
If FindFirstFile(CodecsFileName, WFD) < 0 Then MsgBox msgsvc(49), vbExclamation

If LstBases_ListCount > 0 Then
'  LV
Call AddTabsLV
'If LstBases_ListCount > 0 Then bdname = LstBases_List(LastBaseInd)
If CurrentBaseIndex > LstBases_ListCount Then CurrentBaseIndex = LstBases_ListCount
If LstBases_ListCount > 0 Then bdname = LstBases_List(CurrentBaseIndex)
LstBases_ListIndex = CurrentBaseIndex - 1 'LastBaseInd
Else
NoDBFlag = True
End If

'''''''''''
'Set up scroll bars 
'ToDebug "    "
   Set m_cScroll = New cScrollBars
   m_cScroll.Create picScrollBoxV.hWnd
   'm_cScroll.VBGColor = RGB(80, 80, 80)
   m_cScroll.style = efsEncarta
   PicFaceV.Move 0, 0

      ' Set up scroll bars 
   Set ma_cScroll = New cScrollBars
   ma_cScroll.Create PicActFotoScroll.hWnd
   ma_cScroll.style = efsEncarta
   PicActFoto.Move 0, 0


   
'LVSortColl = 0
'ListView.SortOrder = LVSortOrder 'lvwAscending =0 ' lvwDescending =1 '     



frmMainFlag = True

'If Opt_GoInCatalog And Not NoDBFlag Then
If Not NoDBFlag Then
    'ToDebug "    "
    VerticalMenu_MenuItemClick 1, 0 'goto View
Else
    InitFlag = True
    ToDebug "  ..."
    VerticalMenu_MenuItemClick 5, 0 'goto Actors
End If

Image0.top = FrameImageHid.Height / 2 - Image0.Height / 2 ' 

'
'  
ScrShotEd_W = 3360
ScrShotEd_H = 2775
' 
MovieEd_W = 4680
MovieEd_H = 3525

'BackGround
If FindFirstFile(App.Path & "\Templates\background.jpg", WFD) > 0 Then
lngBrush = CreatePatternBrush(LoadPicture(App.Path & "\Templates\background.jpg"))
End If

'NoPicture '     ImageList
LastImageListInd = ImageList.ListImages.Count
If FindFirstFile(App.Path & "\Templates\nopicture.jpg", WFD) > 0 Then
ImageList.ListImages.Add LastImageListInd + 1, "NoPic", LoadPicture(App.Path & "\Templates\nopicture.jpg")
End If
LastImageListInd = ImageList.ListImages.Count

If CombFind.ListIndex > -1 Then CombFind.ListIndex = 0 '    

''  dll
'ToDebug "wiaaut.dll - " & IsDLLAvailable(App.Path & "\wiaaut.dll")
''Debug.Print IsDLLAvailable("mediainfo.dll")

Unload frmSplash: Set frmSplash = Nothing

'Exit Sub
End Sub

Public Sub ClearVideo()
Dim i As Integer
' (, ...)

Set movie = Nothing
movie.Width = MovieEd_W
movie.Height = MovieEd_H


isMPGflag = False: isAVIflag = False: isDShflag = False
pos1 = 0: pos2 = 0: pos3 = 0
PositionP.Value = 0: Position.Value = 0

MPGCodec = vbNullString
PixelRatio = 1: PixelRatioSS = 1

ComRND(0).Enabled = False: ComRND(1).Enabled = False: ComRND(2).Enabled = False
ComAutoScrShots.Enabled = False
For i = 0 To 2: optAspect(i).Enabled = False: Next i

        
'Set PicFrontFace = Nothing
'Set picCanvas = Nothing
Set PicFaceV = Nothing
Set Image0 = Nothing

Set ImgPrCov = Nothing

'Set AVIInf = Nothing
Timer2.Enabled = False

On Error Resume Next

If Not (m_cAVI Is Nothing) Then m_cAVI.filename = vbNullString 'unload
If MpegMediaOpen Then Call MpegMediaClose
'Debug.Print Time, "clear video"
End Sub

Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)

On Error Resume Next
ExitSVC = True

Call TT.DestroyToolTip

If ListView.ListItems.Count > 0 Then
    LastInd = FrmMain.ListView.SelectedItem.SubItems(lvIndexPole)
    WriteKey "LIST", "LastItem", str$(LastInd), iniFileName
End If
WriteKey "GLOBAL", "WindowState", Me.WindowState, iniGlobalFileName
If Me.WindowState = vbNormal Then
WriteKey "GLOBAL", "WindowWidth", Me.Width, iniGlobalFileName
WriteKey "GLOBAL", "WindowHeight", Me.Height, iniGlobalFileName
End If

If TabLVHid.Tabs.Count > 0 Then
WriteKey "GLOBAL", "LastBaseInd", TabLVHid.SelectedItem.Index, iniGlobalFileName
End If

If LVActer.ListItems.Count > 0 Then
    WriteKey "LIST", "LastItemAct", CStr(Val(CurActKey)), iniFileName
End If

If Opt_AutoSaveOpt Then SaveInterface

End Sub

Public Sub Form_Resize()
Dim x As Long, y As Long, w As Long
Dim temp As Single

'
'VerticalMenu.Width -  
FrmMain.ScaleMode = vbPixels '!

Dim LVHeight As Long
'Debug.Print Time
'   
'pTurnOffFullDrag
'''''''''''''''''''''''''

On Error Resume Next

'Background
If lngBrush <> 0 Then
GetClientRect hWnd, rctMain
FillRect hdc, rctMain, lngBrush

'GetClientRect FrameView.hWnd, rctMain
'FillRect FrameView.hDC, rctMain, lngBrush

End If

'DoEvents:
'TextVAnnot.Visible = False
'txt = TextVAnnot.Text: TextVAnnot.Text = vbNullString
'LockWindowUpdate TextVAnnot.hwnd

'FrmMainState = Me.WindowState -  c Bin
If Not NoDBFlag Then
 If Me.WindowState = 1 Then
  Timer2.Enabled = False: Exit Sub '
 Else
  Timer2.Enabled = True
 End If
End If 'nodb

MainWidth = Me.Width - VerticalMenu.Width - 1440 '- 1500
MainWidthPix = Me.ScaleWidth - VerticalMenu.Width / Screen.TwipsPerPixelX - 78
MainHeightPix = Me.ScaleHeight

MainHeight = Me.Height
If MainHeight < 12000 Then
LVHeight = MainHeight / 1.95
Else
LVHeight = MainHeight / 1.75 '1.75 '8
End If
'LVHeight = MainHeight / 1.95

FrameView.Move VerticalMenu.Width + 2, FrameView.top, MainWidthPix, MainHeightPix
VerticalMenu.Move 0, 0, VerticalMenu.Width, MainHeightPix ' + 1


''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' 
If FrameView.Visible Or FirstActivateFlag Then
'Call SendMessage(ListView.hwnd, WM_SETREDRAW, 0, 0)
If Not FirstLVFill Then If ComShowFa.Visible Then Call SendMessage(TextVAnnot.hWnd, WM_SETREDRAW, 0, 0)

' 
'FrameView.Visible = False
': ListView.Visible = False  

If Opt_UCLV_Vis Then
 If Opt_Group_Vis Then
 
  tvGroup.Move 60, tvGroup.top, TVWidth, LVHeight
  temp = Abs(LVWidth / 100 * (MainWidth - tvGroup.Width))
    If LVWidth >= 99 Then temp = (MainWidth - tvGroup.Width) * 0.4
    If LVWidth <= 1 Then temp = (MainWidth - tvGroup.Width) * 0.4

  ListView.Move TVWidth + 120, ListView.top, temp, LVHeight
  FrTV_Vert.Move tvGroup.left + TVWidth, tvGroup.top, FrTV_Vert.Width, LVHeight
  UCLV.Move TVWidth + temp + 180, ListView.top, MainWidth - temp - TVWidth - 90, LVHeight
  tvGroup.Visible = True: FrTV_Vert.Visible = True
 Else
  temp = Abs(LVWidth / 100 * MainWidth)
    If LVWidth >= 99 Then temp = MainWidth * 0.4
    If LVWidth <= 1 Then temp = MainWidth * 0.4

   ListView.Move 60, ListView.top, temp, LVHeight
   UCLV.Move ListView.Width + ListView.left + 60, ListView.top, MainWidth - ListView.Width - 30, LVHeight
   tvGroup.Visible = False: FrTV_Vert.Visible = False
 End If

 FrLV_Vert.Move ListView.Width + ListView.left, ListView.top, FrLV_Vert.Width, LVHeight
 UCLV.Visible = True: FrLV_Vert.Visible = True
 UCLV.Refresh
 
Else ' 

 If Opt_Group_Vis Then
  tvGroup.Move 60, tvGroup.top, TVWidth, LVHeight
  ListView.Move tvGroup.Width + tvGroup.left + 60, ListView.top, MainWidth - tvGroup.Width - 30, LVHeight
  FrTV_Vert.Move tvGroup.Width + tvGroup.left, ListView.top, FrTV_Vert.Width, LVHeight
  tvGroup.Visible = True: FrTV_Vert.Visible = True
 Else
  tvGroup.Visible = False: FrLV_Vert.Visible = False
  ListView.Move 60, ListView.top, MainWidth + 30, LVHeight
 End If
 
 UCLV.Visible = False: FrLV_Vert.Visible = False

End If 'Opt_UCLV_Vis

TabLVHid.Move TabLVHid.left, TabLVHid.top, MainWidth
PicSplitLVDHid.Move PicSplitLVDHid.left, ListView.top + ListView.Height + 50, MainWidth + 30, ScaleY(FrameView.Height, vbPixels, vbTwips) - LVHeight - 700 '750


TextItemHid.Move TextItemHid.left, TextItemHid.top, PicSplitLVDHid.Width
PBar.Move TextItemHid.left + 50, TextItemHid.top + 60, TextItemHid.Width - 130, TextItemHid.Height - 130 'mline TextItemHid.Width - 350

'
SSCoverAnnotW = PicSplitLVDHid.Width - FrFindViewHid.Width - 130
SSCoverAnnotT = TextItemHid.Height + 60
SSCoverAnnotH = PicSplitLVDHid.Height - SSCoverAnnotT - 30

If SplitLVD > 80 Then
    temp = Abs(80 / 100 * SSCoverAnnotW)
Else
    temp = Abs(SplitLVD / 100 * SSCoverAnnotW)
End If

If Opt_NoSlideShow Then ' 
 FrameImageHid.Visible = False
 picScrollBoxV.Move 0, SSCoverAnnotT, temp, SSCoverAnnotH   '- 10  
 TextVAnnot.Move picScrollBoxV.Width + 60, SSCoverAnnotT, SSCoverAnnotW - picScrollBoxV.Width, SSCoverAnnotH
 ' 
 FrSplitD_Vert.Move picScrollBoxV.Width, SSCoverAnnotT, FrSplitD_Vert.Width, SSCoverAnnotH

Else ' 
 'temp = 4000
 FrameImageHid.Move 0, SSCoverAnnotT, temp, SSCoverAnnotH
 Image0.Width = FrameImageHid.Width
 FrameImageHid.Visible = True
 
 picScrollBoxV.Visible = False
  picScrollBoxV.Move FrameImageHid.Width + 60, SSCoverAnnotT, SSCoverAnnotW - FrameImageHid.Width, SSCoverAnnotH
 picScrollBoxV.Visible = True
 
 TextVAnnot.Move picScrollBoxV.left, SSCoverAnnotT, picScrollBoxV.Width, picScrollBoxV.Height
 ' 
 FrSplitD_Vert.Move FrameImageHid.Width, SSCoverAnnotT, FrSplitD_Vert.Width, FrameImageHid.Height
 'If ComShowFa.Visible Then picScrollBoxV.Visible = False
 
End If


'  
FrFindViewHid.left = SSCoverAnnotW + 140

' 
x = ScaleX(CombFind.left, vbTwips, vbPixels)
y = ScaleY(CombFind.top, vbTwips, vbPixels)
w = ScaleY(CombFind.Width, vbTwips, vbPixels)
SetWindowPos CombFind.hWnd, 0, x, y, w, 500, 0
CombFind.SelLength = 0

'Call SendMessage(ListView.hwnd, WM_SETREDRAW, 1, 0)
If ComShowFa.Visible Then Call SendMessage(TextVAnnot.hWnd, WM_SETREDRAW, 1, 0) ' SWP_NOZORDER ?

If FirstLVFill Then
     'nopic
    Image0.Move 0, 0, FrameImageHid.Width, FrameImageHid.Height
    If ImageList.ListImages.Count >= 3 Then
        Image0.PaintPicture ImageList.ListImages(LastImageListInd).Picture, 0, 0, Image0.Width, Image0.Height
    End If
End If

End If

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'If fr_cover Then
If FrameCover.Visible Then

 FrameCover.Move FrameView.left, FrameView.top, FrameView.Width, FrameView.Height
 PicPrintScroll.Move PicPrintScroll.left, PicPrintScroll.top, ScaleX(FrameCover.Width - 7, vbPixels, vbTwips), ScaleY(FrameCover.Height, vbPixels, vbTwips) - FrPrintBotHid.Height - 200
 FrPrintBotHid.Move FrPrintBotHid.left, ScaleY(FrameCover.Height, vbPixels, vbTwips) - FrPrintBotHid.Height - 100, ScaleY(FrameCover.Width, vbPixels, vbTwips) - 300
 CmdPrint.Move FrPrintBotHid.left + FrPrintBotHid.Width - CmdPrint.Width - 300
 TabStripCover.Move TabStripCover.left, TabStripCover.top, FrPrintBotHid.Width - 100
 
 ' 
x = ScaleX(CombFind.left, vbTwips, vbPixels)
y = ScaleY(CombFind.top, vbTwips, vbPixels)
w = ScaleY(CombFind.Width, vbTwips, vbPixels)
SetWindowPos CombFind.hWnd, 0, x, y, w, 500, 0

End If

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'If fr_acter Then
If FrameActer.Visible Or fr_acter Then

Call SendMessage(LVActer.hWnd, WM_SETREDRAW, 0, 0)
Call SendMessage(TextActBio.hWnd, WM_SETREDRAW, 0, 0)



FrameActer.Move FrameView.left, FrameView.top, FrameView.Width, FrameView.Height
FrActLeft.Move FrActLeft.left, FrActLeft.top, ScaleX(FrameActer.Width, vbPixels, vbTwips) / 2.2 - 880, ScaleY(FrameActer.Height, vbPixels, vbTwips) - 350

LVActer.Height = FrActLeft.Height - 2260
FrActSelect.top = FrActLeft.Height - 2200

LVActer.Width = FrActLeft.Width - 50
LVActer.ColumnHeaders(1).Width = LVActer.Width - 400 '    -    myframe

FrActButtons.Move ScaleX(FrameActer.Width, vbPixels, vbTwips) - 1900

FrActBio.Move FrActLeft.Width + 100, ScaleY(FrameView.Height, vbPixels, vbTwips) / 2, ScaleX(FrameActer.Width, vbPixels, vbTwips) - FrActLeft.Width - 150, ScaleY(FrameActer.Height, vbPixels, vbTwips) / 2 - 100

FrActSelect.Width = FrActLeft.Width - 40
TextSearchLVActTypeHid.Width = FrActSelect.Width - comActSearchInBIO.Width - 60
 comActSearchInBIO.left = TextSearchLVActTypeHid.Width + 30
ListBActHid.Width = FrActSelect.Width - LActMarkHelp.Width - 300
ComSelMovIcon.Width = FrActSelect.Width

TextActName.Width = FrActBio.Width - ComRHid(0).Width - 60
ComRHid(0).left = TextActName.left + TextActName.Width + 20

'LockWindowUpdate TextActBio.hwnd
'TextActBio.Move TextActBio.Left, TextActBio.Top, FrActBio.Width - 40, FrActBio.Height - 900
'LockWindowUpdate 0
'Call SendMessage(TextActBio.hwnd, WM_SETREDRAW, False, ByVal 0&)
TextActBio.Width = FrActBio.Width - 40
TextActBio.Height = FrActBio.Height - 900
'Call SendMessage(TextActBio.hwnd, WM_SETREDRAW, True, ByVal 0&)

PicActFotoScroll.Move FrActLeft.Width + 100, PicActFotoScroll.top, ScaleX(FrameActer.Width, vbPixels, vbTwips) - FrActLeft.Width - FrActButtons.Width - 300, FrActBio.top - 300

'LFoto.Move PicActFotoScroll.Left

ComSelMovIcon.pInitialize

Call SendMessage(LVActer.hWnd, WM_SETREDRAW, 1, 0)
Call SendMessage(TextActBio.hWnd, WM_SETREDRAW, 1, 0)
End If
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'If fr_edit Then
If FrameAddEdit.Visible Then
FrameAddEdit.Move (FrameView.Width - FrameAddEdit.Width) / 2 + VerticalMenu.Width + 1, (FrameView.Height - FrameAddEdit.Height) / 2
End If

End Sub
Private Sub ChangeComboHeights()
' 
'         .
'   

Dim x As Long, y As Long, w As Long
'SWP_NOZORDER Or SWP_NOMOVE Or SWP_DRAWFRAME
Const CB_SETDROPPEDWIDTH = &H160

x = ScaleX(ComboGenre.left, vbTwips, vbPixels)
y = ScaleY(ComboGenre.top, vbTwips, vbPixels)
w = ScaleY(ComboGenre.Width, vbTwips, vbPixels)
SetWindowPos ComboGenre.hWnd, 0, x, y, w, 500, 0

x = ScaleX(ComboCountry.left, vbTwips, vbPixels)
y = ScaleY(ComboCountry.top, vbTwips, vbPixels)
w = ScaleY(ComboCountry.Width, vbTwips, vbPixels)
SetWindowPos ComboCountry.hWnd, 0, x, y, w, 500, 0

'  ComboSites   
x = ScaleX(cBasePicURL.left, vbTwips, vbPixels)
y = ScaleY(cBasePicURL.top, vbTwips, vbPixels)
w = ScaleY(cBasePicURL.Width, vbTwips, vbPixels)
SetWindowPos cBasePicURL.hWnd, 0, x, y, w, 500, 0
'  
Call SendMessage(cBasePicURL.hWnd, CB_SETDROPPEDWIDTH, 400, ByVal 0&)

'   
x = ScaleX(ComboSites.left, vbTwips, vbPixels)
y = ScaleY(ComboSites.top, vbTwips, vbPixels)
w = ScaleY(ComboSites.Width, vbTwips, vbPixels)
SetWindowPos ComboSites.hWnd, 0, x, y, w, 500, 0

' 
x = ScaleX(ComboInfoSites.left, vbTwips, vbPixels)
y = ScaleY(ComboInfoSites.top, vbTwips, vbPixels)
w = ScaleY(ComboInfoSites.Width, vbTwips, vbPixels)
SetWindowPos ComboInfoSites.hWnd, 0, x, y, w, 500, 0

', 
x = ScaleX(ComboOther.left, vbTwips, vbPixels)
y = ScaleY(ComboOther.top, vbTwips, vbPixels)
w = ScaleY(ComboOther.Width, vbTwips, vbPixels)
SetWindowPos ComboOther.hWnd, 0, x, y, w, 500, 0

'' 
x = ScaleX(ComboNos.left, vbTwips, vbPixels)
y = ScaleY(ComboNos.top, vbTwips, vbPixels)
w = ScaleY(ComboNos.Width, vbTwips, vbPixels)
SetWindowPos ComboNos.hWnd, 0, x, y, w, 500, 0

'x = ScaleX(TextLang.Left, vbTwips, vbPixels)
'y = ScaleY(TextLang.Top, vbTwips, vbPixels)
'w = ScaleY(TextLang.Width, vbTwips, vbPixels)
''SetWindowPos TextLang.hwnd, 0, x, y, w, 500, SWP_NOSIZE Or SWP_NOACTIVATE Or SWP_NOSENDCHANGING ' Or SWP_NOSIZE
'
'x = ScaleX(TextSubt.Left, vbTwips, vbPixels)
'y = ScaleY(TextSubt.Top, vbTwips, vbPixels)
'w = ScaleY(TextSubt.Width, vbTwips, vbPixels)
'SetWindowPos TextSubt.hwnd, 0, x, y, w, 500, 0
'
'x = ScaleX(TextOther.Left, vbTwips, vbPixels)
'y = ScaleY(TextOther.Top, vbTwips, vbPixels)
'w = ScaleY(TextOther.Width, vbTwips, vbPixels)
'SetWindowPos TextOther.hwnd, 0, x, y, w, 500, 0

      '
TextMName.SelLength = 0
ComboNos.SelLength = 0
cBasePicURL.SelLength = 0
'If TextCDN.Visible Then TextCDN.SetFocus
ComboSites.SelLength = 0
ComboInfoSites.SelLength = 0
ComboGenre.SelLength = 0
ComboCountry.SelLength = 0
ComboOther.SelLength = 0
'TextLang.SelLength = 0
'TextSubt.SelLength = 0
'TextOther.SelLength = 0
End Sub
Private Sub Form_Unload(Cancel As Integer)
ExitSVC = True
On Error Resume Next

Timer2.Enabled = False

If DebugFileFlagRW Then Close #fnd    'debug

Unload FormDebug    ': Set FormDebug = Nothing
Unload FormShowPic    ': Set FormShowPic = Nothing
Unload FrmAuto
Unload FrmBin    ': Set FrmBin = Nothing
Unload FrmFilter    ': Set FrmFilter = Nothing
Unload FrmOptions
Unload FrmPeople    ': Set FrmPeople = Nothing
Unload FrmStat
Unload frmSR

'Set m_cAVI = Nothing
'Set m_cDib = Nothing

'
Set SC = Nothing

'Set mobjManager = Nothing

rs.Close
ars.Close
DB.Close
ADB.Close
Set rs = Nothing
Set DB = Nothing
Set ars = Nothing
Set ADB = Nothing


Call UnhookWindow(Me.hWnd)

'cManager.Goodbye
DetachMessage Me, Me.hWnd, WM_GETMINMAXINFO

'-
If Not (cIM Is Nothing) Then cIM.Detach

'close mutex from main.bas
EndApp

End Sub


Private Sub Image0_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)
If rs Is Nothing Then Exit Sub
If rs.RecordCount < 1 Then Exit Sub

Select Case Button
Case 2    '
    'Timer2.Enabled = False
    Timer2_Timer
    'Exit Sub

Case 4    '
    Timer2.Enabled = False

Case Else
    PicManualFlag = True
    If ListView.ListItems.Count > 0 Then
        ScrShotClick
    End If
    PicManualFlag = False

End Select
End Sub


Private Sub lbInetMovieList_Click()
Dim temp As String
Dim i As Integer

On Error Resume Next

If SC Is Nothing Then Exit Sub
AutoFillStore '       

With SC.CodeObject
    'ClearTextFields ' 
    'If UBound(.MTitlesURL) = LBound(.MTitlesURL) Then Exit Sub   ?
    temp = .MTitlesURL(lbInetMovieList.ListIndex) '+ 1)
End With

If Len(temp) = 0 Then Exit Sub
'Debug.Print temp, URLTitleArr(lbInetMovieList.ListIndex + 1)
ComboSites.Text = temp 'url    -

'DoEvents
'ToDebug "   " & temp

PageText = OpenURLProxy(temp, "txt")

'Debug.Print PageText

'Open "g:\t" For Output As #2
'Print #2, PageText ' Input(LOF(1), 1)
'Close #2
PageArray() = Split(PageText, vbLf)

    'Egg
    If frmPeopleFlag Then
    FrmPeople.List1.Clear
    FrmPeople.List1.Visible = False
    For i = LBound(PageArray) To UBound(PageArray)
    FrmPeople.List1.AddItem i & " |" & PageArray(i)
    Next i
    FrmPeople.SetListboxScrollbar FrmPeople.List1
    FrmPeople.List1.Visible = True
    End If


'
With SC.CodeObject
.MTitle = ""
.MYear = ""
.MGenre = ""
.MDirector = ""
.MActors = ""
.MDescription = ""
.MCountry = ""
.MPicURL = ""
.MRating = ""
.MLang = ""
.MSubt = ""
.MOther = ""
End With

' ,   
SC.Run "AnalyzeMoviePage", CVar(lbInetMovieList.ListIndex)
If SC.Error.Number <> 0 Or err.Number <> 0 Then GoTo ErrorHandler

'     
SetFromScript 'todebug 

AutoFillStore '  
Erase PageArray

Exit Sub
ErrorHandler:

With SC.Error
If .Number <> 0 Then
    MsgBox "Script Error : " & .Number _
        & ": " & .Description & "  " & .Line _
        & "  " & .Column, vbCritical
Set SC = Nothing
Else
MsgBox err.Description, vbCritical
End If
End With
End Sub
Public Sub SetFromScript()
' 
On Error Resume Next

With SC.CodeObject

    If Len(.MTitle) <> 0 Then
        If filltrue(TextMName) Then
            TextMName = .MTitle
        ElseIf filltrueAdd Then
            TextMName = TextMName & " / " & .MTitle
        End If
    End If
    If Len(.MYear) <> 0 Then
        If filltrue(TextYear) Then
            TextYear = .MYear
        ElseIf filltrueAdd Then
            TextYear = TextYear & ", " & .MYear
        End If
    End If
    If Len(.MGenre) <> 0 Then
        If filltrue(TextGenre) Then
            TextGenre = .MGenre
        ElseIf filltrueAdd Then
            TextGenre = TextGenre & ", " & .MGenre
        End If
    End If
    If Len(.MDirector) <> 0 Then
        If filltrue(TextAuthor) Then
            TextAuthor = .MDirector
        ElseIf filltrueAdd Then
            TextAuthor = TextAuthor & ", " & .MDirector
        End If
    End If
    If Len(.MActors) <> 0 Then
        If filltrue(TextRole) Then
            TextRole = .MActors
        ElseIf filltrueAdd Then
            TextRole = TextRole & ", " & .MActors
        End If
    End If
    If Len(.MDescription) <> 0 Then
        If filltrue(TextAnnotation) Then
            TextAnnotation = .MDescription
        ElseIf filltrueAdd Then
            TextAnnotation = TextAnnotation & vbCrLf & .MDescription
        End If
    End If
    If Len(.MCountry) <> 0 Then
        If filltrue(TextCountry) Then
            TextCountry = .MCountry
        ElseIf filltrueAdd Then
            TextCountry = TextCountry & ", " & .MCountry
        End If
    End If
    If Len(.MRating) <> 0 Then
        If filltrue(TextRate) Then
            TextRate = .MRating
        ElseIf filltrueAdd Then
            'TextRate = (Val(TextRate) + Val(.MRating)) / 2
            TextRate = (Str2Val(TextRate) + Str2Val(.MRating)) / 2
        End If
    End If
    If Len(.MLang) <> 0 Then
        If filltrue(TextLang) Then
            TextLang = .MLang
        ElseIf filltrueAdd Then
            TextLang = TextLang & ", " & .MLang
        End If
    End If
    If Len(.MSubt) <> 0 Then
        If filltrue(TextSubt) Then
            TextSubt = .MSubt
        ElseIf filltrueAdd Then
            TextSubt = TextSubt & ", " & .MSubt
        End If
    End If
    If Len(.MPicURL) <> 0 Then '
            TextCoverURL = .MPicURL
    End If
    If Len(.MOther) <> 0 Then
        If filltrue(TextOther) Then
            TextOther = .MOther
        ElseIf filltrueAdd Then
            TextOther = TextOther & vbCrLf & .MOther
        End If
    End If

    ' , 
    If Len(ComboSites.Text) <> 0 Then TextMovURL = ComboSites.Text


    'pix
    If (PicFrontFace.Picture = 0) Or (ChInFilFl.Value <> vbChecked) Then
        If Len(.MPicURL) <> 0 Then
            OpenURLProxy .MPicURL, "pic"
            'Debug.Print SC.CodeObject.MPicURL
        Else
            Set ImgPrCov = Nothing: Set PicFrontFace = Nothing: Set picCanvas = Nothing
            NoPicFrontFaceFlag = True
        End If
    End If

End With

ToDebug "SFS. - " & CStr(err.Number <> 0)        ' 

End Sub

Private Sub ListBActHid_Click()

If NoDBFlag Then Exit Sub

If ListBActHid.SelCount = 0 Then
    ComSelMovIcon.Enabled = False
Else
    ComSelMovIcon.Enabled = True
End If

End Sub

Public Sub LVCLICK()
Dim Itm As ListItem

'mzt Dim netkart As Boolean

LVSelectChanged = True '  frmStat (  ctrl+   ,   )

SelCount = 0: CheckCount = 0
ReDim CheckRows(0): ReDim SelRows(0)
ReDim CheckRowsKey(0): ReDim SelRowsKey(0)

If (rs Is Nothing) Then
    'nopic
    Image0.Move 0, 0, FrameImageHid.Width, FrameImageHid.Height
    Image0.PaintPicture ImageList.ListImages(LastImageListInd).Picture, 0, 0, Image0.Width, Image0.Height
    NoListClear
    Exit Sub
End If
If (rs.RecordCount < 1) Or (ListView.ListItems.Count < 1) Then
    'nopic
    Image0.Move 0, 0, FrameImageHid.Width, FrameImageHid.Height
    Image0.PaintPicture ImageList.ListImages(LastImageListInd).Picture, 0, 0, Image0.Width, Image0.Height
    NoListClear
    Exit Sub
End If

Timer2.Enabled = False
'ListView.Refresh

ComNext.Enabled = True


MultiSel = False

'       
For Each Itm In ListView.ListItems
    With Itm
        If .Selected Then
            SelCount = SelCount + 1
            ReDim Preserve SelRows(UBound(SelRows) + 1)
            SelRows(SelCount) = .ListSubItems(lvIndexPole)
            ReDim Preserve SelRowsKey(UBound(SelRowsKey) + 1)
            SelRowsKey(SelCount) = Itm.Key
        End If
        If .Checked Then
            CheckCount = CheckCount + 1
            ReDim Preserve CheckRows(UBound(CheckRows) + 1)
            CheckRows(CheckCount) = .ListSubItems(lvIndexPole)
            ReDim Preserve CheckRowsKey(UBound(CheckRowsKey) + 1)
            CheckRowsKey(CheckCount) = Itm.Key
        End If
    End With
Next

'SelCount = SendMessage(ListView.hWnd, LVM_GETSELECTEDCOUNT, 0&, ByVal 0&)
If SelCount > 1 Then MultiSel = True

PicManualFlag = False


'If Not MultiSel Then

Select Case rs.Type
Case dbOpenTable
    rs.Seek "=", Val(ListView.SelectedItem.Key)    'seek    sql
    If rs.NoMatch Then Exit Sub
    'Case dbOpenDynamic
    'Case dbOpenSnapshot
Case dbOpenDynaset, dbOpenSnapshot
    rs.FindFirst "[Key] = " & Val(ListView.SelectedItem.Key)
    If rs.NoMatch Then Exit Sub
    'Case dbOpenForwardOnly
Case Else
    '  ,   
Debug.Print "    LVCLICK"
    Exit Sub
End Select

CurSearch = ListView.SelectedItem.Index
LastInd = ListView.SelectedItem.Index - 1
LastKey = Val(ListView.SelectedItem.Key)

'ListView.SelectedItem.Selected = True     ',   ,  


On Error Resume Next

If Opt_LoadOnlyTitles Then
    'If Not lvItemLoaded(ListView.SelectedItem.Index) Then
    '     -      

    FillLvSubs ListView.SelectedItem.Index         ' LV  
    '    lvItemLoaded(ListView.SelectedItem.Index) = True
    'End If
End If


SlideShowFlag = 0
timerflag = False

Set PicTempHid(0) = Nothing: Set PicTempHid(1) = Nothing

'
NoPic1Flag = False: NoPic2Flag = False: NoPic3Flag = False

SShotsCount = 3
If rs.Fields(dbSnapShot1Ind).FieldSize = 0 Then NoPic1Flag = True: SShotsCount = SShotsCount - 1
If rs.Fields(dbSnapShot2Ind).FieldSize = 0 Then NoPic2Flag = True: SShotsCount = SShotsCount - 1
If rs.Fields(dbSnapShot3Ind).FieldSize = 0 Then NoPic3Flag = True: SShotsCount = SShotsCount - 1

If FrameView.Visible Then
    If Not Opt_NoSlideShow Then
        If Not NoPic3Flag Then SlideShowFlag = 2
        If Not NoPic2Flag Then SlideShowFlag = 1
        If Not NoPic1Flag Then SlideShowFlag = 0
        Timer2_Timer

        'SlideShowLastFlag = 0
        'GetPic Image0, 1, "SnapShot1"
        'GetPic PicTempHid(0), 1, "SnapShot1"

        If FormShowPicLoaded Then
            If NoPic1Flag And NoPic2Flag And NoPic3Flag Then
                If ViewScrShotFlag And Not IsCoverShowFlag Then FormShowPic.Hide    ' 
            End If
        End If


        If FormShowPicLoaded And Not IsCoverShowFlag Then
            SlideShowLastGoodPic = 0    '
            SlideShowFlag = 1
            '  ,    1:1
            ShowPicFocus = False    '   1:1

            On Error GoTo 0
            ScrShotClick
            'FormShowPic.HScroll.Max = SShotsCount: FormShowPic.HScroll.Value = 1
            'SetFrmShowPicPicture 0

            ViewScrShotFlag = True: IsCoverShowFlag = False
        End If
    End If
End If


'
Set PicFaceV = Nothing
If picScrollBoxV.Visible Or Opt_NoSlideShow Then
    GetPic PicFaceV, 1, "FrontFace"
    picScrollBoxV_Resize
    If m_cScroll.Visible(efsHorizontal) Then PicFaceV.left = -Screen.TwipsPerPixelX * m_cScroll.Value(efsHorizontal)
    If m_cScroll.Visible(efsVertical) Then PicFaceV.top = -Screen.TwipsPerPixelY * m_cScroll.Value(efsVertical)
End If

If FormShowPicLoaded And Not ViewScrShotFlag Then
    '    1:1 
    If GetPic(PicTempHid(1), 1, "FrontFace") Then
        IsCoverShowFlag = True
        ViewScrShotFlag = False
        ShowInShowPic 1
    Else
        FormShowPic.Hide        ' 
        'Me.SetFocus '  
    End If
End If
If NoPicFrontFaceFlag Then
    PicFaceV.Width = 0: PicFaceV.Height = 0: picScrollBoxV_Resize
    'If FormShowPicFlag And Not ViewScrShotFlag Then FormShowPic.Hide ' 
    If FormShowPicLoaded And Not ViewScrShotFlag Then FormShowPic.Hide        ' 

End If


'  ( FillLvSubs)
If Opt_UCLV_Vis Then FillLVAdd

'TextVAnnot.Text = CheckNoNull("Annotation")
If IsNull(rs.Fields("Annotation")) Then TextVAnnot.Text = vbNullString Else TextVAnnot.Text = rs.Fields("Annotation")

'24.08    Timer2.Enabled = True

End Sub
Private Sub ListView_ColumnClick(ByVal ColumnHeader As MSComctlLib.ColumnHeader)
'Dim ind As Long    'ColumnHeader.Index - 1

If ListView.ListItems.Count < 1 Then Exit Sub

On Error GoTo errh

'sort
LVSortColl = ColumnHeader.Index
ComNext.Enabled = True

'LockWindowUpdate ListView.hwnd

'  
ListView.SortOrder = (ListView.SortOrder + 1) Mod 2
LVSortOrder = ListView.SortOrder

ToDebug "SortHeader/Order: " & ColumnHeader.Text & "/" & LVSortOrder

' <, >
ColumnHeader.Text = ChangeLVHSortMark(ColumnHeader.Text)

'ind = ColumnHeader.Index - 1
LVSOrt ColumnHeader.Index

'Select Case ind
'Case dbTimeInd  'time
'    SortByDates ind
'Case dbYearInd, dbFileLenInd, dbCDNInd, dbRatingInd, lvIndexPole  'lvHeaderIndexPole ' 4,  12, cdn 13, , 
'    SortByNumber ind, ListView
'Case Else
'    If ind = dbLabelInd Then
'        Select Case rs(dbLabelInd).Type
'        Case 2, 3, 4, 6, 7 ' -
'            SortByNumber ind, ListView
'        Case Else
'            ' 
'            SortByString ind
'        End Select
'    Else
'        ' 
'        SortByString ind
'    End If
'End Select

'LockWindowUpdate 0

CurSearch = ListView.SelectedItem.Index
If MultiSel Then
    ListView.ListItems(CurSearch).EnsureVisible
Else
    LV_EnsureVisible ListView, CurSearch
End If

Exit Sub

errh:
ToDebug "Err_SortLV: " & err.Description

End Sub

Private Function ChangeLVHSortMark(s As String) As String
Dim ColHead As MSComctlLib.ColumnHeader
'  <, > ">"
For Each ColHead In ListView.ColumnHeaders
 If right$(ColHead.Text, 2) = " >" Or right$(ColHead.Text, 2) = " <" Then ColHead.Text = left$(ColHead.Text, Len(ColHead.Text) - 2)
Next
 If right$(s, 2) = " >" Or right$(s, 2) = " <" Then s = left$(s, Len(s) - 2)

If LVSortColl > 0 Then
'
If ListView.SortOrder = lvwAscending Then
 ChangeLVHSortMark = s & " >"
Else
 ChangeLVHSortMark = s & " <"
End If
End If

End Function

Private Sub ListView_DblClick()
'
VerticalMenu_MenuItemClick 2, 0
End Sub

Private Sub ListView_ItemCheck(ByVal Item As MSComctlLib.ListItem)
If rs Is Nothing Then Exit Sub

'rs.MoveFirst:rs.Move Item.ListSubItems(lvIndexPole)
'RSMOVE Item.ListSubItems(lvIndexPole), "ListView_ItemCheck"
RSGoto Item.Key

If BaseReadOnly Then Exit Sub

rs.Edit
If Item.Checked Then
 rs.Fields(dbCheckedInd) = "1"
Else
 rs.Fields(dbCheckedInd) = vbNullString
End If

rs.Update
End Sub




Private Sub ListView_KeyPress(KeyAscii As Integer)
'Debug.Print KeyAscii
'Dim Itm As ListItem
Dim ClickFlag As Boolean '   LV (  ctrl+N)

ClickFlag = False

'Debug.Print ": " & KeyAscii  '& Chr$(KeyAscii)
Select Case KeyAscii

Case 26 'ctrl+Z  
    mChSel_Click
    
Case 22 'ctrl+v
    mSelCh_Click ' 
    
Case 23 'ctrl+w '   
    Call MakeDupCurrent

'  Case 6 'crtl+F
'    mSR_Click '

Case 18 'ctrl R
    InetGetPics True '

Case 20 'ctrl T
    InetGetPics False '

Case 43 ' + 
JoinMovies (True) 'for checked



Case 1 'ctrl+A
    Call mnuSelectAllLV_Click
'    For Each Itm In ListView.ListItems
'        Itm.Selected = True
'    Next
'    ClickFlag = True

Case 2 'ctrl+B
    Call mnuCheckAll_Click
    
Case 4 'ctrl+D
    Call mnuCheckNone_Click
    
Case 13 'ctrl+M Enter
    Call mnuPlayM_Click

'  Case 5 '^E
'    Call mnuEditMov_Click

'  Case 14 '^N
'Call mnuAddNewMov_Click

Case 19 'S
    Call mnuSortChecked_Click

Case 9 'ctrl+i
    Call mInvCh_Click

Case 10 'ctrl+j
    Call mInvSel_Click

Case 21 'U
    Call mnuDolgSel_Click

Case 12 'L
    Call mnuLabelSel_Click

Case 3 'C
    Call mnuCopyLV_Click

Case 8 'H  ?BackSpace
    Call mnuHTML_Click

Case 25 ' Y
    Call mnuDolgCheck_Click

Case 11 ' K
    Call mnuLabelCheck_Click

Case 24 'X
    Call mnuExportCheckClip_Click

Case 7 'G
    Call mnuExportCheckHTML_Click

'  Case 6 '^F
'    ComFind_Click

Case 15 '^O Excel
    mCh2Excel_Click

Case 16 '^P
    mSel2Excel_Click

End Select

If ClickFlag Then LVCLICK
End Sub

Private Sub ListView_KeyUp(KeyCode As Integer, Shift As Integer)
'    -  KeyUp
'Debug.Print KeyCode

'Debug.Print CurSearch, ListView.SelectedItem.index
Timer2.Enabled = False
'CurSearch = ListView.SelectedItem.index
'Set ListView.SelectedItem = ListView.ListItems(LastInd)
'Debug.Print CurSearch, ListView.SelectedItem.index
LVCLICK
End Sub

Private Sub ListView_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)
Timer2.Enabled = False

If Button = vbLeftButton Then

If Not MultiSel Then

        '    
        TextItemHid.Text = vbNullString
        lvwMsg.x = x / Screen.TwipsPerPixelX
        lvwMsg.y = y / Screen.TwipsPerPixelY
        DoEvents
        SendMessage ListView.hWnd, 4153, 0, lvwMsg
            If lvwMsg.Flgs And 14 Then
                If lvwMsg.SubItm Then
                    TextItemHid.Text = ListView.ListItems(lvwMsg.Itm + 1).SubItems(lvwMsg.SubItm)
                Else
                    TextItemHid.Text = ListView.ListItems(lvwMsg.Itm + 1).Text
                End If
            End If
End If 'not multi
End If

If Button = vbRightButton Then

'LockWindowUpdate ListView.hwnd
'FrameView.Enabled = False: ListView.Enabled = False: ListView.Enabled = True: FrameView.Enabled = True
'ListView.Enabled = True
'FrameView.Visible = True
'LockWindowUpdate 0
'ReleaseCapture
'DoEvents

'     
'WM_RBUTTONUP = &H205
Call SendMessage(ListView.hWnd, &H205, 0, ByVal 0&)


'LVPopupFlag = True
'
'       If CheckCount > 0 Then mnuLVChecked.Enabled = True Else mnuLVChecked.Enabled = False
mnuLVChecked.Caption = mnuLVCheckedCaption & vbTab & "(" & CheckCount & ")"
mnuLVSelected.Caption = mnuLVSelectedCaption & vbTab & "(" & SelCount & ")"

''   (  ?)
'mSumCh.Caption = mSumChCaption & vbTab & FileSizeSumCh & " Mb"
'mSumSel.Caption = mSumSelCaption & vbTab & FileSizeSumSel & " Mb"

If ListView.ListItems.Count > 0 Then
    mnuPlayM.Enabled = True
    If SelCount > 0 Then If Len(CheckNoNull("MovieURL")) <> 0 Then mGotoURL.Enabled = True Else mGotoURL.Enabled = False
    
    mnuEditMov.Enabled = True
    mSR.Enabled = True

    mnuLVChecked.Enabled = True 'main ch
    mnuCheckAll.Enabled = True
    mnuCheckNone.Enabled = True
    mInvCh.Enabled = True
    '
    mnuLVSelected.Enabled = True 'main sel
    mnuSelectAllLV.Enabled = True
    mInvSel.Enabled = True
Else
    mnuPlayM.Enabled = False
    mGotoURL.Enabled = False
    mnuEditMov.Enabled = False
    mSR.Enabled = False

    mnuLVChecked.Enabled = False 'main ch
    mnuCheckAll.Enabled = False
    mnuCheckNone.Enabled = False
    mInvCh.Enabled = False
    '
    mnuLVSelected.Enabled = False 'main sel
    mnuSelectAllLV.Enabled = False
    mInvSel.Enabled = False
End If


    If CheckCount > 0 Then
        mnuCheckNone.Enabled = True
        mnuSortChecked.Enabled = True
        mnuDolgCheck.Enabled = True
        mnuLabelCheck.Enabled = True
        mGetCoverCh.Enabled = True
        mnuExportCheckClip.Enabled = True
        mCh2Excel.Enabled = True
        mnuExportCheckHTML.Enabled = True
        mDelCh.Enabled = True
        If CheckCount > 1 Then mCombine.Enabled = True
        '
        mSelCh.Enabled = True
        mUnSelCh.Enabled = True
    Else
        mnuCheckNone.Enabled = False
        mnuSortChecked.Enabled = False
        mnuDolgCheck.Enabled = False
        mnuLabelCheck.Enabled = False
        mGetCoverCh.Enabled = False
        mnuExportCheckClip.Enabled = False
        mCh2Excel.Enabled = False
        mnuExportCheckHTML.Enabled = False
        mDelCh.Enabled = False
        mCombine.Enabled = False
        '
        mSelCh.Enabled = False
        mUnSelCh.Enabled = False

    End If
   
    If SelCount > 0 Then
        mChSel.Enabled = True
        mUnChSel.Enabled = True
        '
        mnuDolgSel.Enabled = True
        mnuLabelSel.Enabled = True
        mGetCoverSel.Enabled = True
        mnuCopyLV.Enabled = True
        mSel2Excel.Enabled = True
        mnuHTML.Enabled = True
        mDelSel.Enabled = True
        mnuCopyRow.Enabled = True
    Else
        mChSel.Enabled = False
        mUnChSel.Enabled = False
        '
        mnuDolgSel.Enabled = False
        mnuLabelSel.Enabled = False
        mGetCoverSel.Enabled = False
        mnuCopyLV.Enabled = False
        mSel2Excel.Enabled = False
        mnuHTML.Enabled = False
        mDelSel.Enabled = False
        mnuCopyRow.Enabled = False
    End If

'ReleaseCapture
'LVCLICK
Me.PopupMenu Me.popLVHid, vbPopupMenuCenterAlign
', vbPopupMenuLeftButton

'ListView.Enabled = False: ListView.Enabled = True

End If
'If Not MultiSel Then Timer2.Enabled = True
End Sub



Private Sub LVActer_ItemClick(ByVal Item As MSComctlLib.ListItem)
''  
'If ActNotManualClick Then
'Else
'    LVActClick
'End If
End Sub

Private Sub LVActer_KeyDown(KeyCode As Integer, Shift As Integer)
If KeyCode = 46 Or KeyCode = 110 Then ComActDel_Click
End Sub

Private Sub mnuAddNewMov_Click()
VerticalMenu_MenuItemClick 3, 0

End Sub

Private Sub mnuCheckAll_Click()
If ListView.ListItems.Count < 1 Then Exit Sub

Dim Itm As MSComctlLib.ListItem
    LV_AllItemsCheck
For Each Itm In ListView.ListItems
    Itm.Checked = True
Next
LVCLICK
End Sub

Private Sub mnuCheckNone_Click()
If ListView.ListItems.Count < 1 Then Exit Sub

Dim Itm As MSComctlLib.ListItem
    LV_AllItemsUnCheck
For Each Itm In ListView.ListItems
    Itm.Checked = False
Next
LVCLICK
End Sub

Private Sub mnuCopyFace_Click()
Clipboard.Clear
'
PicFaceV.Picture = PicFaceV.Image
Clipboard.SetData PicFaceV.Picture ', vbCFBitmap
End Sub

Private Sub mnuCopyFoto_Click()
Clipboard.Clear
Clipboard.SetData PicActFoto.Picture
End Sub

Private Sub mnuCopyLV_Click()
'like mnuCopyLV_Click GetCoverSpisokLabel GetCoverSpisok
' -  
If SelCount < 1 Then Exit Sub

Dim sOldLang As String
Dim j As Integer, M As Integer
Dim temp As String, temp2 As String
Dim DoFlag As Boolean
Dim addLabel As Boolean
Dim tmp As String, tmpm As String
Dim pArr() As Integer
Dim allArr() As String

Timer2.Enabled = False
Screen.MousePointer = vbHourglass

DoEvents

'        - 
'  - ,  -   

ReDim pArr(ListView.ColumnHeaders.Count) As Integer
For j = 0 To LstExport_ListCount - 1    ' 
    pArr(ListView.ColumnHeaders(j + 1).Position) = j
Next j

ReDim allArr(UBound(SelRows))

For M = 1 To UBound(SelRows)
    If MultiSel Then
        RSGoto SelRowsKey(M)
    End If

    '
    For j = 1 To ListView.ColumnHeaders.Count - 1

        DoFlag = False
        If LstExport_Arr(pArr(j)) Then DoFlag = True

        If DoFlag Then
            'If rs.Fields(pArr(j)).Value <> vbNullString Then

            '  
            If M = 1 And j = 1 Then    '    
                tmpm = CheckNoNullVal(dbLabelInd)
            Else
                If tmpm <> vbNullString Then
                    If CheckNoNullVal(dbLabelInd) = tmpm Then
                        addLabel = True
                    Else
                        addLabel = False
                        tmpm = vbNullString    '    
                    End If
                End If
            End If

            If pArr(j) = dbFileNameInd Then
                '    
                tmp = CheckNoNullVal(pArr(j)): tmp = GetNameFromPathAndName(tmp)
            Else
                tmp = CheckNoNullVal(pArr(j))
            End If

            ' 
            If Opt_ShowColNames Then
                If IsNotEmptyOrZero(tmp) Then
                    If pArr(j) <> dbMovieNameInd Then
                        tmp = TranslatedFieldsNames(pArr(j)) & ": " & tmp
                    End If
                End If
            End If

            If LenB(temp) = 0 Or j = 1 Then    'j -  
                '    
                If IsNotEmptyOrZero(tmp) Then temp = temp & " " & tmp
            Else
                ' 
                If IsNotEmptyOrZero(tmp) Then temp = temp & ExportDelim & tmp
            End If

            'End If
        End If    'doflag
    Next j

    ' + 
    If LstExport_Arr(dbAnnotationInd) Then
        tmp = CheckNoNullVal(dbAnnotationInd)

        If Opt_ShowColNames Then
            If Len(tmp) <> 0 Then
                '  
                tmp = TranslatedFieldsNames(dbAnnotationInd) & ": " & tmp
            End If
        End If

        If LenB(temp) = 0 Or j = 0 Then    'j -  
            '   
            If Len(tmp) <> 0 Then temp = temp & " " & tmp
        Else
            ' 
            If Len(tmp) <> 0 Then temp = temp & ExportDelim & tmp
        End If
    End If

    If Len(temp) <> 0 Then
        If SelCount > 1 Then
            temp = M & ")" & temp    '  
        Else
            temp = LTrim$(temp)
        End If

        allArr(M) = temp & vbCrLf
        'temp2 = temp2 & temp & vbCrLf

    End If
    temp = vbNullString

Next M
temp2 = Join(allArr, vbNullString)

If M > 1 Then    'm=2   
    If addLabel Then
        temp2 = LLabel & ": " & tmpm & " (" & M - 1 & ") " & vbCrLf & temp2
    Else
        '   temp2 = temp2 & vbCrLf & "(" & M - 1 & ")"
    End If
End If

'  

Clipboard.Clear
sOldLang = switchLang("00000419")    '   

On Error Resume Next    '  ?

If Len(temp2) = 0 Then temp2 = NamesStore(6)
Clipboard.SetText temp2

If Len(sOldLang) > 0 Then sOldLang = switchLang(sOldLang)    ' 

RestoreBasePos

Screen.MousePointer = vbNormal
'Set m_cDib = Nothing

End Sub

Private Sub mnuDolgCheck_Click()
If CheckCount > 0 Then Call MNU_DOLG(False) 'Check
End Sub

Private Sub mnuDolgSel_Click()
If SelCount < 1 Then Exit Sub
Call MNU_DOLG(True)
End Sub

Private Sub mnuEditMov_Click()

VerticalMenu_MenuItemClick 2, 0
End Sub

Private Function GetCoverSpisok() As String
'like mnuCopyLV_Click GetCoverSpisokLabel GetCoverSpisok
If chPrnAllOne.Value = vbChecked Then
' If (LVSortColl > 0) Or (LVSortColl = -1) Then    ' 
'    GetCoverSpisok = GetCoverSpisokLabel
'    Exit Function
' End If
Else
    GetCoverSpisok = GetCoverSpisokLabel
    Exit Function
End If

'   , 
Dim j As Integer, M As Integer
Dim temp As String, temp2 As String
Dim DoFlag As Boolean
Dim addLabel As Boolean
Dim tmp As String, tmpm As String

Screen.MousePointer = vbHourglass

'        - 
'  - ,  -   
Dim pArr() As Integer
ReDim pArr(ListView.ColumnHeaders.Count) As Integer
For j = 0 To LstExport_ListCount - 1    ' 
    pArr(ListView.ColumnHeaders(j + 1).Position) = j
Next j

Dim allArr() As String
ReDim allArr(UBound(CheckRows))

For M = 1 To UBound(CheckRows)

    'rs.MoveFirst: rs.Move CheckRows(M)
    'RSMOVE CheckRows(M), "GetCoverSpisok"
    RSGoto CheckRowsKey(M)
    
    '
    For j = 1 To ListView.ColumnHeaders.Count - 1

        DoFlag = False
        If LstExport_Arr(pArr(j)) Then DoFlag = True

        If DoFlag Then
            'If rs.Fields(pArr(j)).Value <> vbNullString Then

            '  
            If M = 1 And j = 1 Then    '    
                tmpm = CheckNoNullVal(dbLabelInd)
            Else
                If tmpm <> vbNullString Then
                    If CheckNoNullVal(dbLabelInd) = tmpm Then
                        If CheckCount > 1 Then
                            addLabel = True
                        Else
                            addLabel = False
                        End If
                    Else
                        addLabel = False
                        tmpm = vbNullString    '    
                    End If
                End If
            End If

            If pArr(j) = dbFileNameInd Then
                '    
                tmp = CheckNoNullVal(pArr(j)): tmp = GetNameFromPathAndName(tmp)
            Else
                tmp = CheckNoNullVal(pArr(j))
            End If
            
            ' 
            If Opt_ShowColNames Then
                If IsNotEmptyOrZero(tmp) Then
                    If pArr(j) <> dbMovieNameInd Then
                        tmp = TranslatedFieldsNames(pArr(j)) & ": " & tmp
                    End If
                End If
            End If
            
            If LenB(temp) = 0 Or j = 1 Then    'j -  
                '    
                If IsNotEmptyOrZero(tmp) Then temp = temp & " " & tmp
            Else
                ' 
                If IsNotEmptyOrZero(tmp) Then temp = temp & ExportDelim & tmp
            End If

            'End If
        End If    'doflag
    Next j

    ' + 
    If LstExport_Arr(dbAnnotationInd) Then
        tmp = CheckNoNullVal(dbAnnotationInd)
        
            If Opt_ShowColNames Then
                If Len(tmp) <> 0 Then
                    '  
                    tmp = TranslatedFieldsNames(dbAnnotationInd) & ": " & tmp
                End If
            End If

        If LenB(temp) = 0 Or j = 0 Then    'j -  
            '   
            If IsNotEmptyOrZero(tmp) Then temp = temp & " " & tmp
        Else
            ' 
            If IsNotEmptyOrZero(tmp) Then temp = temp & ExportDelim & tmp
        End If
    End If

    If Len(temp) <> 0 Then
        If CheckCount > 1 Then
            temp = M & ". " & temp    '  
        Else
            temp = LTrim$(temp)
        End If
        'temp2 = temp2 & temp & vbCrLf
        allArr(M) = temp & vbCrLf
    End If
    temp = vbNullString

    '  
    'If Len(temp2) > 32000 Then Exit For
    If M > 150 Then Exit For
Next M
temp2 = Join(allArr, vbNullString)

' . .  
RestoreBasePos

If addLabel Then temp2 = temp2 & vbCrLf & "[" & tmpm & "]"

If Len(temp2) = 0 Then temp2 = NamesStore(6)    ':        .
GetCoverSpisok = temp2

Screen.MousePointer = vbNormal
End Function

Private Function GetCoverSpisokLabel() As String
'like mnuCopyLV_Click GetCoverSpisok
'     ,    -  
': 10 DVD+R (4)
'1) .    (The Librarian: Quest for the Spear);;2004
'2) ,  , A Lot Like Love;, ;2005
'3)   ,  ,   (Jeux d'enfants); ;2005
'4)  -   (Unleashed, Danny the Dog);, ;2005


Dim strSQL As String
Dim rsTmp As DAO.Recordset
Dim grf As String
Dim coun As Integer, i As Integer, j As Integer, k As Integer
Dim DoFlag As Boolean
Dim temp As String, temp2 As String
'Dim addLabel As Boolean
Dim tmp As String ', tmpm As String
Dim NextGrFieldFlag As Boolean
Dim oldGrField As String
Dim GrField As String
Dim AscDesc As String    '    LVSortOrder

Screen.MousePointer = vbHourglass

If (LVSortColl > 0) Then     ' 

    '        - 
    '  - ,  -   
    Dim pArr() As Integer
    ReDim pArr(ListView.ColumnHeaders.Count) As Integer
    For j = 0 To LstExport_ListCount - 1    ' 
        pArr(ListView.ColumnHeaders(j + 1).Position) = j
    Next j

    Dim allArr() As String
    ReDim allArr(UBound(CheckRows))

    grf = GetGroupFieldName(LVSortColl)
    If Len(grf) <> 0 Then
        'strSQL = "SELECT " & grf & " FROM STORAGE Group by " & grf
        'strSQL = "SELECT * FROM STORAGE WHERE " & grf & " IN (" & strSQL & ") AND Checked = '1' Order By " & grf

        If LVSortOrder = lvwAscending Then
            AscDesc = "Asc"
        Else
            AscDesc = "Desc"
        End If

        strSQL = "SELECT * FROM STORAGE WHERE Checked = '1' Order By " & grf & " " & AscDesc
        Set rsTmp = DB.OpenRecordset(strSQL)

        If rsTmp.RecordCount > 0 Then

            rsTmp.MoveLast: rsTmp.MoveFirst
            If rsTmp.RecordCount > 150 Then coun = 150 Else coun = rsTmp.RecordCount    '  
            NextGrFieldFlag = True    '    

            For i = 0 To coun - 1    ' 

                '
                For j = 1 To ListView.ColumnHeaders.Count - 1

                    DoFlag = False
                    If LstExport_Arr(pArr(j)) Then DoFlag = True

                    If DoFlag Then


                        If j = 1 Then
                            oldGrField = GrField
                            If Not IsNull(rsTmp(grf)) Then GrField = UCase$(Trim$(rsTmp(grf))) Else GrField = "Empty"

                            If GrField = oldGrField Then
                                k = k + 1    ' 

                            Else
                                k = 1
                            End If

                        End If

                        If pArr(j) = dbFileNameInd Then
                            '    
                            If Not IsNull(rsTmp(pArr(j))) Then tmp = rsTmp(pArr(j)) Else tmp = vbNullString
                            tmp = GetNameFromPathAndName(tmp)
                        Else
                            If Not IsNull(rsTmp(pArr(j))) Then tmp = rsTmp(pArr(j)) Else tmp = vbNullString
                        End If

                        ' 
                        If Opt_ShowColNames Then
                            If IsNotEmptyOrZero(tmp) Then
                                If pArr(j) <> dbMovieNameInd Then
                                    tmp = TranslatedFieldsNames(pArr(j)) & ": " & tmp
                                End If
                            End If
                        End If
                        
                        If LenB(temp) = 0 Or j = 1 Then    'j -  
                            '    
                            If IsNotEmptyOrZero(tmp) Then temp = temp & " " & tmp
                        Else
                            ' 
                            If IsNotEmptyOrZero(tmp) Then temp = temp & ExportDelim & tmp
                        End If

                        'End If
                    End If    'doflag
                Next j

                ' + 
                If LstExport_Arr(dbAnnotationInd) Then
                    If Not IsNull(rsTmp(dbAnnotationInd)) Then tmp = rsTmp(dbAnnotationInd) Else tmp = vbNullString

                    If Opt_ShowColNames Then
                        If Len(tmp) <> 0 Then
                            '  
                            tmp = TranslatedFieldsNames(dbAnnotationInd) & ": " & tmp
                        End If
                    End If
                    
                    If LenB(temp) = 0 Or j = 0 Then    'j -  
                        '   
                        If Len(tmp) <> 0 Then temp = temp & " " & tmp
                    Else
                        ' 
                        If Len(tmp) <> 0 Then temp = temp & ExportDelim & tmp
                    End If
                End If

                If Len(temp) <> 0 Then
                    If CheckCount > 1 Then
                        temp = k & ") " & temp    '  

                    Else
                        temp = LTrim$(temp)
                    End If
                    'temp2 = temp2 & temp & vbCrLf
                    allArr(i) = temp & vbCrLf
                End If


                '   
                'TranslatedFieldsNames(LVSortColl - 1) &
                If GrField <> oldGrField Then
                    'If i = 0 Then
                    'allArr(i) = " " & GrField & vbCrLf & allArr(i)
                    'Else
                    allArr(i) = vbCrLf & "  " & GrField & vbCrLf & allArr(i)
                    'End If


                End If

                temp = vbNullString

                rsTmp.MoveNext
            Next i    '
            temp2 = Join(allArr, vbNullString)

            rsTmp.Close: Set rsTmp = Nothing

        End If            'rsTmp.RecordCount > 0

    End If        'grf

Else    ' 
    ':        .
    '      
    If Len(temp2) = 0 Then temp2 = NamesStore(9)

End If    '

GetCoverSpisokLabel = temp2

Screen.MousePointer = vbNormal
End Function




Private Sub mnuExportCheckClip_Click()
'  
'mnuCopyLV_Click
'GetCoverSpisok

If CheckCount = 0 Then Exit Sub
If rs Is Nothing Then Exit Sub

' -  
Dim j As Integer, M As Integer, i As Integer
Dim temp As String, temp2 As String
Dim DoFlag As Boolean
Dim sOldLang As String

Dim addLabel As Boolean
Dim tmp As String, tmpm As String


Timer2.Enabled = False
Screen.MousePointer = vbHourglass

DoEvents

'        - 
'  - ,  -   
Dim pArr() As Integer
ReDim pArr(ListView.ColumnHeaders.Count) As Integer
For j = 0 To LstExport_ListCount - 1 ' 
pArr(ListView.ColumnHeaders(j + 1).Position) = j
Next j

Dim allArr() As String
ReDim allArr(UBound(CheckRows))

For M = 1 To UBound(CheckRows)

'rs.MoveFirst: rs.Move CheckRows(M)
'RSMOVE CheckRows(M), "mnuExportCheckClip_Click"
RSGoto CheckRowsKey(M)

'
For j = 1 To ListView.ColumnHeaders.Count - 1

DoFlag = False
If LstExport_Arr(pArr(j)) Then DoFlag = True

If DoFlag Then
    'If rs.Fields(pArr(j)).Value <> vbNullString Then
        
            '  
            If M = 1 And j = 1 Then '    
                tmpm = CheckNoNullVal(dbLabelInd)
            Else
                If tmpm <> vbNullString Then
                    If CheckNoNullVal(dbLabelInd) = tmpm Then
                        addLabel = True
                    Else
                        addLabel = False
                        tmpm = vbNullString '    
                    End If
                End If
            End If

        If pArr(j) = dbFileNameInd Then
            '    
            tmp = CheckNoNullVal(pArr(j)): tmp = GetNameFromPathAndName(tmp)
        Else
            tmp = CheckNoNullVal(pArr(j))
        End If
        
                    ' 
            If Opt_ShowColNames Then
                If IsNotEmptyOrZero(tmp) Then
                    If pArr(j) <> dbMovieNameInd Then
                        tmp = TranslatedFieldsNames(pArr(j)) & ": " & tmp
                    End If
                End If
            End If
            
        If LenB(temp) = 0 Or j = 1 Then 'j -  
            '    
            If IsNotEmptyOrZero(tmp) Then temp = temp & " " & tmp
        Else
            ' 
            If IsNotEmptyOrZero(tmp) Then temp = temp & ExportDelim & tmp
        End If
        
    'End If
End If 'doflag
Next j

' + 
If LstExport_Arr(dbAnnotationInd) Then
    tmp = CheckNoNullVal(dbAnnotationInd)
    
            If Opt_ShowColNames Then
                If Len(tmp) <> 0 Then
                    '  
                    tmp = TranslatedFieldsNames(dbAnnotationInd) & ": " & tmp
                End If
            End If
            
     If LenB(temp) = 0 Or j = 0 Then 'j -  
      '   
      If Len(tmp) <> 0 Then temp = temp & " " & tmp
     Else
      ' 
      If Len(tmp) <> 0 Then temp = temp & ExportDelim & tmp
    End If
End If
    

 If Len(temp) <> 0 Then
  If CheckCount > 1 Then
   temp = M & "." & temp '  
  Else
   temp = LTrim$(temp)
  End If
  'temp2 = temp2 & temp & vbCrLf
  allArr(M) = temp & vbCrLf
  
 End If
 temp = vbNullString
Next M
temp2 = Join(allArr, vbNullString)

If M > 1 Then
If addLabel Then
    'temp2 = temp2 & vbCrLf & "(" & M - 1 & ") " & tmpm 'total to copy
    temp2 = LLabel & ": " & tmpm & " (" & M - 1 & ") " & vbCrLf & temp2

Else
    'temp2 = temp2 & vbCrLf & "(" & M - 1 & ")" 'total to copy
End If
End If

' . .  
RestoreBasePos

'  
Clipboard.Clear
sOldLang = switchLang("00000419")
'If Len(sOldLang) > 0 Then _
'sOldLang = switchLang(sOldLang)

On Error Resume Next '  ?
Clipboard.SetText temp2
'Debug.Print Len(temp2)

If Len(sOldLang) > 0 Then _
sOldLang = switchLang(sOldLang)

Screen.MousePointer = vbNormal
'Set m_cDib = Nothing
End Sub





Private Sub mnuExportCheckHTML_Click()
If CheckCount = 0 Then Exit Sub
'False -  v
Export2HTML False
End Sub

Private Sub mnuHTML_Click()
'true -  ( )
If SelCount < 1 Then Exit Sub
Export2HTML True
End Sub

Private Sub mnuMovieCopyClip_Click()
Clipboard.Clear
Clipboard.SetData m_cAVI.FramePicture(Position.Value, AviWidth, AviHeight)
End Sub

Private Sub mnuMovieSaveFrame_Click()
'   bmp    movie avi
Dim dib As cDIB
Dim pDIB As Long 'pointer to packed DIB in memory

'create a DIB class to load the frames into
Set dib = New cDIB
pDIB = AVIStreamGetFrame(From_m_pGF, Position.Value)  'returns "packed DIB"
If dib.CreateFromPackedDIBPointer(pDIB) Then
    'Call dib.WriteToFile(App.Path & "\" & Position.Value& ".bmp")
    Call dib.WriteToFile(pSaveDialogBMP(DTitle:=ComSaveRec.Caption))
End If
    
Set dib = Nothing
End Sub



Private Sub mnuPlayM_Click()
ComPlay_Click
End Sub
Private Sub mnuAutoSizeLV_Click()
Dim ret As Long
'ToDebug "   ?"
ret = myMsgBox(msgsvc(43), vbYesNoCancel, , Me.hWnd)
If ret = vbYes Then
    lvwAutoSizeColumns ListView, True
ElseIf ret = vbNo Then
    lvwAutoSizeColumns ListView, False
Else         'cancel
    Exit Sub
End If         'ret

End Sub
'Private Sub LV_Line_BackColor(ch As Boolean)
'Dim c As Long
'Dim cd As cCommonDialog
'Dim ret As Long
'Dim tempL As Long
''mzt Dim i As Long
'Dim j As Integer
'Dim itmX As MSComctlLib.ListItem
'
'Set cd = New cCommonDialog
'cd.CustomColor(0) = tempL
'ret = cd.VBChooseColor(c, True, False, False, Me.hWnd)
'If ret = 0 Then Exit Sub
'tempL = c
''Set cd = Nothing
'
'If ch Then '
''For i = 1 To UBound(CheckRows) - 1
''If CheckRows(i) Then
''Next i
'
'For Each itmX In ListView.ListItems
'    If itmX.Checked Then
'        itmX.ForeColor = tempL
'        For j = 1 To itmX.ListSubItems.Count
'            itmX.ListSubItems(j).ForeColor = tempL
'        Next j
'    End If
'Next
'
'Else '
'
'For Each itmX In ListView.ListItems
'    If itmX.Selected Then
'        itmX.ForeColor = tempL
'        For j = 1 To itmX.ListSubItems.Count
'            itmX.ListSubItems(j).ForeColor = tempL
'        Next j
'    End If
'Next
'
'End If
'
'ListView.Refresh '   
'
'End Sub


Private Sub mnuSaveFace_Click()
',    

Dim tmp As String

On Error Resume Next

If Not (rs Is Nothing) Then
    tmp = CheckNoNullVal(dbMovieNameInd)
    ReplaceFNStr tmp
End If
Call SavePicFromBase(1, "FrontFace", tmp)  ' 

End Sub

Private Sub mnuSaveFoto_Click()
'  ,   ,
'    ?

Dim tmp As String

On Error Resume Next

If Not (ars Is Nothing) Then
    If Not IsNull(ars("Name")) Then tmp = ars("Name") Else tmp = vbNullString
    ReplaceFNStr tmp
End If

SavePicFromPic PicActFoto, FrmMain.hWnd, tmp

End Sub

Private Sub mnuSelectAllLV_Click()
' 
If ListView.ListItems.Count < 1 Then Exit Sub
'Dim SelIt As Boolean
Dim Itm As MSComctlLib.ListItem

For Each Itm In ListView.ListItems
'If Itm.Index = CurSearch Then
'    If Itm.Selected Then
'        SelIt = False
'    Else
'        SelIt = True
'    End If
'End If

    Itm.Selected = True
Next

ListView.ListItems(CurSearch).Selected = True
'ListView.ListItems(CurSearch).Selected = SelIt

LVCLICK
End Sub

Private Sub mnuShowThisActer_Click()
'ToActFromLV ,  CurAct   sub MenuActSelect
'  
On Error Resume Next
DoEvents
'Set LVActer.SelectedItem = LVActer.ListItems(CurAct)
Set LVActer.SelectedItem = LVActer.ListItems(ToActFromLV)

TextSearchLVActTypeHid = sPerson 'LVActer.ListItems(LVActer.SelectedItem.Index)

VerticalMenu_MenuItemClick 5, 0
End Sub

Private Sub mnuSortChecked_Click()
If CheckCount = 0 Then Exit Sub

Dim ColHead As MSComctlLib.ColumnHeader

'sort
LVSortColl = -1
'LVSortChecked = True 'SortByCheck 0
'LVSortOrder

ComNext.Enabled = True

LVSortOrder = ListView.SortOrder

LockWindowUpdate ListView.hWnd

For Each ColHead In ListView.ColumnHeaders
If right$(ColHead.Text, 2) = " >" Or right$(ColHead.Text, 2) = " <" Then ColHead.Text = left$(ColHead.Text, Len(ColHead.Text) - 2)
Next

SortByCheck 0

LockWindowUpdate 0

End Sub

Private Sub movie_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)
' ,   
If m_cAVI Is Nothing Then Exit Sub ' 

'pRenderFrame 1
'PosScroll

'pRenderFrame Position.Value 'astRendedAVI ' ,    
'Position.Refresh

If OpenAddmovFlag Then
    If Button = 2 Then
    Me.PopupMenu Me.popMovieHid
    Else

    Set PicTempHid(0) = Nothing: Set PicTempHid(1) = Nothing
    PicTempHid(0).Width = ScaleX(AviWidth, vbPixels, vbTwips)
    PicTempHid(0).Height = ScaleY(AviHeight, vbPixels, vbTwips)

        If Position.Value = 0 Then Position.Value = 1
        m_cAVI.DrawFrame PicTempHid(0).hdc, Position.Value  ', 0, 0, Transparent:=False
        Call ShowInShowPic(0)
    End If ' buttons
End If 'ActFlag    

If Not frmAutoFlag Then Me.SetFocus
End Sub

Private Sub PicActFoto_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)

PicActFoto.Picture = PicActFoto.Image

If Not NoPicActFlag Then
    If Button = 2 Then Me.PopupMenu Me.popActHid
End If

End Sub



Public Sub PicActFotoScroll_Resize()
Dim lHeight As Long
Dim lWidth As Long
Dim lProportion As Long
On Error Resume Next

If Me.Visible Then
If Not FrameActer.Visible Then Exit Sub


   lHeight = (PicActFoto.Height - PicActFotoScroll.ScaleHeight) \ Screen.TwipsPerPixelY
   If (lHeight > 0) Then
      lProportion = lHeight \ (PicActFotoScroll.ScaleHeight \ Screen.TwipsPerPixelY) + 1
      ma_cScroll.LargeChange(efsVertical) = lHeight \ lProportion
      ma_cScroll.Max(efsVertical) = lHeight
      ma_cScroll.Visible(efsVertical) = True
   Else
      ma_cScroll.Visible(efsVertical) = False
      PicActFoto.top = 0
   End If
   
   lWidth = (PicActFoto.Width - PicActFotoScroll.ScaleWidth) \ Screen.TwipsPerPixelX
   If (lWidth > 0) Then
      lProportion = lWidth \ (PicActFotoScroll.ScaleWidth \ Screen.TwipsPerPixelX) + 1
      ma_cScroll.LargeChange(efsHorizontal) = lWidth \ lProportion
      ma_cScroll.Max(efsHorizontal) = lWidth
      ma_cScroll.Visible(efsHorizontal) = True
   Else
      ma_cScroll.Visible(efsHorizontal) = False
      PicActFoto.left = 0
   End If

End If
End Sub



Private Sub PicCoverPaper_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)
If MeForeGround Then PicCoverPaper.SetFocus

DragCover = False
PicCoverTextWnd.BorderStyle = 0
PicCoverTextWnd.MousePointer = vbNormal

End Sub

Private Sub PicCoverTextWnd_LostFocus()
PicCoverTextWnd.BorderStyle = 0
End Sub

Private Sub PicCoverTextWnd_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)
If PicCoverTextWnd.MousePointer = 7 Or PicCoverTextWnd.MousePointer = 9 Then
    DragCover = True
Else
    DragCover = False
End If
Exit Sub

'Select Case TabStripCover.SelectedItem.Index
'Case 1, 2, 3
'If (0 <= y) And (y < 3) Then
'    PicCoverTextWnd.MousePointer = 7
'    PicCoverTextWnd.BorderStyle = 1
'    DragCover = True
'Else
'    PicCoverTextWnd.MousePointer = vbNormal
'    PicCoverTextWnd.BorderStyle = 0
'    DragCover = False
'End If
'
'Case 4
If (0 <= y) And (y < 3) Then
    PicCoverTextWnd.MousePointer = 7
    PicCoverTextWnd.BorderStyle = 1
    CoverMoveDirection = 1
    DragCover = True
ElseIf (PicCoverTextWnd.Height - 3 <= y) And (y <= PicCoverTextWnd.Height) Then
    PicCoverTextWnd.MousePointer = 7
    PicCoverTextWnd.BorderStyle = 1
    CoverMoveDirection = 2
    DragCover = True
ElseIf (0 <= x) And (x < 3) Then
    PicCoverTextWnd.MousePointer = 9
    PicCoverTextWnd.BorderStyle = 1
    CoverMoveDirection = 3
    DragCover = True
ElseIf (PicCoverTextWnd.Width - 3 < x) And (x <= PicCoverTextWnd.Width) Then
    PicCoverTextWnd.MousePointer = 9
    PicCoverTextWnd.BorderStyle = 1
    CoverMoveDirection = 4
    DragCover = True
Else
    PicCoverTextWnd.MousePointer = vbNormal
    PicCoverTextWnd.BorderStyle = 1
    DragCover = False
End If


'End Select
End Sub

Private Sub PicCoverTextWnd_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)

PicCoverTextWnd.ToolTipText = Int(PicCoverTextWnd.Width) & " x " & Int(PicCoverTextWnd.Height)

If Not DragCover Then
If (0 <= y) And (y < 5) Then
    PicCoverTextWnd.MousePointer = 7
    PicCoverTextWnd.BorderStyle = 1
    CoverMoveDirection = 1
ElseIf (PicCoverTextWnd.Height - 5 <= y) And (y <= PicCoverTextWnd.Height) Then
    PicCoverTextWnd.MousePointer = 7
    PicCoverTextWnd.BorderStyle = 1
    CoverMoveDirection = 2
ElseIf (0 <= x) And (x < 5) Then
    PicCoverTextWnd.MousePointer = 9
    PicCoverTextWnd.BorderStyle = 1
    CoverMoveDirection = 3
ElseIf (PicCoverTextWnd.Width - 5 < x) And (x <= PicCoverTextWnd.Width) Then
    PicCoverTextWnd.MousePointer = 9
    PicCoverTextWnd.BorderStyle = 1
    CoverMoveDirection = 4
Else
    PicCoverTextWnd.MousePointer = vbNormal
    PicCoverTextWnd.BorderStyle = 1
End If

End If

On Error Resume Next
'Debug.Print PicCoverTextWnd.Top, PicCoverTextWnd.Height

If DragCover Then
'wndHPix = ScaleY(PicCoverTextWnd.Height, 6, 3)
'wndWPix = ScaleX(PicCoverTextWnd.Width, 6, 3)

    Select Case TabStripCover.SelectedItem.Index
    Case 1 'stand
        Select Case CoverMoveDirection
        Case 1 'up
            'Debug.Print PicCoverTextWnd.Top ', PicCoverTextWnd.Height '
            'if up and down
            If (PicCoverTextWnd.top + y > 145) And (PicCoverTextWnd.Height - y > 9) Then
             PicCoverTextWnd.Move PicCoverTextWnd.left, PicCoverTextWnd.top + y, PicCoverTextWnd.Width, PicCoverTextWnd.Height - y
            End If
        Case 2 'down
            '     y
            'Debug.Print PicCoverTextWnd.Top + y
            If (PicCoverTextWnd.top + y < 262) And (PicCoverTextWnd.Height + y > 19) Then
             PicCoverTextWnd.Move PicCoverTextWnd.left, PicCoverTextWnd.top, PicCoverTextWnd.Width, y
            End If

        Case 3 ' left
            If (PicCoverTextWnd.left + x >= 35.4) And ((PicCoverTextWnd.Width - x) >= 15) Then
             'Debug.Print PicCoverTextWnd.Left + x
             PicCoverTextWnd.Move PicCoverTextWnd.left + x, PicCoverTextWnd.top, PicCoverTextWnd.Width - x, PicCoverTextWnd.Height
            End If

        Case 4 'right
            'Debug.Print PicCoverTextWnd.Left + x
            If (PicCoverTextWnd.left + x < 171.5) And (PicCoverTextWnd.Width + x > 30) Then
             PicCoverTextWnd.Move PicCoverTextWnd.left, PicCoverTextWnd.top, x, PicCoverTextWnd.Height
            End If

        End Select

    Case 2 'convert
        Select Case CoverMoveDirection
        Case 1 'up
            'Debug.Print PicCoverTextWnd.Top + y, PicCoverTextWnd.Height - y
            'if up and down
            If (PicCoverTextWnd.top + y > 25) And (PicCoverTextWnd.Height - y > 9) Then
             PicCoverTextWnd.Move PicCoverTextWnd.left, PicCoverTextWnd.top + y, PicCoverTextWnd.Width, PicCoverTextWnd.Height - y
            End If
        Case 2 'down
            '     y
            'Debug.Print PicCoverTextWnd.Top + y, PicCoverTextWnd.Height + y
            If (PicCoverTextWnd.top + y < 144) And (PicCoverTextWnd.Height + y > 19) Then
             PicCoverTextWnd.Move PicCoverTextWnd.left, PicCoverTextWnd.top, PicCoverTextWnd.Width, y
            End If

        Case 3 ' left
            'Debug.Print PicCoverTextWnd.Left + x
            If (PicCoverTextWnd.left + x > 35.4) And ((PicCoverTextWnd.Width - x) >= 15) Then
             PicCoverTextWnd.Move PicCoverTextWnd.left + x, PicCoverTextWnd.top, PicCoverTextWnd.Width - x, PicCoverTextWnd.Height
            End If

        Case 4 'right
            'Debug.Print PicCoverTextWnd.Left + x
            If (PicCoverTextWnd.left + x < 154.5) And (PicCoverTextWnd.Width + x > 30) Then
             PicCoverTextWnd.Move PicCoverTextWnd.left, PicCoverTextWnd.top, x, PicCoverTextWnd.Height
            End If

        End Select
        
    Case 3 'dvd
        Select Case CoverMoveDirection
        Case 1 'up
            'Debug.Print PicCoverTextWnd.Top + y, PicCoverTextWnd.Height - y
            'if up and down
            If (PicCoverTextWnd.top + y > 15.5) And (PicCoverTextWnd.Height - y > 9) Then
             PicCoverTextWnd.Move PicCoverTextWnd.left, PicCoverTextWnd.top + y, PicCoverTextWnd.Width, PicCoverTextWnd.Height - y
            End If
        Case 2 'down
            '     y
            'Debug.Print PicCoverTextWnd.Top + y, PicCoverTextWnd.Height + y
            If (PicCoverTextWnd.top + y < 195) And (PicCoverTextWnd.Height + y > 19) Then
             PicCoverTextWnd.Move PicCoverTextWnd.left, PicCoverTextWnd.top, PicCoverTextWnd.Width, y
            End If

        Case 3 ' left
            'Debug.Print PicCoverTextWnd.Left + x
            If (PicCoverTextWnd.left + x > 10.5) And ((PicCoverTextWnd.Width - x) >= 15) Then
             PicCoverTextWnd.Move PicCoverTextWnd.left + x, PicCoverTextWnd.top, PicCoverTextWnd.Width - x, PicCoverTextWnd.Height
            End If

        Case 4 'right
            'Debug.Print PicCoverTextWnd.Left + x
            If (PicCoverTextWnd.left + x < 139.5) And (PicCoverTextWnd.Width + x > 30) Then
             PicCoverTextWnd.Move PicCoverTextWnd.left, PicCoverTextWnd.top, x, PicCoverTextWnd.Height
            End If

        End Select
        
    Case 4 'list
        Select Case CoverMoveDirection
        Case 1 'up
            'Debug.Print PicCoverTextWnd.Top + y, PicCoverTextWnd.Height - y
            'if up and down
            If (PicCoverTextWnd.top + y > 8) And (PicCoverTextWnd.Height - y > 9) Then
             PicCoverTextWnd.Move PicCoverTextWnd.left, PicCoverTextWnd.top + y, PicCoverTextWnd.Width, PicCoverTextWnd.Height - y
            End If
        Case 2 'down
            '     y
            'Debug.Print PicCoverTextWnd.Top + y, PicCoverTextWnd.Height + y
            If (PicCoverTextWnd.top + y < 285) And (PicCoverTextWnd.Height + y > 19) Then
             PicCoverTextWnd.Move PicCoverTextWnd.left, PicCoverTextWnd.top, PicCoverTextWnd.Width, y
            End If

        Case 3 ' left
            'Debug.Print PicCoverTextWnd.Left + x
            If (PicCoverTextWnd.left + x > 5) And ((PicCoverTextWnd.Width - x) >= 15) Then
             PicCoverTextWnd.Move PicCoverTextWnd.left + x, PicCoverTextWnd.top, PicCoverTextWnd.Width - x, PicCoverTextWnd.Height
            End If

        Case 4 'right
            'Debug.Print PicCoverTextWnd.Left + x
            If (PicCoverTextWnd.left + x < 205) And (PicCoverTextWnd.Width + x > 30) Then
             PicCoverTextWnd.Move PicCoverTextWnd.left, PicCoverTextWnd.top, x, PicCoverTextWnd.Height
            End If

        End Select
    
    End Select
End If

End Sub


Private Sub PicCoverTextWnd_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)
PicCoverTextWnd.MousePointer = vbNormal
DragCover = False
'PicCoverTextWnd.Line (0, 0)-(PicCoverTextWnd.Width, PicCoverTextWnd.Height), CoverHorBackColor, BF
Select Case TabStripCover.SelectedItem.Index
Case 1
'
cov_stan.l = PicCoverTextWnd.left
cov_stan.t = PicCoverTextWnd.top
cov_stan.w = PicCoverTextWnd.Width
cov_stan.H = PicCoverTextWnd.Height

    Call ShowCoverStandard
Case 2
'
cov_conv.l = PicCoverTextWnd.left
cov_conv.t = PicCoverTextWnd.top
cov_conv.w = PicCoverTextWnd.Width
cov_conv.H = PicCoverTextWnd.Height
    
    Call ShowCoverConvert
Case 3
'
cov_dvd.l = PicCoverTextWnd.left
cov_dvd.t = PicCoverTextWnd.top
cov_dvd.w = PicCoverTextWnd.Width
cov_dvd.H = PicCoverTextWnd.Height
    
    Call ShowCoverDVD
Case 4
'
cov_list.l = PicCoverTextWnd.left
cov_list.t = PicCoverTextWnd.top
cov_list.w = PicCoverTextWnd.Width
cov_list.H = PicCoverTextWnd.Height
    
    Call ShowCoverSpisok
End Select
End Sub


Private Sub PicFaceV_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)
Dim tOld As Boolean

If NoPicFrontFaceFlag Then Exit Sub
If NoDBFlag Then Exit Sub
If Button = 2 Then Me.PopupMenu Me.popFaceHid: Exit Sub

tOld = Timer2.Enabled
Timer2.Enabled = False

If Button = 1 Then
    PicTempHid(1).Picture = PicFaceV.Image
    IsCoverShowFlag = True
    ViewScrShotFlag = False
    FormShowPic.Visible = False

    '  
     'FormShowPic.hb_cScroll.Visible(efsHorizontal) = False
     FormShowPic.PicHB.Visible = False
     
PicManualFlag = True

   ShowInShowPic 1
   
    FormShowPic.Visible = True

End If 'but 1

Timer2.Enabled = tOld
End Sub


Private Function MeForeGround() As Boolean
If GetForegroundWindow = Me.hWnd Then MeForeGround = True
End Function


Private Sub PicPrintScroll_Resize()
Dim lHeight As Long
Dim lWidth As Long
Dim lProportion As Long
On Error Resume Next

If Not FrameCover.Visible Then Exit Sub

   lHeight = (PicCoverPaper.Height - PicPrintScroll.ScaleHeight) \ Screen.TwipsPerPixelY
   If (lHeight > 0) Then
      lProportion = lHeight \ (PicPrintScroll.ScaleHeight \ Screen.TwipsPerPixelY) + 1
      map_cScroll.LargeChange(efsVertical) = lHeight \ lProportion
      map_cScroll.Max(efsVertical) = lHeight
    'map_cScroll.Value(efsVertical) = 0 'map_cScroll.Value(efsVertical) ' + 1
      map_cScroll.Visible(efsVertical) = True
      
   Else
   map_cScroll.Value(efsVertical) = 0
      map_cScroll.Visible(efsVertical) = False
      PicCoverPaper.top = 0
   End If
   
   lWidth = (PicCoverPaper.Width - PicPrintScroll.ScaleWidth) \ Screen.TwipsPerPixelX
   If (lWidth > 0) Then
      lProportion = lWidth \ (PicPrintScroll.ScaleWidth \ Screen.TwipsPerPixelX) + 1
      map_cScroll.LargeChange(efsHorizontal) = lWidth \ lProportion
      map_cScroll.Max(efsHorizontal) = lWidth
    ' map_cScroll.Value(efsHorizontal) = 0 'map_cScroll.Value(efsHorizontal) ' + 1
      map_cScroll.Visible(efsHorizontal) = True
   Else
   map_cScroll.Value(efsHorizontal) = 0
      map_cScroll.Visible(efsHorizontal) = False
      PicCoverPaper.left = 0
   End If

End Sub

Private Sub PicSS1_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)
Set PicTempHid(0) = Nothing
If Button = 1 Then
    If PicSS1.Picture <> 0 Then

        IsCoverShowFlag = False
        ViewScrShotFlag = True

        If PicSS1Big.Picture <> 0 Then
            PicTempHid(0).Picture = PicSS1Big.Picture
        Else
            If GetPic(PicTempHid(0), 1, "SnapShot1") Then PicTempHid(0).Picture = PicTempHid(0).Image: PicSS1Big.Picture = PicTempHid(0).Image
        End If
    End If
    If PicTempHid(0).Picture <> 0 Then

        FormShowPic.PicHB.Visible = False    ' 
        ShowInShowPic 0
        FormShowPic.Visible = True
    End If

End If

If Button = 2 Then

    If OpenAddmovFlag = True Then
        If isAVIflag Then
            Position.Value = pos1: lastRendedAVI = pos1: PosScroll
        End If
        If isMPGflag Or isDShflag Then
            Position.Value = pos1: MPGPosScroll
        End If
            ToDebug "SShot1Goto: " & pos1
    End If
End If


End Sub


Private Sub PicSS2_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)
Set PicTempHid(0) = Nothing
If Button = 1 Then
    If PicSS2.Picture <> 0 Then
        IsCoverShowFlag = False

        If PicSS2Big.Picture <> 0 Then
            PicTempHid(0).Picture = PicSS2Big.Picture
        Else
            If GetPic(PicTempHid(0), 1, "SnapShot2") Then PicTempHid(0).Picture = PicTempHid(0).Image: PicSS2Big.Picture = PicTempHid(0).Image
        End If
    End If
    If PicTempHid(0).Picture <> 0 Then

        FormShowPic.PicHB.Visible = False    ' 
        ShowInShowPic 0
        FormShowPic.Visible = True
    End If

End If

If Button = 2 Then
    If OpenAddmovFlag = True Then
        If isAVIflag Then
            Position.Value = pos2: lastRendedAVI = pos2: PosScroll
        End If
        If isMPGflag Or isDShflag Then
            Position.Value = pos2: MPGPosScroll
        End If
            ToDebug "SShot2Goto: " & pos2
    End If
End If

End Sub


Private Sub PicSS3_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)
Set PicTempHid(0) = Nothing
If Button = 1 Then
    If PicSS3.Picture <> 0 Then
        IsCoverShowFlag = False

        If PicSS3Big.Picture <> 0 Then
            PicTempHid(0).Picture = PicSS3Big.Picture
        Else
            If GetPic(PicTempHid(0), 1, "SnapShot3") Then PicTempHid(0).Picture = PicTempHid(0).Image: PicSS3Big.Picture = PicTempHid(0).Image
        End If
    End If
    If PicTempHid(0).Picture <> 0 Then

        FormShowPic.PicHB.Visible = False    ' 
        ShowInShowPic 0
        FormShowPic.Visible = True
    End If

End If

If Button = 2 Then
    If OpenAddmovFlag = True Then
        If isAVIflag Then
            Position.Value = pos3: lastRendedAVI = pos3: PosScroll
        End If
        If isMPGflag Or isDShflag Then
            Position.Value = pos3: MPGPosScroll
        End If
            ToDebug "SShot3Goto: " & pos3
    End If
End If

End Sub


Private Sub Position_KeyUp(KeyCode As Integer, Shift As Integer)
'Debug.Print KeyCode
Select Case KeyCode
Case 37, 38, 39, 40
If isAVIflag Then PosScroll: lastRendedAVI = Position.Value
If isMPGflag Or isDShflag Then MPGPosScroll: lastRendedMPG = Position.Value
End Select
End Sub
Private Sub MPGPosScroll()

'Dim objPosition As IMediaPosition
'Dim objBasicVideo As IBasicVideo
'objBasicVideo.AvgTimePerFrame

'   On Error Resume Next
'    Set objPosition = mobjManager
'    Set objBasicVideo = mobjManager
'mobjManager.Stop
'Debug.Print (Position.Value - 1) / 1000
'mobjManager.StopWhenReady
'mobjManager.Pause

Dim temp As Long
'MPGPosScroll = True
'MPGPosScrollFlag = True

On Error Resume Next
temp = Position.Value + Range

If temp <= PPMin Then
    PPMin = Position.Value - Range
    If PPMin < 0 Then PPMin = 0
    PositionP.min = PPMin
    PPMax = Position.Value + Range
    If PPMax > TimesX100 Then PPMax = TimesX100
    PositionP.Max = PPMax
Else
    PPMax = Position.Value + Range
    If PPMax > TimesX100 Then PPMax = TimesX100
    PositionP.Max = PPMax
    PPMin = Position.Value - Range
    If PPMin < 0 Then PPMin = 0
    PositionP.min = PPMin
End If

PositionP.Value = Position.Value  'PositionP.Min

If Position.Value = Position.Max Then PositionP.Value = PositionP.Max

'Screen.MousePointer = vbHourglass

If Position.Value = 1 Then
    objPosition.CurrentPosition = 0     '(Position.Value - 1) / 1000 + 0.04
    'mobjManager.Pause
Else
    objPosition.CurrentPosition = Position.Value / 100     '(Position.Value - 1) / 1000 + 0.04
    'Debug.Print objPosition.CurrentPosition
    'movie.Refresh
    'objPosition.CurrentPosition = CLng(Position.Value / 100)
    'mobjManager.Pause
End If

Screen.MousePointer = vbNormal
End Sub
Private Sub PosScroll()
Dim temp As Long

On Error Resume Next

temp = Position.Value + 1000

If temp <= PPMin Then
    PPMin = Position.Value - 1000
    If PPMin < 0 Then PPMin = 0
    PositionP.min = PPMin
    PPMax = Position.Value + 1000
    If PPMax > Frames Then PPMax = Frames
    PositionP.Max = PPMax
Else
    PPMax = Position.Value + 1000
    If PPMax > Frames Then PPMax = Frames - 1
    PositionP.Max = PPMax
    PPMin = Position.Value - 1000
    If PPMin < 0 Then PPMin = 0
    PositionP.min = PPMin
End If

    'If Position.Value > 1000 Then
    ' PositionP.Value = Position.Value 'PositionP.Min + 1000
    'Else
PositionP.Value = Position.Value  'PositionP.Min
    'End If

    Screen.MousePointer = vbHourglass
    If Position.Value = 0 Then
        pRenderFrame 1
    Else
       pRenderFrame CDbl(Position.Value)
    End If
    
Screen.MousePointer = vbNormal
End Sub

Private Sub Position_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)
If isAVIflag Then PosScroll: lastRendedAVI = Position.Value
If isMPGflag Or isDShflag Then MPGPosScroll: lastRendedMPG = Position.Value
End Sub

Private Sub Position_Scroll()
'Position.Value = Position.Value
'Position.Text = "-"
If isAVIflag Then
If lastRendedAVI = Position.Value Then Exit Sub
If ChLockFSHid(0) Then pRenderFrame Position.Value
lastRendedAVI = Position.Value
End If

If isMPGflag Or isDShflag Then
If lastRendedMPG = Position.Value Then Exit Sub
    If ChLockFSHid(0) Then
    
    MPGPosScroll
    '    objPosition.CurrentPosition = Position.Value / 100
    lastRendedMPG = Position.Value
    mobjManager.Pause
    End If
End If

'Debug.Print "scroll"
End Sub

Private Sub PositionP_KeyUp(KeyCode As Integer, Shift As Integer)

Select Case KeyCode
Case 37, 38, 39, 40 '

Position.Value = PositionP.Value

If isAVIflag Then
pRenderFrame Position.Value 'PosScroll
lastRendedAVI = Position.Value
End If

If isMPGflag Or isDShflag Then 'MPGPosScroll
        objPosition.CurrentPosition = Position.Value / 100
        lastRendedMPG = Position.Value
'Debug.Print objPosition.CurrentPosition
        'mobjManager.Pause
End If

End Select
End Sub

Private Sub PositionP_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)
On Error Resume Next 'VTS_01_0.VOB
Position.Value = PositionP.Value

If isAVIflag Then pRenderFrame Position.Value: lastRendedAVI = Position.Value

If isMPGflag Or isDShflag Then 'MPGPosScroll
Screen.MousePointer = vbHourglass
        objPosition.CurrentPosition = Position.Value / 100
Screen.MousePointer = vbNormal
lastRendedMPG = Position.Value
'        mobjManager.Pause
'Debug.Print objPosition.CurrentPosition
End If

'pRenderFrame Position.Value
End Sub

Private Sub PositionP_Scroll()
On Error Resume Next '    (VTS_01_0.VOB)
Position.Value = PositionP.Value

If isAVIflag Then
If lastRendedAVI = Position.Value Then Exit Sub
If ChLockFSHid(1) Then pRenderFrame Position.Value
End If

If isMPGflag Or isDShflag Then 'MPGPosScroll
If lastRendedMPG = Position.Value Then Exit Sub
    If ChLockFSHid(1) Then
    Screen.MousePointer = vbHourglass
      objPosition.CurrentPosition = Position.Value / 100
        mobjManager.Pause
    Screen.MousePointer = vbNormal
'Debug.Print temp, objPosition.CurrentPosition
    End If
End If

End Sub

Private Sub TabLVHid_Click()
'  
Dim reclick As Boolean


'         
If frmOptFlag Then If FrmOptions.Visible Then Exit Sub

If oldTabLVInd = TabLVHid.SelectedItem.Index Then
 NoSetColorFlag = True
 reclick = True
 If InitFlag Then reclick = False
Else
 'oldTabLVInd = TabLVHid.SelectedItem.Index - ,   
 FirstLVFill = True
 NoSetColorFlag = False

 If ListView.ListItems.Count > 0 Then
  LastInd = FrmMain.ListView.SelectedItem.SubItems(lvIndexPole)
  WriteKey "LIST", "LastItem", str$(LastInd), iniFileName
 End If
 If LVActer.ListItems.Count > 0 Then
    WriteKey "LIST", "LastItemAct", CStr(Val(CurActKey)), iniFileName
 End If
End If

bdname = LstBases_List(TabLVHid.SelectedItem.Index)
CurrentBaseIndex = TabLVHid.SelectedItem.Index
LstBases_ListIndex = CurrentBaseIndex - 1

If Not reclick Then
 Timer2.Enabled = False
 
 '  
 Unload frmSR '   
 
 ToDebug " " & bdname

GroupedFlag = False: FilteredFlag = False '  

 Set rs = Nothing: Set DB = Nothing
' ReDim CheckRows(0): ReDim SelRows(0): ReDim lvItemLoaded(0)
' ReDim CheckRowsKey(0): ReDim SelRowsKey(0)
 
 
 Image0.Cls
'     'nopic
'    Image0.Move 0, 0, FrameImageHid.Width, FrameImageHid.Height
'    If ImageList.ListImages.Count >= 3 Then
'    Image0.PaintPicture ImageList.ListImages(LastImageListInd).Picture, 0, 0, Image0.Width, Image0.Height
'    End If
 ' ,    
 If Not frmOptFlag Then
  If Opt_AutoSaveOpt Then SaveInterface
 End If

 
 '                                                 OpenDB
 
'   - ListView.Visible = false    
Call NoListClear
     
 If Not OpenDB Then
  'LockWindowUpdate 0
  ListView.Visible = True
  InitFlag = True '
  If oldTabLVInd > 0 Then '     = 0
    TabLVHid.Tabs(oldTabLVInd).Selected = True
  End If
  Exit Sub
 End If
 
 ComDel.Enabled = True

 If (oldTabLVInd <> TabLVHid.SelectedItem.Index) Or optReadIniFlag Then
  '  
  ReadINI GetNameFromPathAndName(bdname)
  NoSetColorFlag = False
  
  ToDebug "  SortOnStart=" & Opt_SortOnStart
  ToDebug "  sortcol=" & LVSortColl
  ToDebug "  CDdrive=" & ComboCDHid_Text
  ToDebug "  QJPG=" & QJPG
  ToDebug "  UseAspect=" & Opt_UseAspect
  ToDebug "  LoanAllSameLabels=" & Opt_LoanAllSameLabels
  ToDebug "  LoadOnlyTitle=" & Opt_LoadOnlyTitles
  ToDebug "  FreeDVDFilters=" & Opt_UseOurMpegFilters
  ToDebug "  SaveBigPix=" & Opt_PicRealRes
  ToDebug "  UseProxy=" & Opt_InetUseProxy
  ToDebug "  DS_AVI=" & Opt_AviDirectShow
  ToDebug "  GetVolumeInfo=" & Opt_GetVolumeInfo
  ToDebug "  GetMediaType=" & Opt_GetMediaType
  ToDebug "  InetGetPicUseTempFile=" & Opt_InetGetPicUseTempFile
 End If
 
 oldTabLVInd = TabLVHid.SelectedItem.Index
 If rs.RecordCount > 0 Then rs.MoveFirst: rs.MoveLast

 'LockWindowUpdate 0 'ListView.Visible = True ': UCLV.Visible = True
 Screen.MousePointer = vbHourglass '  FillListView
 '                                               
 setForeColor
 '                                               
 FillListView
 '                                               
         If Len(TextItemHid.Text) = 0 Then
            If CheckCount > 0 Then
                TextItemHid.Text = NamesStore(2) & Chr$(32) & CheckCount
            Else
                TextItemHid.Text = vbNullString
            End If
        End If

 'If Opt_Group_Vis Then FillTVGroup ' 
 If Opt_Group_Vis Then mGroup_Click 0 '
 
 If Not (ListView.SelectedItem Is Nothing) Then
    'ListView.SelectedItem.EnsureVisible
    LV_EnsureVisible ListView, ListView.SelectedItem.Index
 End If
 
 '  
If BaseReadOnly Or BaseReadOnlyU Then
myMsgBox msgsvc(24), vbInformation, , Me.hWnd
End If

 InitFlag = False
End If ' not reclick


FrameView.Caption = FrameViewCaption & " " & ListView.ListItems.Count & " )"
FrmMain.ComFilter.BackColor = &HFFFFFF
End Sub

Private Sub TabLVHid_OLEDragDrop(Data As MSComctlLib.DataObject, Effect As Long, Button As Integer, Shift As Integer, x As Single, y As Single)
'If UBound(SelRows) > 1 Then Effect = vbNoDrop: Exit Sub
If myMsgBox(msgsvc(31), vbOKCancel, , Me.hWnd) = vbOK Then
    'MouseOverTabLV   TabLVHid_OLEDragOver
    Call LVDragDropSingle(ListView, x, y)
End If
End Sub



Private Sub TabLVHid_OLEDragOver(Data As MSComctlLib.DataObject, Effect As Long, Button As Integer, Shift As Integer, x As Single, y As Single, State As Integer)
Dim i As Integer
For i = 1 To TabLVHid.Tabs.Count
If x > TabLVHid.Tabs.Item(i).left And x < TabLVHid.Tabs.Item(i).Width + TabLVHid.Tabs.Item(i).left Then
MouseOverTabLV = i
End If
Next
If TabLVHid.SelectedItem.Index = MouseOverTabLV Then Effect = vbNoDrop

End Sub

Private Sub TabStrAdEd_Click()
'On Error Resume Next

Select Case TabStrAdEd.SelectedItem.Index

Case 2  ' 
    FrAdEdTextHid.Visible = True
    FrAdEdTextHid.ZOrder 0
    FrAdEdPixHid.Visible = False
    FrAdEdTechHid.Visible = False

    ImgPrCov.Picture = PicFrontFace.Picture
    FrImgPrCov.ZOrder 0

Case 1  '
    FrAdEdPixHid.Visible = True
    FrAdEdPixHid.ZOrder 0
    FrAdEdTextHid.Visible = False
    FrAdEdTechHid.Visible = False

    FrImgPrCov.ZOrder 1
    
Case 3  '
    FrAdEdTechHid.Visible = True
    FrAdEdTechHid.ZOrder 0
    FrAdEdTextHid.Visible = False
    FrAdEdPixHid.Visible = False

    ImgPrCov.Picture = PicFrontFace.Picture
    FrImgPrCov.ZOrder 0

End Select

'  
If addflag Then
    If TextCDN.Visible Then TextCDN.SetFocus
    If TextMName.Visible Then TextMName.SetFocus: TextMName.SelLength = 0
End If

ComOpen.ZOrder 0
ComAdd.ZOrder 0
ComDel.ZOrder 0
ComSaveRec.ZOrder 0
ComCancel.ZOrder 0
'movie.ZOrder 0   ,  
End Sub

Public Sub TabStripCover_Click()

'  
'If oldTabStripCoverInd = TabStripCover.SelectedItem.Index Then Exit Sub '

PicCoverTextWnd.Visible = False
    If CheckCount > 0 Then
        ChPrintChecked.Enabled = True
        chPrnAllOne.Enabled = True
    Else
        ChPrintChecked.Enabled = False
        'chPrnAllOne.Enabled = False ': chPrnAllOne.Value = vbUnchecked
        
    End If
ChPrintChecked.Value = ChPrintCheckedFlag

Select Case TabStripCover.SelectedItem.Index

Case 1 'cd
'  -
PicCoverTextWnd.Move cov_stan.l, cov_stan.t, cov_stan.w, cov_stan.H
'ToDebug "... Standart Case"
Call ShowCoverStandard

Case 2 '
PicCoverTextWnd.Move cov_conv.l, cov_conv.t, cov_conv.w, cov_conv.H
'ToDebug "... Convert"
Call ShowCoverConvert

Case 3 'dvd
PicCoverTextWnd.Move cov_dvd.l, cov_dvd.t, cov_dvd.w, cov_dvd.H
'ToDebug "... DVD"
Call ShowCoverDVD

Case 4 '
PicCoverTextWnd.Move cov_list.l, cov_list.t, cov_list.w, cov_list.H
'ToDebug "... List"

ChPrintCheckedFlag = ChPrintChecked.Value
ChPrintChecked.Value = 0: ChPrintChecked.Enabled = False

Call ShowCoverSpisok

End Select

oldTabStripCoverInd = TabStripCover.SelectedItem.Index
End Sub

Private Sub TextActBio_KeyDown(KeyCode As Integer, Shift As Integer)
If Not ActFlag Then KeyCode = 0
End Sub

Private Sub TextActBio_KeyPress(KeyAscii As Integer)
'If Not ActFlag Then KeyAscii = 0
End Sub

Private Sub TextActName_KeyDown(KeyCode As Integer, Shift As Integer)
'If Not ActFlag Then KeyCode = 0
If KeyCode = 13 Then TextActBio.SetFocus 'TextActName_LostFocus
End Sub

Private Sub TextActName_KeyPress(KeyAscii As Integer)
'If Not ActFlag Then KeyAscii = 0
End Sub

Private Sub TextAnnotation_Change()
Mark2Save
End Sub

Private Sub TextAnnotation_KeyPress(KeyAscii As Integer)
Const ASC_CTRL_A As Integer = 1

    If KeyAscii = ASC_CTRL_A Then
        TextAnnotation.SelStart = 0
        TextAnnotation.SelLength = Len(TextAnnotation.Text)
    End If

End Sub

Private Sub TextAuthor_Change()
Mark2Save
End Sub

Private Sub TextAuthor_KeyDown(KeyCode As Integer, Shift As Integer)
ComboKey KeyCode, Shift
If AutoFill(TextAuthor) Then
Mark2Save
End If
End Sub

Private Sub TextAuthor_LostFocus()
TextAuthor.Text = sTrimChars(TextAuthor.Text, vbNewLine)
End Sub

Private Sub TextCDN_Change()
Mark2Save
End Sub

Private Sub TextCountry_KeyDown(KeyCode As Integer, Shift As Integer)
ComboKey KeyCode, Shift
If AutoFill(TextCountry) Then
Mark2Save
End If
End Sub

Private Sub TextCountry_LostFocus()
TextCountry.Text = sTrimChars(TextCountry.Text, vbNewLine)
End Sub


Private Sub TextCoverURL_Change()
Mark2Save
End Sub

Private Sub TextFilelenHid_Change()
Mark2Save
End Sub

Private Sub TextFileName_Change()
Mark2Save
End Sub

Private Sub TextFind_Change()
ComNext.Enabled = True
End Sub

Private Sub TextFind_KeyDown(KeyCode As Integer, Shift As Integer)
On Error Resume Next
If KeyCode = 13 Then Call ComFind_Click
If CombFind.Text = vbNullString Then CombFind.ListIndex = 0
End Sub

Private Sub TextFPSHid_Change()
Mark2Save
End Sub

Private Sub TextGenre_Change()
Mark2Save
End Sub

Private Sub TextGenre_KeyDown(KeyCode As Integer, Shift As Integer)
ComboKey KeyCode, Shift
If AutoFill(TextGenre) Then
Mark2Save
End If
End Sub

Private Sub TextGenre_KeyPress(KeyAscii As Integer)
'ComboKeyAscii KeyAscii
'If AutoFill(TextGenre) Then
'Mark2Save
'End If
End Sub

Private Sub TextGenre_LostFocus()
TextGenre.Text = sTrimChars(TextGenre.Text, vbNewLine)

End Sub

Private Sub TextItemHid_KeyPress(KeyAscii As Integer)
If KeyAscii = 1 Then 'ctrl+A
    TextItemHid.SelStart = 0: TextItemHid.SelLength = Len(TextItemHid)
End If
End Sub

Private Sub TextItemHid_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)
If Button = vbRightButton Then DisplayTextPopup TextItemHid
End Sub



Private Sub TextItemHid_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)
If Len(TextItemHid.SelText) <> 0 Then sPerson = TextItemHid.SelText
MenuActSelect TextItemHid.SelText
End Sub
Private Sub TextLabel_Change()
Mark2Save
End Sub

Private Sub TextLabel_KeyDown(KeyCode As Integer, Shift As Integer)
ComboKey KeyCode, Shift
If AutoFill(TextLabel) Then
Mark2Save
End If
End Sub

Private Sub TextLabel_LostFocus()
TextLabel.Text = sTrimChars(TextLabel.Text, vbNewLine)
End Sub

Private Sub TextLang_Change()
Mark2Save
End Sub

Private Sub TextLang_Click()
'Mark2Save
End Sub

Private Sub TextLang_KeyDown(KeyCode As Integer, Shift As Integer)
ComboKey KeyCode, Shift
If AutoFill(TextLang) Then
Mark2Save
End If
End Sub

Private Sub TextLang_LostFocus()
TextLang.Text = sTrimChars(TextLang.Text, vbNewLine)
End Sub

Private Sub TextMName_Change()
Mark2Save
ComInetFind.Enabled = True
End Sub

Private Sub TextMName_KeyDown(KeyCode As Integer, Shift As Integer)
ComboKey KeyCode, Shift
If AutoFill(TextMName) Then
Mark2Save
End If
End Sub

Private Sub TextMName_LostFocus()
Mark2SaveFlag = False
TextMName.Text = sTrimChars(TextMName.Text, vbNewLine)
Mark2SaveFlag = True
End Sub

Private Sub TextMovURL_Change()
Mark2Save
End Sub

Private Sub TextOther_Change()
Mark2Save
End Sub

Private Sub TextOther_Click()
'Mark2Save
End Sub

Private Sub TextOther_KeyDown(KeyCode As Integer, Shift As Integer)
ComboKey KeyCode, Shift
If AutoFill(TextOther) Then
Mark2Save
End If
End Sub


Private Sub TextRate_Change()
Mark2Save
End Sub

Private Sub TextRate_KeyDown(KeyCode As Integer, Shift As Integer)
ComboKey KeyCode, Shift
If AutoFill(TextRate) Then
Mark2Save
End If
End Sub

Private Sub TextRate_LostFocus()
TextRate.Text = sTrimChars(TextRate.Text, vbNewLine)
End Sub

Private Sub TextResolHid_Change()
Mark2Save
End Sub

Private Sub TextRole_Change()
Mark2Save
End Sub

Private Sub TextRole_LostFocus()
TextRole.Text = sTrimChars(TextRole.Text, vbNewLine)
End Sub

Private Sub TextSearchLVActTypeHid_Change()
'  
Dim itmX As MSComctlLib.ListItem

    'in view
        For Each itmX In LVActer.ListItems
            If InStr(1, itmX.Text, TextSearchLVActTypeHid.Text, vbTextCompare) <> 0 Then
                Set LVActer.SelectedItem = itmX
                'LVActer.ListItems(itmX.Index).EnsureVisible
                LV_EnsureVisible LVActer, LVActer.SelectedItem.Index
                LVActClick 'itmX
                Exit Sub
            End If
        Next

End Sub

Private Sub TextSearchLVActTypeHid_KeyDown(KeyCode As Integer, Shift As Integer)
Dim nextFlag As Boolean
Dim itmX As MSComctlLib.ListItem

If KeyCode = 13 Then

    For Each itmX In LVActer.ListItems
        If nextFlag Then
            If InStr(1, itmX.Text, TextSearchLVActTypeHid.Text, vbTextCompare) <> 0 Then
                Set LVActer.SelectedItem = itmX
                'LVActer.ListItems(itmX.Index).EnsureVisible
                LV_EnsureVisible LVActer, LVActer.SelectedItem.Index
                LVActClick 'itmX
                Exit Sub
            End If
        End If
        If LVActer.SelectedItem = itmX Then nextFlag = True
    Next

End If        '13
End Sub

Private Sub TextSubt_Change()
Mark2Save
End Sub

Private Sub TextSubt_Click()
'Mark2Save
End Sub

Private Sub TextSubt_KeyDown(KeyCode As Integer, Shift As Integer)
ComboKey KeyCode, Shift
If AutoFill(TextSubt) Then
Mark2Save
End If
End Sub

Private Sub TextSubt_LostFocus()
TextSubt.Text = sTrimChars(TextSubt.Text, vbNewLine)
End Sub

Private Sub TextTimeHid_Change()
Mark2Save
End Sub

Private Sub TextUser_Change()
Mark2Save
End Sub

Private Sub TextUser_KeyDown(KeyCode As Integer, Shift As Integer)
ComboKey KeyCode, Shift
If AutoFill(TextUser) Then
Mark2Save
End If
End Sub

Private Sub TextVAnnot_KeyDown(KeyCode As Integer, Shift As Integer)
If KeyCode = 114 Then ComNext_Click
End Sub


Private Sub TextVAnnot_KeyPress(KeyAscii As Integer)
Select Case KeyAscii

Case 6 '^F
ComFind_Click

End Select
End Sub

Private Sub TextVideoHid_Change()
Mark2Save
End Sub

Private Sub TextYear_Change()
Mark2Save
End Sub

Private Sub TextYear_KeyDown(KeyCode As Integer, Shift As Integer)
ComboKey KeyCode, Shift
If AutoFill(TextYear) Then
Mark2Save
End If
End Sub

Private Sub TextYear_LostFocus()
TextYear.Text = sTrimChars(TextYear.Text, vbNewLine)
End Sub


Public Sub Timer2_Timer()
On Error Resume Next



DoEvents    '  lvadd 

'if meResize then
'Timer2.Enabled = False: Exit Sub

If Opt_NoSlideShow Then Timer2.Enabled = False: Exit Sub

FrameView.Refresh

If FrameView.Visible Then
    Timer2.Enabled = True
Else
    Timer2.Enabled = False
    Exit Sub
End If


If NoPic1Flag And NoPic2Flag And NoPic3Flag Then
    Timer2.Enabled = False
    Image0.Cls
    Image0.Move 0, 0, FrameImageHid.Width, FrameImageHid.Height
    Image0.PaintPicture ImageList.ListImages(LastImageListInd).Picture, 0, 0, Image0.Width, Image0.Height    'nopic
    Exit Sub
End If


Select Case SlideShowFlag

Case 0
        If Not NoPic2Flag Then
            SlideShowFlag = 1
        ElseIf Not NoPic3Flag Then
            SlideShowFlag = 2
        Else
            Timer2.Enabled = False
        End If

    If Not NoPic1Flag Then
        SlideShowLastFlag = 0
        GetPic Image0, 1, "SnapShot1"
    Else
        Timer2_Timer    '  ,   
    End If

Case 1
        If Not NoPic3Flag Then
            SlideShowFlag = 2
        ElseIf Not NoPic1Flag Then
            SlideShowFlag = 0
        Else
            Timer2.Enabled = False
        End If

    If Not NoPic2Flag Then
        SlideShowLastFlag = 1
        GetPic Image0, 1, "SnapShot2"
    Else
        Timer2_Timer
    End If

Case 2
        If Not NoPic1Flag Then
            SlideShowFlag = 0
        ElseIf Not NoPic2Flag Then
            SlideShowFlag = 1
        Else
            Timer2.Enabled = False
        End If
        
    If Not NoPic3Flag Then
        SlideShowLastFlag = 2
        GetPic Image0, 1, "SnapShot3"
    Else
        Timer2_Timer
    End If

End Select

If Abs(NoPic1Flag) + Abs(NoPic2Flag) + Abs(NoPic3Flag) = 2 Then Timer2.Enabled = False

timerflag = True


'Debug.Print Time & " " & SlideShowLastGoodPic

End Sub


Public Sub AddTabsLV()
'   
Dim i As Integer
Dim temp As String, temp2 As String


For i = TabLVHid.Tabs.Count To 1 Step -1
TabLVHid.Tabs.Remove i
Next

If LstBases_ListCount = 0 Then ' 
    InitFlag = True
    Exit Sub
End If

For i = 1 To LstBases_ListCount
temp = GetNameFromPathAndName(LstBases_List(i))
GetExtensionFromFileName temp, temp2
TabLVHid.Tabs.Add i, , temp2
Next


End Sub



Public Sub TVCLICK()
',   
Dim strSQL As String
Dim tmp As String
Dim strLike As String

On Error GoTo errn

If tvGroup.ListItems.Count < 1 Then Exit Sub    '   
If Len(GroupField) = 0 Then Exit Sub

GroupedFlag = True
Timer2.Enabled = False

tmp = tvGroup.ListItems(tvGroup.SelectedItem.Index)

SQLCompatible tmp

'''''''''''''''
'    FillTVGroup
'Case "MovieName", "Label", "Year", "Resolution", "FPS", "CDN", "MediaType", "Audio",
' "Video", "Debtor", "Other", "CoverPath", "MovieURL", "Rating", "FileLen"

If tmp <> "Null" Then ' filltvgroup
    Select Case GroupField
    'Case "MovieName", "Label", "Rating", "FPS", "CDN", "MediaType"     ' = ''
    Case "MovieName", "Label", "Year", "Resolution", "FPS", "CDN", "MediaType", "Audio", "Video", "Debtor", "Other", "CoverPath", "MovieURL", "Rating" ', "FileLen"

        If Len(tmp) = 0 Then
            strLike = "(" & GroupField & " = '')"
        Else
            strLike = "((" & GroupField & " = '" & tmp & "'))"
        End If
    Case "FileLen" ',   
'        If Len(tmp) = 0 Then
'            strLike = "(" & GroupField & " = 0)"
'        Else
            strLike = "((" & GroupField & " = " & tmp & "))"
'        End If
    
    Case Else    'FilterLike
        strLike = FilterLikeString(GroupField, tmp)
    End Select

Else    ' Null
    strLike = "(" & GroupField & " Is Null)"
End If

'strLike = GroupField & _
 " Like ('*[!0-9A-]" & tmp & "[!0-9:A-]*') Or " & GroupField & _
 " Like ('" & tmp & "[!0-9:A-]*') Or " & GroupField & _
 " Like ('*[!0-9A-]" & tmp & "') Or " & GroupField & _
 " Like ('" & tmp & "')"
'If Len(tmp) = 0 Then strLike = GroupField & " = ''"

'strLike = GroupField & " Like ('!*" & tmp & "*')"
'''''''''''''''''''
'tmp = " Like '*" & tmp & "*'"

LastSQLGroupString = strLike
strSQL = "Select * From Storage Where " & LastSQLGroupString

If FilteredFlag And Len(LastSQLFilterString) <> 0 Then
    '   
    strSQL = strSQL & " AND " & LastSQLFilterString
End If
If FiltPersonFlag And Len(LastSQLPersonString) <> 0 Then
    '     
    strSQL = strSQL & " AND " & LastSQLPersonString
End If

'Debug.Print ": " & strSQL

Set rs = DB.OpenRecordset(strSQL)    ', dbOpenSnapshot)

FillListView

Exit Sub

errn:
ToDebug "Err_TVCl"
MsgBox msgsvc(46), vbExclamation

End Sub

Private Sub tPlay_Timer()
On Error Resume Next
Position.Value = objPosition.CurrentPosition * 100
End Sub

Private Sub tvGroup_Click()
DoEvents
TVCLICK
End Sub

Private Sub tvGroup_ColumnClick(ByVal ColumnHeader As MSComctlLib.ColumnHeader)
Select Case ColumnHeader.Index
Case 1
Me.PopupMenu mPopGroup ', DefaultMenu:=mGroup(2)

Case 2 '  

If tvGroup.ListItems.Count < 1 Then Exit Sub
'If tvGroup.ListItems.Item(1).ListSubItems.Count < 1 Then ' -
If Len(tvGroup.ListItems.Item(1).SubItems(1)) = 0 Then


FillTVNums ' 
Exit Sub

End If

tvGroup.SortOrder = (tvGroup.SortOrder + 1) Mod 2
SortByNumber 1, tvGroup
End Select

End Sub

Private Sub tvGroup_KeyUp(KeyCode As Integer, Shift As Integer)
DoEvents
TVCLICK
End Sub

Private Sub tvGroup_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)
If Button = 2 Then

'tvGroup.SortOrder = (tvGroup.SortOrder + 1) Mod 2
'tvGroup.Sorted = True '     

tvGroup.Sorted = True '     

SortByNumber 0, tvGroup
'  .Sorted = True,     ,   -    ( )

tvGroup.Sorted = False '  tvGroup.SortOrder =  
tvGroup.SortOrder = (tvGroup.SortOrder + 1) Mod 2


End If
End Sub

Private Sub tvGroup_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)
' 
On Error Resume Next
If frmSRFlag Then
    If frmSR.Visible Then Exit Sub
End If
If LstFiles.Visible Then Exit Sub
If TextItemHid.SelLength > 0 Then Exit Sub

If GetForegroundWindow = Me.hWnd Then
    If ActiveControl.name <> "tvGroup" Then tvGroup.SetFocus
End If
End Sub

Private Sub TxtIName_KeyDown(KeyCode As Integer, Shift As Integer)
If KeyCode = 13 Then ComInetFind_Click
End Sub

Private Sub UCLV_tActMouseDown(Button As Integer, Shift As Integer, x As Single, y As Single, s As String)
If Button = 2 Then
'   ' Make VB discard the mouse capture.
'    txt.Enabled = False
'    txt.Enabled = True
'    txt.SetFocus

    ' Display the custom menu.
' ?     ActiveControl,  ,   UC?
m7Hid.Visible = False
mnuUndo.Visible = False
mnuCut.Visible = False
mnuCopy.Visible = False
mnuPaste.Visible = False
mnuDelete.Visible = False
m8Hid.Visible = False
mnuSelectAll.Visible = False


If Len(sPerson) = 0 Then mFiltAct.Enabled = False Else mFiltAct.Enabled = True

    PopupMenu mnuTextMenuHid
End If
End Sub

Private Sub UCLV_tActMouseUp(Button As Integer, Shift As Integer, x As Single, y As Single, s As String)
'  s   
If Len(s) <> 0 Then sPerson = s
MenuActSelect s
End Sub

Public Sub VerticalMenu_MenuItemClick(MenuItem As Integer, Shift As Integer)
Dim i As Integer
Dim ret As Integer

ToDebug "MenuItem: " & MenuItem & "/" & Shift

If NoDBFlag Then
    bdname = vbNullString
Else
    ''''''''' 
    If MenuItem = 2 Then
        If LastVMI = 3 Then Exit Sub    '  ,    
'If MultiSel Then Exit Sub    '  ,  
        If frmOptFlag Then Exit Sub    ' ,   
    End If

    If MenuItem = 3 Then
        If frmOptFlag Then Exit Sub    ' ,   
    End If

    If MenuItem <> 3 Then    '3 -  
        If MenuItem = LastVMI Then
            Exit Sub
        End If
    End If

    'If delFlag Then    '       
    '    If Not (MenuItem = 1 Or MenuItem = 8) Then Exit Sub
    'End If

End If
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

If NoDBFlag And MenuItem <> 8 And MenuItem <> 5 And MenuItem <> 6 Then
    ToDebug "SVC    "
    myMsgBox msgsvc(21), vbInformation, , Me.hWnd     '  .
    'ComOpenBD.SetFocus
    GoTo Opt
End If
If NoDBFlag And (MenuItem <> 6) And (MenuItem <> 8) Then MenuItem = 5    ' 

'''''''''''''''''''''''''''''''''''''''''''''''' 
If Shift = 1 Then
    If MenuItem = 3 Then
        If BaseReadOnly Or BaseReadOnlyU Then
            'myMsgBox msgsvc(24), vbInformation, , Me.hwnd
            Exit Sub
        End If
        
        FrmAuto.Show 1, Me
        If LastVMI <> 1 Then VerticalMenu_MenuItemClick 1, 0
        Exit Sub
    End If
End If

'''''''''''''''''''''''''''''''''''''''''''''''''
If MenuItem = 7 Then  '
    ToDebug ""
    FrmStat.Show 0, Me
    Exit Sub
End If

''''''''''''''''''''''''''''''''''''''''''''''''''
If MenuItem = 6 Then
    'optsaved = True '  , false -  
Opt:
    Timer2.Enabled = False
    'ToDebug ""
    If SplashFlag Then Unload frmSplash: Set frmSplash = Nothing
    'If addFlag Or editFlag Then '    ( )
    '    Exit Sub
    'Else
    FrmOptions.Show 0, Me
    'End If
    'PrevVMI = LastVMI
    'LastVMI = 6
    Exit Sub
End If
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

'  , ,  
If ars Is Nothing Then
Else
    If ars.EditMode Then
        'ToDebug "     "
        'TextActName.BackColor = &HC0FFFF: TextActBio.BackColor = &HC0FFFF
        'ActEditFlag = False
        ComActSave.Enabled = False: ComActPast.Enabled = False: ComActFile.Enabled = False: ComActFotoDel.Enabled = False
        'PicActFotoScroll.Visible = False
        ret = myMsgBox(msgsvc(6), vbYesNoCancel, , Me.hWnd)
        If ret = vbNo Then    'no
            ToDebug "-  "
            ComCancelAct_Click
        ElseIf ret = vbYes Then
            ToDebug "- "
            ComActSave_Click
            ActFlag = False
        Else    'cancel
            If ActNewFlag Then ars.CancelUpdate
            ComActEdit_Click
            Exit Sub
        End If    'ret
    End If    'ars.EditMode
End If    'ars is nothing

If rs Is Nothing Then
Else
    '   , ,  
    If rs.EditMode Then
        'ToDebug "     "
        'DoEvents
        'Dim p As POINTAPI
        'GetCursorPos p
        'ret = myMsgBox(msgsvc(6), vbYesNoCancel, , Me.hwnd, xPos:=p.X, yPos:=p.Y)
        ret = myMsgBox(msgsvc(6), vbYesNoCancel, , Me.hWnd)
        'ret = vbNo
        If ret = vbYes Then
            ToDebug "- "
            ComSaveRec_Click
        ElseIf ret = vbNo Then
            ToDebug "-  "
            rs.CancelUpdate
        Else    'cancel
            Exit Sub
        End If    'ret
        'Unload FrmBin: Set FrmBin = Nothing
    End If    'rs.EditMode
End If    'rs nodb:

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

'
Set map_cScroll = Nothing 'print
If m_cAVI Is Nothing Then
Else
    m_cAVI.filename = vbNullString    'unload
    Set m_cAVI = Nothing
End If
If MpegMediaOpen Then Call MpegMediaClose '  

'TextItemHid.Text = vbNullString
Timer2.Enabled = False
ComDel.Visible = False
Position.Enabled = False: PositionP.Enabled = False
Position.Value = 0: PositionP.Value = 0
ComKeyAvi(0).Enabled = False: ComKeyAvi(1).Enabled = False

optAspect(0).Value = False: optAspect(1).Value = False
'For i = 0 To 2: ComCap(i).Enabled = False: Next i
isMPGflag = False: isAVIflag = False: isDShflag = False ' ClearVideo()?

Set ImgPrCov = Nothing
TextTimeHidText = vbNullString
'Set SC = Nothing: Set objScript = Nothing
Set PicSS1Big = Nothing: Set PicSS2Big = Nothing: Set PicSS3Big = Nothing
Set PicFrontFace = Nothing: Set picCanvas = Nothing ' 

FrameActer.Visible = False
FrameAddEdit.Visible = False
FrameCover.Visible = False
If FirstActivateFlag And Not NoDBFlag Then
    FrameView.Visible = True
Else
    FrameView.Visible = False
End If

Mark2SaveFlag = True    '?
ShowCoverFlag = False
AutoNoMessFlag = False
    
If (MenuItem <> 1) And frmSRFlag Then frmSR.Hide '   

''''''''''''''''''''''''''''''''''''''''''''''''''''''

'If NoDBFlag And MenuItem < 8 Then
'    If optsaved Then
'        FrmOptions.Show vbModal, Me
'        ToDebug "SVC      "
'        myMsgBox msgsvc(21), vbInformation, , Me.hwnd '  .
'        'ComOpenBD.SetFocus
'    End If
'    GoTo Opt
'End If

' 
'CoFreeUnusedLibraries
'SetWrkSize


If MenuItem = 1 Then    '                                            
    ListView.MultiSelect = True
    If Me.Visible Then FrameView.Visible = True
    If Not FirstActivateFlag Then Form_Resize

    If InitFlag Then
        ToDebug " "
        If TabLVHid.Tabs.Count >= CurrentBaseIndex Then         'LastBaseInd Then
            TabLVHid.Tabs(CurrentBaseIndex).Selected = True
        Else
            TabLVHid.Tabs(1).Selected = True
        End If

        FrmMain.ComFilter.BackColor = &HFFFFFF
    Else
        ' 
        If GroupedFlag Then
            TVCLICK
        Else
            LVCLICK
        End If
    End If


    InitFlag = False: addflag = False: OpenAddmovFlag = False: editFlag = False: delFlag = False

    If Not (ListView.SelectedItem Is Nothing) Then
        If Not MultiSel Then
            If Not FirstActivateFlag Then LV_EnsureVisible ListView, ListView.SelectedItem.Index
        End If
    End If

    FrameView.Caption = FrameViewCaption & " " & ListView.ListItems.Count & " )"


    CheckSameDisk = True
    
'     MpegMediaClose
Clear_mobjManager
''    If (True <> (mobjManager Is Nothing)) Then
''        'mobjManager.Stop
''        'DoEvents
''        Set mobjManager = Nothing
''    End If

    ToDebug " "
    Screen.MousePointer = vbNormal
    PrevVMI = LastVMI
    LastVMI = 1
    Exit Sub
End If

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
If MenuItem = 3 Then    '                                          

    If BaseReadOnly Then
        LastVMI = 3
        VerticalMenu_MenuItemClick 1, 0
        myMsgBox msgsvc(24), vbInformation, , Me.hWnd
        Exit Sub
    End If

    ToDebug " "
    Screen.MousePointer = vbHourglass
    ListView.MultiSelect = False

    ComDel.Enabled = False: ComDel.Visible = True: ComAdd.Enabled = False
    'ComAutoScrShots.Enabled = False
    ' clearvideo ComRND(0).Enabled = False: ComRND(1).Enabled = False: ComRND(2).Enabled = False
    TxtIName.Text = vbNullString

    addflag = True: editFlag = False

    If rs.EditMode Then rs.CancelUpdate
    rs.AddNew

    ClearVideo
    ClearFields

    'Set m_cAVI = New cAVIFrameExtract
    '  -  
    Set PicSS1 = Nothing: PicSS1.Width = ScrShotEd_W: PicSS1.Height = ScrShotEd_H
    Set PicSS2 = Nothing: PicSS2.Width = ScrShotEd_W: PicSS2.Height = ScrShotEd_H
    Set PicSS3 = Nothing: PicSS3.Width = ScrShotEd_W: PicSS3.Height = ScrShotEd_H

    NoPicFrontFaceFlag = True: NoPic1Flag = True: NoPic2Flag = True: NoPic3Flag = True

    '  ,     CheckSameDisk = True

    TabStrAdEd.SelectedItem = TabStrAdEd.Tabs(TabStrAdEd.SelectedItem.Index)


    InitFlag = False

    FrameAddEdit.Caption = AddEditCapt

    FrameAddEdit.Visible = True
    Form_Resize
    Timer2.Enabled = False   '  

    '    TabStrAdEd.SelectedItem
    If TextCDN.Visible Then TextCDN.SetFocus
    If TextMName.Visible Then TextMName.SetFocus: TextMName.SelLength = 0

    ComSaveRec.BackColor = &HC0C0E0    '
    PrevVMI = LastVMI
    LastVMI = 3

    Screen.MousePointer = vbNormal
    Exit Sub
End If

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
If MenuItem = 2 Then

'If MultiSel Then LastVMI = 2: VerticalMenu_MenuItemClick 1, 0: Exit Sub
    If rs.RecordCount < 1 Then LastVMI = 2: VerticalMenu_MenuItemClick 1, 0: Exit Sub
    If ListView.ListItems.Count < 1 Then LastVMI = 2: VerticalMenu_MenuItemClick 1, 0: Exit Sub

    If BaseReadOnly Then
        LastVMI = 2
        VerticalMenu_MenuItemClick 1, 0
        myMsgBox msgsvc(24), vbInformation, , Me.hWnd
        Exit Sub
    End If
    If BaseReadOnlyU Then
        LastVMI = 2
        VerticalMenu_MenuItemClick 1, 0
        myMsgBox msgsvc(22), vbInformation, , Me.hWnd
        Exit Sub
    End If

ListView.MultiSelect = False
    
    ToDebug "_Key=" & rs("Key")



    addflag = False: editFlag = True
    movie.Cls: movie.Width = MovieEd_W: movie.Height = MovieEd_H: movie.Visible = True
    ComDel.Visible = True: ComDel.Enabled = True

    ComAutoScrShots.Enabled = False: ComRND(0).Enabled = False: ComRND(1).Enabled = False: ComRND(2).Enabled = False
    For i = 0 To 2: optAspect(i).Enabled = False: Next i
        
    If rs.EditMode Then rs.CancelUpdate
    ComAdd.Enabled = False

    PicSS1.Width = ScrShotEd_W: PicSS1.Height = ScrShotEd_H: Set PicSS1 = Nothing
    PicSS2.Width = ScrShotEd_W: PicSS2.Height = ScrShotEd_H: Set PicSS2 = Nothing
    PicSS3.Width = ScrShotEd_W: PicSS3.Height = ScrShotEd_H: Set PicSS3 = Nothing

    CheckSameDisk = False

    GetEditPix
    Mark2SaveFlag = False
    GetFields
    Mark2SaveFlag = True
    'lbInetMovieList.Clear

    ComSaveRec.BackColor = &HC0E0C0


    If ListView.ListItems.Count > 0 Then LastInd = ListView.SelectedItem.SubItems(lvIndexPole)

    ' 
    TabStrAdEd.SelectedItem = TabStrAdEd.Tabs(TabStrAdEd.SelectedItem.Index)

    InitFlag = False
    FrameAddEdit.Visible = True
    Form_Resize
    Timer2.Enabled = False   '  

    ''    TabStrAdEd.SelectedItem
    'If TextCDN.Visible Then TextCDN.SetFocus
    'If TextMName.Visible Then TextMName.SetFocus: TextMName.SelLength = 0


    PrevVMI = LastVMI
    LastVMI = 2

    Exit Sub
End If

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''


If MenuItem = 5 Then    '                                 


    If LenB(abdname) = 0 Then VerticalMenu_MenuItemClick LastVMI, 0: Exit Sub   'goto last menu

    ToDebug " "
    Screen.MousePointer = vbHourglass
    ComActSave.Enabled = False
    ComActPast.Enabled = False
    ComActFile.Enabled = False
    ComActFotoDel.Enabled = False
  '  ComCancelAct.Enabled = False
    addflag = False: editFlag = False

    If Len(bdname) = 0 Then ComSelMovIcon.Enabled = False
    LVActer.ColumnHeaders(1).Width = LVActer.Width - 70
    LVActer.Sorted = True
    If Not LVActerFilled Then
        FillActListView
    Else
    If Not IsNull(LVActer.SelectedItem.Index) Then LV_EnsureVisible LVActer, LVActer.SelectedItem.Index
    End If

    ListBActHid.Clear
    LActMarkCount.Caption = LActMarkCountCaption + " " + str$(mcount)

    LVActer.ColumnHeaders(1).Width = LVActer.Width - 380    '  

    '     ListView
    Dim itmX As MSComctlLib.ListItem
    i = 0
    For Each itmX In ListView.ListItems
        If itmX.SmallIcon = 1 Then i = i + 1
    Next

    fr_acter = True
    Form_Resize
    Timer2.Enabled = False

    fr_acter = False
    FrameActer.Visible = True

    LVActClick    '   

    Screen.MousePointer = vbNormal

    LActMarkCount.Caption = LActMarkCountCaption & " " & i
    PrevVMI = LastVMI
    LastVMI = 5

    Exit Sub
End If

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
If MenuItem = 4 Then    '                                 
    If rs.RecordCount < 1 Then LastVMI = 4: VerticalMenu_MenuItemClick 1, 0: Exit Sub
    If ListView.ListItems.Count < 1 Then LastVMI = 4: VerticalMenu_MenuItemClick 1, 0: Exit Sub

    ToDebug ""
    addflag = False: editFlag = False
    Screen.MousePointer = vbHourglass

    'A4
    PicCoverPaper.ScaleWidth = 210
    PicCoverPaper.ScaleHeight = 296

    ' Set up scroll bars
    Set map_cScroll = New cScrollBars
    map_cScroll.Create PicPrintScroll.hWnd
    PicCoverPaper.Move 0, 0

    Timer2.Enabled = False

    NoPic1Flag = False: NoPic2Flag = False: NoPic3Flag = False    '    ""  
    PicCoverTextWnd.BorderStyle = 0

    ChPrintChecked.Caption = ChPrintCheckedCaption & ": " & CheckCount
    If CheckCount > 1 Then
        ChPrintChecked.Enabled = True
        chPrnAllOne.Enabled = True
    Else
        ChPrintChecked.Enabled = False
        'chPrnAllOne.Enabled = False ' ,    chPrnAllOne.Value = vbUnchecked
    End If
 
    Select Case TabStripCover.SelectedItem.Index
    Case 1
        Call ShowCoverStandard
    Case 2
        Call ShowCoverConvert
    Case 3
        Call ShowCoverDVD
    Case 4
        ChPrintChecked.Value = 0: ChPrintChecked.Enabled = False     '   
        Call ShowCoverSpisok
    End Select


        
    Screen.MousePointer = vbNormal
    PrevVMI = LastVMI
    LastVMI = 4
    Form_Resize
    Timer2.Enabled = False
    
    ShowCoverFlag = True
    Exit Sub
End If
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

If MenuItem = 8 Then    '                                
    ToDebug "."
    Unload Me
End If
End Sub
Public Sub ShowCoverConvert()
Dim temp As String, temp2 As String
Dim annot As String
Dim sFnt As StdFont
'Dim tempWes As Integer
Dim PRatio As Currency
Dim tmpb As Boolean

On Error Resume Next

If rs.RecordCount < 1 Then Exit Sub
'PicCoverTextWnd.Visible = False

PicCoverPaper.ScaleMode = 6 '
PicCoverPaper.Width = 11940
PicCoverPaper.Height = 16860
PicCoverPaper.ScaleWidth = 210.6085
PicCoverPaper.ScaleHeight = 297.392


'                                         
If chPrnAllOne.Value = vbChecked And CheckCount > 1 Then
    If rs.Fields("Label").Value <> vbNullString Then
     temp = rs.Fields("Label").Value
    Else
     temp = vbNullString
    End If
Else
    If rs.Fields("MovieName").Value <> vbNullString Then
     temp = rs.Fields("MovieName").Value
    Else
     temp = vbNullString
    End If
End If

If Not IsNull(rs.Fields("Annotation").Value) Then annot = rs.Fields("Annotation").Value

Set PicCoverPaper = Nothing
PicCoverPaper.CurrentX = 1: PicCoverPaper.CurrentY = 1
Set PicCoverPaper.Font = FontHor
PicCoverPaper.Print "Sur Video Catalog: " & temp
  
Set sFnt = FontVert

'  
PicCoverPaper.Line (35, 25)-(155, 145), CoverHorBackColor, BF

'  
Set PicCoverTextWnd = Nothing
' PicCoverTextWnd.Visible = True
PicCoverTextWnd.BackColor = CoverHorBackColor
'temp2 = PicCoverPaper.ForeColor
temp2 = PicCoverTextWnd.ForeColor
PicCoverTextWnd.ForeColor = HFontColor '&HFF00&
'PicCoverPaper.ForeColor = HFontColor '&HFF00&

Dim txtBody As String
If chPrnAllOne.Value = vbChecked Then
    txtBody = GetCoverSpisok
Else
    If Len(temp) = 0 Then
        txtBody = annot
    Else
        txtBody = temp & " " & vbCrLf & " ***" & vbCrLf & " " & annot
    End If
End If

WrapText PicCoverTextWnd, txtBody, 1, PicCoverTextWnd.Width, 1, PicCoverTextWnd.Height, False   ' 

'''''''
tmpb = GetPic(PicCoverTemp, 1, "SnapShot1")
PicCoverTemp.Picture = PicCoverTemp.Image
PRatio = PicCoverTemp.Width / PicTempHid(0).Height
If PRatio < 1 Then PRatio = 1.333
If tmpb Then PicCoverPaper.PaintPicture PicCoverTemp.Picture, 35.4, 25.5, 39.5, 39.5 / PRatio

Set PicCoverTemp = Nothing
tmpb = GetPic(PicCoverTemp, 1, "SnapShot2")
PicCoverTemp.Picture = PicCoverTemp.Image
PRatio = PicCoverTemp.Width / PicTempHid(0).Height
If PRatio < 1 Then PRatio = 1.333
If tmpb Then PicCoverPaper.PaintPicture PicCoverTemp.Picture, 75.3, 25.5, 39.5, 39.5 / PRatio

Set PicCoverTemp = Nothing
tmpb = GetPic(PicCoverTemp, 1, "SnapShot3")
PicCoverTemp.Picture = PicCoverTemp.Image
PRatio = PicCoverTemp.Width / PicTempHid(0).Height
If PRatio < 1 Then PRatio = 1.333
If tmpb Then PicCoverPaper.PaintPicture PicCoverTemp.Picture, 115.4, 25.5, 39.5, 39.5 / PRatio

''''''''''''

'PicCoverPaper.ForeColor = temp2
PicCoverTextWnd.ForeColor = temp2
PicCoverTextWnd.Picture = PicCoverTextWnd.Image
PicCoverPaper.PaintPicture PicCoverTextWnd.Picture, PicCoverTextWnd.left, PicCoverTextWnd.top

'
'Set PicFaceV = Nothing
If PicFaceV.Picture = 0 Then GetPic PicFaceV, 1, "FrontFace" '22
If (Not NoPicFrontFaceFlag) And (ChPrintPix.Value = 1) Then PutPrintPixConvert

PicCoverPaper.DrawWidth = 1

Call PrintBoxesConvert

PicCoverPaper.Picture = PicCoverPaper.Image


FrameCover.Visible = True

'  
PicCoverTextWnd.Visible = True

PicPrintScroll_Resize

End Sub
Public Sub ShowCoverStandard()
Dim temp As String, temp2 As String
Dim annot As String
Dim sFnt As StdFont
Dim tempWes As Integer
'Dim temp As String
Dim PRatio As Currency
Dim tmpb As Boolean
Dim tmpC As Currency

On Error Resume Next

PicCoverPaper.ScaleMode = 6 '
'PicCoverPaper.Move 0, 0, 11940, 16860 -  
PicCoverPaper.Width = 11940
PicCoverPaper.Height = 16860
PicCoverPaper.ScaleWidth = 210.6085
PicCoverPaper.ScaleHeight = 297.392

'                                         
If chPrnAllOne.Value = vbChecked And CheckCount > 1 Then
    If rs.Fields("Label").Value <> vbNullString Then
     temp = rs.Fields("Label").Value
    Else
     temp = vbNullString
    End If
Else
    If rs.Fields("MovieName").Value <> vbNullString Then
     temp = rs.Fields("MovieName").Value
    Else
     temp = vbNullString
    End If
End If

'If Not IsNull(rs.Fields("MovieName").Value) Then '0
'temp = rs.Fields("MovieName").Value
'Else
'temp = "No Name"
'End If

If Not IsNull(rs.Fields("Annotation").Value) Then annot = rs.Fields("Annotation").Value

Set PicCoverPaper = Nothing
PicCoverPaper.CurrentX = 1: PicCoverPaper.CurrentY = 1
Set PicCoverPaper.Font = FontHor
Set PicCoverTextWnd.Font = FontHor

PicCoverPaper.Print "Sur Video Catalog: " & temp

'  
PicCoverPaper.Line (29, 145)-(178, 262), CoverVertBackColor, BF
PicCoverPaper.Line (35, 145)-(172, 262), CoverHorBackColor, BF


Set sFnt = FontVert
If sFnt.Bold Then tempWes = FW_BOLD Else tempWes = FW_NORMAL

    DrawRotatedText temp, 29, 260, _
       sFnt.name, sFnt.Size, _
        tempWes, 90 * 10, _
         sFnt.Italic, sFnt.Underline, sFnt.Strikethrough, VFontColor, sFnt.Charset, 113
        

    DrawRotatedText temp, 178, 147, _
       sFnt.name, sFnt.Size, _
        tempWes, 270 * 10, _
         sFnt.Italic, sFnt.Underline, sFnt.Strikethrough, VFontColor, sFnt.Charset, 113
        
'  
temp2 = PicCoverTextWnd.ForeColor
PicCoverTextWnd.ForeColor = HFontColor '&HFF00&
'******************************************
'PicCoverTextWnd.BorderStyle = 0
Set PicCoverTextWnd = Nothing
' PicCoverTextWnd.Visible = True

PicCoverTextWnd.BackColor = CoverHorBackColor
PicCoverTextWnd.Line (0, 0)-(PicCoverTextWnd.Width, PicCoverTextWnd.Height), CoverHorBackColor, BF

Dim txtBody As String
If chPrnAllOne.Value = vbChecked Then
    txtBody = GetCoverSpisok
Else
    txtBody = temp & " " & vbCrLf & " " & annot
End If

WrapText PicCoverTextWnd, txtBody, 1, PicCoverTextWnd.Width, 0, PicCoverTextWnd.Height - 4, False

PicCoverTextWnd.ForeColor = temp2

tmpb = GetPic(PicCoverTemp, 1, "SnapShot1")
If tmpb Then
PicCoverTemp.Picture = PicCoverTemp.Image
PRatio = PicCoverTemp.Width / PicCoverTemp.Height
If PRatio < 1 Then PRatio = 1.333
PicCoverPaper.PaintPicture PicCoverTemp.Picture, 35.4, 145.5, 45.2, 45.2 / PRatio
End If

Set PicCoverTemp = Nothing
tmpb = GetPic(PicCoverTemp, 1, "SnapShot2")
If tmpb Then
PicCoverTemp.Picture = PicCoverTemp.Image
PRatio = PicCoverTemp.Width / PicCoverTemp.Height
If PRatio < 1 Then PRatio = 1.333
PicCoverPaper.PaintPicture PicCoverTemp.Picture, 80.9, 145.5, 45.2, 45.2 / PRatio
End If

Set PicCoverTemp = Nothing
tmpb = GetPic(PicCoverTemp, 1, "SnapShot3")
If tmpb Then
PicCoverTemp.Picture = PicCoverTemp.Image
PRatio = PicCoverTemp.Width / PicCoverTemp.Height
If PRatio < 1 Then PRatio = 1.333
tmpC = 45.2 / PRatio
PicCoverPaper.PaintPicture PicCoverTemp.Picture, 126.5, 145.5, 45.2, tmpC
End If
'*************************************
'PicCoverTextWnd.Move 35.4, 145.4 + tmpC + 1, 136.2, 116 - tmpC - 0.5

PicCoverTextWnd.Picture = PicCoverTextWnd.Image
PicCoverPaper.PaintPicture PicCoverTextWnd.Picture, PicCoverTextWnd.left, PicCoverTextWnd.top

Set PicCoverTemp = Nothing

'
'Set PicFaceV = Nothing
If PicFaceV.Picture = 0 Then GetPic PicFaceV, 1, "FrontFace"
If NoPicFrontFaceFlag Or ChPrintPix.Value = vbUnchecked Then
Else
PutPrintPixStandard
End If

PicCoverPaper.DrawWidth = 1

'
Call PrintBoxesStandard
PicCoverPaper.Picture = PicCoverPaper.Image

FrameCover.Visible = True

'  
PicCoverTextWnd.Visible = True

PicPrintScroll_Resize

End Sub
Public Sub ShowCoverSpisok()
Dim temp2 As String ', temp2 As String

PicCoverPaper.ScaleMode = 6 '
'PicCoverPaper.Move 0, 0, 11940, 16860 -  
PicCoverPaper.Width = 11940
PicCoverPaper.Height = 16860
PicCoverPaper.ScaleWidth = 210.6085
PicCoverPaper.ScaleHeight = 297.392


Set PicCoverPaper = Nothing
PicCoverPaper.CurrentX = 1: PicCoverPaper.CurrentY = 1
Set PicCoverPaper.Font = FontHor
Set PicCoverTextWnd.Font = FontHor

PicCoverPaper.Print "Sur Video Catalog" ': " & temp

'  
'PicCoverPaper.Line (29, 145)-(178, 262), CoverVertBackColor, BF
'PicCoverPaper.Line (35, 145)-(172, 262), CoverHorBackColor, BF

'Set sFnt = FontVert
'If sFnt.Bold Then tempWes = FW_BOLD Else tempWes = FW_NORMAL
'    DrawRotatedText temp, 29, 260, _
       sFnt.name, sFnt.Size, _
        tempWes, 90 * 10, _
         sFnt.Italic, sFnt.Underline, sFnt.Strikethrough, VFontColor, sFnt.Charset, 113
'    DrawRotatedText temp, 178, 147, _
       sFnt.name, sFnt.Size, _
        tempWes, 270 * 10, _
         sFnt.Italic, sFnt.Underline, sFnt.Strikethrough, VFontColor, sFnt.Charset, 113
        
'  
temp2 = PicCoverTextWnd.ForeColor
PicCoverTextWnd.ForeColor = HFontColor '&HFF00&

'******************************************

PicCoverTextWnd.BorderStyle = 1

Set PicCoverTextWnd = Nothing
'PicCoverTextWnd.Visible = True '

PicCoverTextWnd.BackColor = CoverHorBackColor
PicCoverTextWnd.Line (0, 0)-(PicCoverTextWnd.Width, PicCoverTextWnd.Height), CoverHorBackColor, BF

WrapText PicCoverTextWnd, GetCoverSpisok, 0, PicCoverTextWnd.Width, 0, PicCoverTextWnd.Height - 4, False
'WrapText PicCoverTextWnd, GetCoverSpisok, 10, PicCoverTextWnd.Width, 10, PicCoverTextWnd.Height - 14, False

PicCoverTextWnd.ForeColor = temp2

PicCoverTextWnd.Picture = PicCoverTextWnd.Image
PicCoverPaper.PaintPicture PicCoverTextWnd.Picture, PicCoverTextWnd.left, PicCoverTextWnd.top

Set PicCoverTemp = Nothing

PicCoverPaper.DrawWidth = 1

'
'Call PrintBoxesStandard
PicCoverPaper.Picture = PicCoverPaper.Image

FrameCover.Visible = True
'  
PicCoverTextWnd.Visible = True

PicPrintScroll_Resize

End Sub

Public Sub ShowCoverDVD()
Dim temp As String, temp2 As String
Dim annot As String
Dim sFnt As StdFont
Dim tempWes As Integer
Dim tmpb As Boolean
Dim PRatio As Currency

On Error Resume Next

PicCoverPaper.ScaleMode = 6 '
PicCoverPaper.Width = 16860
PicCoverPaper.Height = 11940
PicCoverPaper.ScaleWidth = 297.392
PicCoverPaper.ScaleHeight = 210.6085

'                                         
If chPrnAllOne.Value = vbChecked And CheckCount > 1 Then
    If rs.Fields("Label").Value <> vbNullString Then
     temp = rs.Fields("Label").Value
    Else
     temp = vbNullString
    End If
Else
    If rs.Fields("MovieName").Value <> vbNullString Then
     temp = rs.Fields("MovieName").Value
    Else
     temp = vbNullString
    End If
End If

If Not IsNull(rs.Fields("Annotation").Value) Then annot = rs.Fields("Annotation").Value

Set PicCoverPaper = Nothing
PicCoverPaper.CurrentX = 1: PicCoverPaper.CurrentY = 1
Set PicCoverPaper.Font = FontHor
Set PicCoverTextWnd.Font = FontHor

PicCoverPaper.Print "Sur Video Catalog: " & temp

'  

PicCoverPaper.Line (10, 15)-(140, 195), CoverHorBackColor, BF
PicCoverPaper.Line (140, 15)-(153, 195), CoverVertBackColor, BF
PicCoverPaper.Line (153, 15)-(283, 195), CoverHorBackColor, BF

Set sFnt = FontVert
If sFnt.Bold Then tempWes = FW_BOLD Else tempWes = FW_NORMAL

    DrawRotatedText temp, 151, 18, _
       sFnt.name, sFnt.Size + 6, _
        tempWes, 270 * 10, _
         sFnt.Italic, sFnt.Underline, sFnt.Strikethrough, VFontColor, sFnt.Charset, 170
        
'  
temp2 = PicCoverTextWnd.ForeColor
PicCoverTextWnd.ForeColor = HFontColor '&HFF00&

'******************************************

Set PicCoverTextWnd = Nothing
'  PicCoverTextWnd.Visible = True

PicCoverTextWnd.BackColor = CoverHorBackColor
PicCoverTextWnd.Line (0, 0)-(PicCoverTextWnd.Width, PicCoverTextWnd.Height), CoverHorBackColor, BF

Dim txtBody As String
If chPrnAllOne.Value = vbChecked Then
    txtBody = GetCoverSpisok
Else
    txtBody = temp & " " & vbCrLf & " " & annot
End If

WrapText PicCoverTextWnd, txtBody, 1, PicCoverTextWnd.Width, 0, PicCoverTextWnd.Height - 4, False

PicCoverTextWnd.ForeColor = temp2
'PicCoverPaper.ForeColor = temp2


tmpb = GetPic(PicCoverTemp, 1, "SnapShot1")
PicCoverTemp.Picture = PicCoverTemp.Image
PRatio = PicCoverTemp.Width / PicTempHid(0).Height
If PRatio < 1 Then PRatio = 1.333
If tmpb Then PicCoverPaper.PaintPicture PicCoverTemp.Picture, 12, 17, 63, 63 / PRatio

Set PicCoverTemp = Nothing
tmpb = GetPic(PicCoverTemp, 1, "SnapShot2")
PicCoverTemp.Picture = PicCoverTemp.Image
PRatio = PicCoverTemp.Width / PicTempHid(0).Height
If PRatio < 1 Then PRatio = 1.333
If tmpb Then PicCoverPaper.PaintPicture PicCoverTemp.Picture, 76, 17, 63, 63 / PRatio

'Set PicCoverTemp = Nothing
'GetPic PicCoverTemp, 1, "SnapShot3" '19
'PicCoverTemp.Picture = PicCoverTemp.Image
'PicCoverPaper.PaintPicture PicCoverTemp.Picture, 101, 16, 45.2, 45.2 / PRatio

'*************************************
PicCoverTextWnd.Picture = PicCoverTextWnd.Image
PicCoverPaper.PaintPicture PicCoverTextWnd.Picture, PicCoverTextWnd.left, PicCoverTextWnd.top

Set PicCoverTemp = Nothing


'
'Set PicFaceV = Nothing
If PicFaceV.Picture = 0 Then GetPic PicFaceV, 1, "FrontFace"
If NoPicFrontFaceFlag Or ChPrintPix.Value = vbUnchecked Then
Else
PutPrintPixDVD
End If

PicCoverPaper.DrawWidth = 1

'
Call PrintBoxesDVD

PicCoverPaper.Picture = PicCoverPaper.Image
FrameCover.Visible = True

'  
PicCoverTextWnd.Visible = True

PicPrintScroll_Resize

End Sub

Private Sub PutPrintPixConvert()
Dim PRatio As Double
'Dim ph As Long, pw As Long

If ChPrintPix.Value = vbUnchecked Then Exit Sub
PicCoverPaper.PaintPicture ImBlankHid.Picture, 35, 145, 120, 120
PicFaceV.Picture = PicFaceV.Image

If PicFaceV.Picture <> 0 Then

PRatio = PicFaceV.Height / PicFaceV.Width
If PRatio > 1 Then PRatio = 1 / PRatio

If ChPropP.Value Then ' 
 If ChScaleP.Value Then '
    If PicFaceV.Height > PicFaceV.Width Then
        If ChCentrP.Value Then
            'centre hor
            PicCoverPaper.PaintPicture PicFaceV.Picture, 155 - 60 + (120 * PRatio) / 2, 265, -120 * PRatio, -120
        Else
            PicCoverPaper.PaintPicture PicFaceV.Picture, 155, 265, -120 * PRatio, -120
        End If
    Else
        If ChCentrP.Value Then
            'centre vert
            PicCoverPaper.PaintPicture PicFaceV.Picture, 155, 265 - 60 + (120 * PRatio) / 2, -120, -120 * PRatio
        Else
            PicCoverPaper.PaintPicture PicFaceV.Picture, 155, 265, -120, -120 * PRatio
        End If
    End If
 Else '  ' 
        If ChCentrP.Value Then
            PicCoverPaper.PaintPicture PicFaceV.Picture, 155, 265, -120, -120, (PicFaceV.ScaleWidth - 120) / 2, (PicFaceV.ScaleHeight - 120) / 2, 120, 120
        Else
            PicCoverPaper.PaintPicture PicFaceV.Picture, 155, 145 + PicFaceV.ScaleHeight, -PicFaceV.ScaleWidth, -PicFaceV.ScaleHeight
        End If
 End If 'ChScaleP
Else '  
    If ChScaleP.Value Then '
        PicCoverPaper.PaintPicture PicFaceV.Picture, 155, 265, -120, -120 'good
    End If 'ChScaleP
End If 'ChPropP

'   
PicCoverPaper.PaintPicture ImBlankHid.Picture, 35, 265, 125, 125 '
PicCoverPaper.PaintPicture ImBlankHid.Picture, 0, 145, 35, 200 '

End If

Call PrintBoxesConvert

End Sub
Private Sub PutPrintPixStandard()
Dim PRatio As Double

If ChPrintPix.Value = vbUnchecked Then Exit Sub

PicCoverPaper.PaintPicture ImBlankHid.Picture, 35, 25, 120, 120             '< 
PicFaceV.Picture = PicFaceV.Image


If PicFaceV.Picture <> 0 Then


'PRatio = 1
PRatio = PicFaceV.Height / PicFaceV.Width
If PRatio > 1 Then PRatio = 1 / PRatio

If ChPropP.Value Then ' 
 If ChScaleP.Value Then '
    If PicFaceV.Height > PicFaceV.Width Then
        If ChCentrP.Value Then
        'centre  
            PicCoverPaper.PaintPicture PicFaceV.Picture, 35 + 60 - (120 * PRatio) / 2, 25, 120 * PRatio, 120
        Else
            PicCoverPaper.PaintPicture PicFaceV.Picture, 35, 25, 120 * PRatio, 120
        End If
        
    Else
        If ChCentrP.Value Then
        'centre  
            PicCoverPaper.PaintPicture PicFaceV.Picture, 35, 25 + 60 - (120 * PRatio) / 2, 120, 120 * PRatio
        Else
            PicCoverPaper.PaintPicture PicFaceV.Picture, 35, 25, 120, 120 * PRatio
        End If
        
    End If
 Else ' 
       If ChCentrP.Value Then
           ' Centre  ()
           'PicFaceV   
           PicCoverPaper.PaintPicture PicFaceV.Picture, 35, 25, , , (PicFaceV.ScaleWidth - 120) / 2, (PicFaceV.ScaleHeight - 120) / 2, 120, 120
       Else
           PicCoverPaper.PaintPicture PicFaceV.Picture, 35, 25, , , , , 120, 120
       End If
 End If 'ChScaleP
Else '  
    If ChScaleP.Value Then '
        PicCoverPaper.PaintPicture PicFaceV.Picture, 35, 25, 120, 120
    End If 'ChScaleP
End If 'ChPropP


End If

Call PrintBoxesStandard
End Sub

Private Sub PutPrintPixDVD()
Dim PRatio As Double
Dim k As Double

Dim X1 As Single, Y1 As Single
Dim WIDTH1 As Long, HEIGHT1 As Long

'long?

If ChPrintPix.Value = vbUnchecked Then Exit Sub

PicCoverPaper.PaintPicture ImBlankHid.Picture, 153.2, 15.3, 130, 179.7
PicFaceV.Picture = PicFaceV.Image

Dim chOr As Boolean

If PicFaceV.Picture <> 0 Then


PRatio = PicFaceV.Height / PicFaceV.Width
k = 180 / 130

If k < PRatio Then chOr = True

If chOr Then If PRatio > 1 Then PRatio = 1 / PRatio

'PicCoverTemp
                                               '< 


If ChPropP.Value Then ' 
 If ChScaleP.Value Then '
'    If PicFaceV.Height > PicFaceV.Width Then
    If chOr Then
        X1 = (128 * PRatio * k)
        WIDTH1 = ScaleX(X1, 6, vbPixels)
        HEIGHT1 = ScaleY(180, 6, vbPixels)
        ResizeWIA PicCoverTemp, WIDTH1, HEIGHT1, PicFaceV
        If ChCentrP.Value Then
        'centre hor
            PicCoverPaper.PaintPicture PicCoverTemp.Picture, 153 + 65 - X1 / 2, 15
        Else
            PicCoverPaper.PaintPicture PicCoverTemp.Picture, 153, 15
        End If
        
    Else
        Y1 = 180 * PRatio / k
        WIDTH1 = ScaleX(130, 6, vbPixels)
        HEIGHT1 = ScaleY(Y1, 6, vbPixels)
        ResizeWIA PicCoverTemp, WIDTH1, HEIGHT1, PicFaceV
        If ChCentrP.Value Then
        'centre VERT
            PicCoverPaper.PaintPicture PicCoverTemp.Picture, 153.2, 15 + 90 - Y1 / 2
        Else
            PicCoverPaper.PaintPicture PicCoverTemp.Picture, 153.2, 15
        End If
    End If
    
 Else ' 
        If ChCentrP.Value Then
             PicCoverPaper.PaintPicture PicFaceV.Picture, 153, 15, , , (PicFaceV.ScaleWidth - 130) / 2, (PicFaceV.ScaleHeight - 180) / 2, 130, 180
        Else
             PicCoverPaper.PaintPicture PicFaceV.Picture, 153, 15, , , , , 130, 180
        End If
 End If 'ChScaleP
 
Else '  
    WIDTH1 = ScaleX(130, 6, vbPixels)
    HEIGHT1 = ScaleY(180, 6, vbPixels)
    ResizeWIA PicCoverTemp, WIDTH1, HEIGHT1, PicFaceV
    If ChScaleP.Value Then '
        PicCoverPaper.PaintPicture PicCoverTemp.Picture, 153.2, 15
    End If 'ChScaleP
End If 'ChPropP


End If

Set PicCoverTemp = Nothing

Call PrintBoxesDVD
End Sub

Private Sub PrintBoxesConvert()

PicCoverPaper.Line (35, 25)-(155, 145), , B
PicCoverPaper.Line (35, 145)-(155, 265), , B



'PicCoverPaper.Line (29, 145)-(178, 262), , B
'PicCoverPaper.Line (35, 145)-(172, 262), , B
End Sub
Private Sub PrintBoxesStandard()

PicCoverPaper.Line (35, 25)-(155, 145), , B

PicCoverPaper.Line (29, 145)-(178, 262), , B
PicCoverPaper.Line (35, 145)-(172, 262), , B

End Sub
Private Sub PrintBoxesDVD()

PicCoverPaper.Line (10, 15)-(140, 195), , B
PicCoverPaper.Line (140, 15)-(153, 195), , B
PicCoverPaper.Line (153, 15)-(283, 195), , B

End Sub

Public Sub FillActListView()
'Dim liChild As ListItem
Dim i As Integer
Dim temp As String
Const Kavs = """"

If ars.RecordCount = 0 Then Exit Sub

ToDebug " "
Screen.MousePointer = vbHourglass

LVActer.Visible = False
LVActer.ListItems.Clear
LVActer.Sorted = False

ars.MoveFirst

On Error Resume Next '  null
i = 0
Do While Not ars.EOF
    i = i + 1
    
    'temp = vbNullString
    'If ars.Fields("Name").Value <> vbNullString Then
    '    temp = ars.Fields("Name").Value
    'End If

    'If Not IsNull(ars("Name")) Then temp = ars("Name") Else temp = vbNullString

    '
    LVActer.ListItems.Add i, ars("Key") & Kavs, ars("Name") 'temp

    LVActer.ListItems(i).SubItems(1) = i
    ars.MoveNext
Loop
err.Clear

LVActer.Sorted = True: LVActer.Visible = True

'   
GotoLVAct CurActKey

LV_EnsureVisible LVActer, LVActer.SelectedItem.Index
LastIndAct = LVActer.ListItems(LVActer.SelectedItem.Index).SubItems(1)
CurAct = LVActer.SelectedItem.Index

'Debug.Print "After Fill L=" & LastIndAct & " C=" & CurAct

FrameActer.Caption = FrameActerCaption & LVActer.ListItems.Count & ")"
LVActerFilled = True
Screen.MousePointer = vbNormal
End Sub
Private Sub clearLVIcon()
Dim i As Integer

For i = 1 To ListView.ListItems.Count
ListView.ListItems.Item(i).SmallIcon = 0 'blank
Next i

End Sub
Public Sub FillListView()
Dim j As Integer, i As Integer
Dim ind As Long
'Dim tmpFlag As Boolean
'Dim ColorFlag As Boolean
Dim temp As String
'Dim Itm As ListItem
Const Kavs = """"
Dim rsCount As Long

On Error Resume Next ' 

'CheckedInLV = 0

'rs.MoveFirst: rs.MoveLast: rs.MoveFirst
rs.MoveLast: rs.MoveFirst

rsCount = rs.RecordCount

If rsCount < 1 Or err Then
    FrmMain.FrameView.Caption = FrameViewCaption & " 0 )"    '?  
    ListView.ListItems.Clear
    TextVAnnot.Text = vbNullString
    UCLV.Clear
    Set PicFaceV = Nothing
    NoPicFrontFaceFlag = True
    NoPic1Flag = True: NoPic2Flag = True: NoPic3Flag = True
    Timer2_Timer    ' image0
    Screen.MousePointer = vbNormal
    Exit Sub
End If

On Error GoTo 0

'Screen.MousePointer = vbHourglass
'If frmFilterFlag Then tmpFlag = True
If frmFilterFlag Then Me.Refresh

'DoEvents !

If FormShowPicLoaded Then Unload FormShowPic: Set FormShowPic = Nothing
If ListView.SelectedItem Is Nothing Then: Else CurSearch = ListView.SelectedItem.Index

nScrollPos = GetScrollPos(ListView.hWnd, SB_HORZ)
ListView.ListItems.Clear
ListView.Sorted = False

ReDim CheckRows(0): ReDim SelRows(0): ReDim lvItemLoaded(0)
ReDim CheckRowsKey(0): ReDim SelRowsKey(0)

On Error Resume Next

'
PBar.min = 0: PBar.Max = rsCount
If SplashFlag Then frmSplash.PBar.min = 0: frmSplash.PBar.Max = PBar.Max
'TextItemHid.ZOrder 0
PBar.ZOrder 0

ind = 1

'LockWindowUpdate ListView.hwnd
'LockWindowUpdate 0

'  ( - )
ReDim lvItemLoaded(rsCount)

'Dim t As Long
't = timeGetTime()
'FrameView.Enabled = False
'ListView.Visible = False

'   
Do While Not rs.EOF

    If ind / 10 = Int(ind / 10) Then
        If SplashFlag Then
            frmSplash.PBar.Value = ind
        Else
            PBar.Value = ind
        End If
    End If

    'Title
    If Not IsNull(rs(dbMovieNameInd)) Then temp = rs(dbMovieNameInd) Else temp = vbNullString ',     ,  Null

    ListView.ListItems.Add ind, rs.Fields("Key") & Kavs, temp

    'Index
    ListView.ListItems(ind).SubItems(lvIndexPole) = ind - 1

    '
    'If Not IsNull(rs(dbCheckedInd)) Then temp = rs(dbCheckedInd) Else temp = vbNullString
    ListView.ListItems(ind).Checked = Val(rs(dbCheckedInd))  'Val(temp)
    
    'Val(CheckNoNullVal(dbCheckedInd))
    ' CheckedInLV = CheckedInLV + Abs(ListView.ListItems(ind).Checked)

    '    
    '  
    'ReDim lvItemLoaded(ind) '(UBound(lvItemLoaded) + 1) ' 
    ' 
    If Opt_LoadOnlyTitles = False Then
    '  
        FillLvSubs ind
    End If

    ind = ind + 1
    rs.MoveNext
Loop

err.Clear

'LockWindowUpdate 0
'ListView.Visible = True

'ToDebug timeGetTime() - t '6788? 8200
'err.Clear

TextItemHid.ZOrder 0

'FilteredFlag = False '  

If ListView.ListItems.Count > 0 Then
    If CurSearch < 1 Then CurSearch = 1
    If CurSearch > ListView.ListItems.Count Then CurSearch = ListView.ListItems.Count

    ListView.MultiSelect = False
    ListView.SelectedItem.Selected = False

    'Select
    If FirstLVFill Then
        If LastInd > ListView.ListItems.Count - 1 Then LastInd = 0
        Set ListView.SelectedItem = ListView.ListItems(LastInd + 1)

        ':   ,     
        Call SendMessage(ListView.hWnd, &H100, vbKeyLeft, ByVal 0&)
        Call SendMessage(ListView.hWnd, &H101, vbKeyLeft, ByVal 0&)

    Else
        SelectLVItemFromKey LastKey    '  
    End If

    ListView.MultiSelect = True

    '   
    If Me.Visible Then
    Else
        'If FirstActivateFlag Then
        If Len(Command$) <> 0 Then
            '    
            temp = GetNameFromPathAndName(Command$)
            'temp = "Instinct.avi"""
            temp = Replace(temp, """", vbNullString)
            If Len(temp) <> 0 Then
                i = SearchLV(dbFileNameInd, temp, vbTextCompare)
                If i > 0 Then
                    ListView.ListItems(ListView.SelectedItem.Index).Checked = True
                    ChMarkFindHid.Value = vbChecked
                    j = FindNextLV(dbFileNameInd, temp)    ' LV  -    
                    ChMarkFindHid.Value = vbUnchecked
                    TextItemHid.Text = NamesStore(3) & "(" & i + j & ")" & Chr$(32) & temp    '
                End If
                'Else
            End If    'Len(temp)

        End If    'command <> ""
    End If    ' 

    '   -  
    If LVSortColl > 0 Then LVSOrt (LVSortColl)
    If LVSortColl = -1 Then SortByCheck 0

    LVCLICK    '     , 
    'CheckedInLV = CheckCount
End If    'lvcount>0

FrmMain.FrameView.Caption = FrameViewCaption & " " & FrmMain.ListView.ListItems.Count & " )"    '  

delFlag = False
FirstLVFill = False
Screen.MousePointer = vbNormal

End Sub
Private Sub SelectLVItemFromKey(kl As Long)
'  ListView   
Dim itmX As MSComctlLib.ListItem
On Error Resume Next

For Each itmX In ListView.ListItems
    If Val(itmX.Key) = kl Then
        itmX.Selected = True
        itmX.EnsureVisible
    End If
Next
ListViewScroll ListView, nScrollPos, 0
End Sub


'Public Function AndOr(ch As CheckBox) As String
'If ch = vbChecked Then
'    AndOr = "AND"
'ElseIf ch = vbUnchecked Then
''  or  
'If Len(FrmFilter.cbs(ch.Index)) <> 0 Then
'    AndOr = "OR"
'Else
'    AndOr = "AND"
'End If
'
'End If
'End Function


Private Sub ma_cScroll_Change(eBar As EFSScrollBarConstants)
   ma_cScroll_Scroll eBar
End Sub

Private Sub ma_cScroll_Scroll(eBar As EFSScrollBarConstants)
   If (eBar = efsHorizontal) Then
      PicActFoto.left = -Screen.TwipsPerPixelX * ma_cScroll.Value(eBar)
   Else
      PicActFoto.top = -Screen.TwipsPerPixelY * ma_cScroll.Value(eBar)
   End If
End Sub
Private Sub m_cscroll_Change(eBar As EFSScrollBarConstants)
   m_cscroll_Scroll eBar
End Sub

Private Sub m_cscroll_Scroll(eBar As EFSScrollBarConstants)
   If (eBar = efsHorizontal) Then
      PicFaceV.left = -Screen.TwipsPerPixelX * m_cScroll.Value(eBar)
   Else
      PicFaceV.top = -Screen.TwipsPerPixelY * m_cScroll.Value(eBar)
   End If
End Sub
Private Sub map_cScroll_Change(eBar As EFSScrollBarConstants)
   map_cScroll_Scroll eBar
End Sub

Private Sub map_cScroll_Scroll(eBar As EFSScrollBarConstants)
   If (eBar = efsHorizontal) Then
      PicCoverPaper.left = -Screen.TwipsPerPixelX * map_cScroll.Value(eBar)
   Else
      PicCoverPaper.top = -Screen.TwipsPerPixelY * map_cScroll.Value(eBar)
   End If
End Sub

Private Sub picScrollBoxV_Resize()
Dim lHeight As Long
Dim lWidth As Long
Dim lProportion As Long
On Error Resume Next

If Me.Visible = False Then Exit Sub
'If picScrollBoxV.Visible = False Then Exit Sub '    
If m_cScroll Is Nothing Then Exit Sub

   lHeight = (PicFaceV.Height - picScrollBoxV.ScaleHeight) \ Screen.TwipsPerPixelY
   If (lHeight > 0) Then
      lProportion = lHeight \ (picScrollBoxV.ScaleHeight \ Screen.TwipsPerPixelY) + 1
      m_cScroll.LargeChange(efsVertical) = lHeight \ lProportion
      m_cScroll.Max(efsVertical) = lHeight
      m_cScroll.Visible(efsVertical) = True
   Else
      m_cScroll.Visible(efsVertical) = False
      PicFaceV.top = 0
   End If
   
   lWidth = (PicFaceV.Width - picScrollBoxV.ScaleWidth) \ Screen.TwipsPerPixelX
   If (lWidth > 0) Then
      lProportion = lWidth \ (picScrollBoxV.ScaleWidth \ Screen.TwipsPerPixelX) + 1
      m_cScroll.LargeChange(efsHorizontal) = lWidth \ lProportion
      m_cScroll.Max(efsHorizontal) = lWidth
      m_cScroll.Visible(efsHorizontal) = True
   Else
      m_cScroll.Visible(efsHorizontal) = False
      PicFaceV.left = 0
   End If

End Sub

Private Sub DrawRotatedText(ByVal txt As String, _
        ByVal x As Single, ByVal y As Single, _
        ByVal font_name As String, ByVal Size As Long, _
        ByVal weight As Long, ByVal escapement As Long, _
        ByVal use_italic As Boolean, ByVal use_underline As Boolean, _
        ByVal use_strikethrough As Boolean, ByVal fColor As Long, ByVal fcharset As Long, ByVal wID As Long)

''used with fdwCharSet
'Const ANSI_CHARSET = 0
'Const DEFAULT_CHARSET = 1
'Const SYMBOL_CHARSET = 2
'Const SHIFTJIS_CHARSET = 128
'Const HANGEUL_CHARSET = 129
'Const CHINESEBIG5_CHARSET = 136
'Const OEM_CHARSET = 255
''used with fdwOutputPrecision
'Const OUT_CHARACTER_PRECIS = 2
Const OUT_DEFAULT_PRECIS = 0
'Const OUT_DEVICE_PRECIS = 5
''used with fdwClipPrecision
'Const CLIP_DEFAULT_PRECIS = 0
'Const CLIP_CHARACTER_PRECIS = 1
'Const CLIP_STROKE_PRECIS = 2
''used with fdwQuality
'Const DEFAULT_QUALITY = 0
'Const DRAFT_QUALITY = 1
Const PROOF_QUALITY = 2
''used with fdwPitchAndFamily
Const DEFAULT_PITCH = 0
'Const FIXED_PITCH = 1
'Const VARIABLE_PITCH = 2

Const CLIP_LH_ANGLES = 16   ' Needed for tilted fonts.
'Const PI = 3.14159625
'Const PI_180 = PI / 180#

Dim newFont As Long
Dim OldFont As Long
Dim temp As Long
Dim trt As Boolean
Dim hWnd As Long
Dim hdc As Long
hWnd = GetDesktopWindow
hdc = GetDC(hWnd)

'    newfont = CreateFont(size, 0, _
     escapement, escapement, weight, _
     use_italic, use_underline, _
     use_strikethrough, fcharset, OUT_DEFAULT_PRECIS, _
     CLIP_LH_ANGLES, PROOF_QUALITY, DEFAULT_PITCH, font_name)

newFont = CreateFont(-(Size * GetDeviceCaps(hdc, LOGPIXELSY)) / 72, 0, _
        escapement, escapement, weight, _
        use_italic, use_underline, _
        use_strikethrough, fcharset, OUT_DEFAULT_PRECIS, _
        CLIP_LH_ANGLES, PROOF_QUALITY, DEFAULT_PITCH, font_name)

' Select the new font.
OldFont = SelectObject(PicCoverPaper.hdc, newFont)

' Display the text.
PicCoverPaper.CurrentX = x
PicCoverPaper.CurrentY = y

temp = PicCoverPaper.ForeColor
PicCoverPaper.ForeColor = fColor    '&HFF00&
'Debug.Print PicCoverPaper.TextWidth(txt)

Do While PicCoverPaper.TextWidth(txt) >= wID    ' 
    trt = True
    txt = left$(txt, Len(txt) - 6)
Loop

If trt Then txt = txt + "...": trt = False
PicCoverPaper.Print txt
PicCoverPaper.ForeColor = temp

' Restore the original font.
newFont = SelectObject(PicCoverPaper.hdc, OldFont)

' Free font resources (important!)
DeleteObject newFont
End Sub

Public Sub GetEditPix()
'ToDebug " -  " ' 


Set PicSS1 = Nothing: NoPic1Flag = False
Set PicSS1Big = Nothing
If GetPic(PicSS1, 1, "SnapShot1") Then
    PicSS1.Picture = PicSS1.Image
End If

Set PicSS2 = Nothing: NoPic2Flag = False
Set PicSS2Big = Nothing
If GetPic(PicSS2, 1, "SnapShot2") Then PicSS2.Picture = PicSS2.Image

Set PicSS3 = Nothing: NoPic3Flag = False
Set PicSS3Big = Nothing
If GetPic(PicSS3, 1, "SnapShot3") Then PicSS3.Picture = PicSS3.Image

Set PicFrontFace = Nothing
Set picCanvas = Nothing
If GetPic(PicFrontFace, 1, "FrontFace") Then
    PicFrontFace.Picture = PicFrontFace.Image
    DrawCoverEdit
End If

End Sub

'Public Sub GetPixDD()
''ToDebug " -  "
'
'Set PicSS1 = Nothing: Set PicSS1Big = Nothing
'If GetPic(PicSS1Big, 1, "SnapShot1") Then PicSS1Big.Picture = PicSS1Big.Image
'    Set PicSS2 = Nothing: Set PicSS2Big = Nothing
'    If GetPic(PicSS2Big, 1, "SnapShot2") Then PicSS2Big.Picture = PicSS2Big.Image
'        Set PicSS3 = Nothing: Set PicSS3Big = Nothing
'        If GetPic(PicSS3Big, 1, "SnapShot3") Then PicSS3Big.Picture = PicSS3Big.Image
'
'Set PicFrontFace = Nothing
'Set picCanvas = Nothing
'If GetPic(PicFrontFace, 1, "FrontFace") Then
'    PicFrontFace.Picture = PicFrontFace.Image
'End If
'
'End Sub

Public Sub GetFields()
'ToDebug " -  "  
Dim tmp As String

Mark2SaveFlag = False '  Mark2Save

TextMName.Text = CheckNoNull("MovieName"):    FrameAddEdit.Caption = AddEditCapt & " > " & TextMName.Text

TextLabel.Text = CheckNoNull("Label")
TextGenre.Text = CheckNoNull("Genre")
TextYear.Text = CheckNoNull("Year")
TextCountry.Text = CheckNoNull("Country")
TextAuthor.Text = CheckNoNull("Director")
TextRole.Text = CheckNoNull("Acter")
TextTimeHid.Text = CheckNoNull("Time")
TextResolHid.Text = CheckNoNull("Resolution")
TextAudioHid.Text = CheckNoNull("Audio")
TextFPSHid.Text = CheckNoNull("FPS")
TextFilelenHid.Text = CheckNoNull("FileLen")
TextCDN.Text = CheckNoNull("CDN")
ComboNos.Text = CheckNoNull("MediaType")
TextVideoHid.Text = CheckNoNull("Video")
TextSubt.Text = CheckNoNull("SubTitle")
TextLang.Text = CheckNoNull("Language")
TextRate.Text = CheckNoNull("Rating")
TextFileName.Text = CheckNoNull("FileName")
TextUser.Text = CheckNoNull("Debtor")
CDSerialCur.Text = CheckNoNull("SNDisk")
TextOther.Text = CheckNoNull("Other")
TextCoverURL.Text = CheckNoNull("CoverPath")
TextMovURL.Text = CheckNoNull("MovieURL")
TextAnnotation.Text = CheckNoNull("Annotation")

'  
tmp = Replace(TextMName.Text, "(", vbNullString)
tmp = Replace(tmp, ")", vbNullString)
tmp = Replace(tmp, "/", vbNullString)
If Len(TextMName.Text) <> 0 Then TxtIName.Text = LCase$(tmp)

'   
ComboGenre.Text = vbNullString
ComboCountry.Text = vbNullString
ComboOther.Text = vbNullString


Mark2SaveFlag = True ' Mark2Save
End Sub
Private Sub GetAFields()
'TextActName = CheckANoNull("Name")
'TextActBio = CheckANoNull("Bio")

If ars.Fields("Name") <> vbNullString Then
TextActName.Text = ars.Fields("Name")
Else
TextActName.Text = vbNullString
End If

'Call SendMessage(TextActBio.hwnd, WM_SETREDRAW, False, ByVal 0&)

If ars.Fields("Bio") <> vbNullString Then
TextActBio.Text = ars.Fields("Bio")
Else
TextActBio.Text = vbNullString
End If

'Call SendMessage(TextActBio.hwnd, WM_SETREDRAW, True, ByVal 0&)

End Sub


'Private Function CheckANoNull(F As String) As String
''Dim temp As String
'If ars.Fields(F) <> vbNullString Then
'CheckANoNull = ars.Fields(F)
'Else
'CheckANoNull = vbNullString
'End If
'End Function

Public Sub ClearFields()
'   

TextFilelenHid = "0"
TextTimeHid = vbNullString
'TextCompanyHid = rs.Fields("")
TextVideoHid = vbNullString
TextFPSHid = vbNullString
TextResolHid = vbNullString
TextAudioHid = vbNullString
'TextFramesHid = rs.Fields("")
TextTimeMSHid = "0"
TextMName.Text = vbNullString
TextLabel.Text = vbNullString
TextGenre.Text = vbNullString
TextCountry.Text = vbNullString
TextYear.Text = vbNullString
TextAuthor.Text = vbNullString
TextRole.Text = vbNullString
TextUser.Text = vbNullString
TextCDN.Text = "0"
TextFileName.Text = vbNullString
TextAnnotation.Text = vbNullString
TextOther.Text = vbNullString
CDSerialCur.Text = vbNullString

'lbInetMovieList.Clear
ComboSites.Text = vbNullString
ComboGenre.Text = vbNullString
ComboCountry.Text = vbNullString

TextRate = vbNullString
TextLang = vbNullString
TextSubt = vbNullString
TextCoverURL = vbNullString
TextMovURL = vbNullString

ComboNos.Text = vbNullString

End Sub

Private Function PutFields() As Long
'   ,   ,  
' rs("Key")  
'Dim tmp As String

On Error GoTo err

'replace2regional  ? /  

'
'Select Case rs.Fields("Label").Type
'Case 2, 3, 4, 6, 7         ' -
'    tmp = Replace(TextLabel.Text, ",", ".")
'    rs.Fields("Label") = Val(tmp)
'Case Else
'    ' 
If Len(TextLabel.Text) > 255 Then rs.Fields("Label") = left$(TextLabel.Text, 255) Else rs.Fields("Label") = TextLabel.Text
'End Select

If Len(TextMName.Text) > 255 Then rs.Fields("MovieName") = left$(TextMName.Text, 255) Else rs.Fields("MovieName") = TextMName.Text
If Len(TextGenre.Text) > 255 Then rs.Fields("Genre") = left$(TextGenre.Text, 255) Else rs.Fields("Genre") = TextGenre.Text
If Len(TextYear.Text) > 255 Then rs.Fields("Year") = left$(TextYear.Text, 255) Else rs.Fields("Year") = TextYear.Text
If Len(TextCountry.Text) > 255 Then rs.Fields("Country") = left$(TextCountry.Text, 255) Else rs.Fields("Country") = TextCountry.Text
If Len(TextAuthor.Text) > 255 Then rs.Fields("Director") = left$(TextAuthor.Text, 255) Else rs.Fields("Director") = TextAuthor.Text
If Len(TextSubt.Text) > 255 Then rs.Fields("SubTitle") = left$(TextSubt.Text, 255) Else rs.Fields("SubTitle") = TextSubt.Text
If Len(TextLang.Text) > 255 Then rs.Fields("Language") = left$(TextLang.Text, 255) Else rs.Fields("Language") = TextLang.Text
If Len(TextRate.Text) > 255 Then rs.Fields("Rating") = left$(TextRate.Text, 255) Else rs.Fields("Rating") = TextRate.Text
rs.Fields("Other") = TextOther.Text    'memo
If Len(TextUser.Text) > 255 Then rs.Fields("Debtor") = left$(TextUser.Text, 255) Else rs.Fields("Debtor") = TextUser.Text

'
rs.Fields("Acter") = TextRole.Text
rs.Fields("Time") = TextTimeHid.Text
rs.Fields("Resolution") = TextResolHid.Text
rs.Fields("Audio") = TextAudioHid.Text
rs.Fields("FPS") = TextFPSHid.Text
rs.Fields("FileLen") = Val(TextFilelenHid.Text)
rs.Fields("CDN") = TextCDN.Text
rs.Fields("MediaType") = ComboNos.Text
rs.Fields("Video") = TextVideoHid.Text
rs.Fields("FileName") = TextFileName.Text

If CDSerialCur <> vbNullString Then rs.Fields("snDisk") = CDSerialCur.Text

rs.Fields("CoverPath") = TextCoverURL.Text
rs.Fields("MovieURL") = TextMovURL.Text
rs.Fields("Annotation") = TextAnnotation.Text

PutFields = rs("Key")
rs.Update

ToDebug "  "
Exit Function

err:
If err <> 0 Then MsgBox err.Description
End Function




Private Sub PutAFields()
If Len(TextActName) > 255 Then TextActName = left$(TextActName, 255)
ars.Fields("Name") = TextActName
ars.Fields("Bio") = TextActBio
End Sub






Public Sub DrawCoverEdit()
' 
'BitBlt picCanvas.hdc, 0, 0, PicFrontFace.Width, PicFrontFace.Height, _
  PicFrontFace.hdc, 0, 0, SRCCOPY
'picCanvas.Refresh

Dim PRatio As Double

Dim CanvasW As Single 'long
Dim CanvasH As Single
Dim CanvasHalfW As Single
Dim CanvasHalfH As Single
Dim k As Single
Dim chOr As Boolean

CanvasW = picCanvas.Width / Screen.TwipsPerPixelX
CanvasH = picCanvas.Height / Screen.TwipsPerPixelX
CanvasHalfW = CanvasW / 2
CanvasHalfH = CanvasH / 2

If PicFrontFace.Picture <> 0 Then

PRatio = PicFrontFace.Height / PicFrontFace.Width
k = CanvasH / CanvasW

If k < PRatio Then chOr = True

If chOr Then If PRatio > 1 Then PRatio = 1 / PRatio


    If chOr Then
        'centre hor
            picCanvas.PaintPicture PicFrontFace.Picture, CanvasHalfW - (CanvasW * PRatio * k) / 2, 0, CanvasW * PRatio * k, CanvasH
    Else
        'centre VERT
            picCanvas.PaintPicture PicFrontFace.Picture, 0, CanvasHalfH - (CanvasH * PRatio / k) / 2, CanvasW, CanvasH * PRatio / k
    End If


End If
End Sub


Private Sub AutoScrShots(F As Long)
'  
'F -  
Dim tmp As Long
Set PicSS1 = Nothing
Set PicSS2 = Nothing
Set PicSS3 = Nothing


PicSS1.Height = ScrShotEd_W * movie.Height / movie.Width
PicSS1.Width = ScrShotEd_W
 PicSS2.Height = PicSS1.Height
 PicSS2.Width = PicSS1.Width
  PicSS3.Height = PicSS1.Height
  PicSS3.Width = PicSS1.Width

tmp = (F - F * 0.05) / 3 '4
pos1 = 1 + (Rnd() * tmp) '1-4
pos2 = tmp + (Rnd() * tmp) + 1 '4-8
pos3 = tmp * 2 + (Rnd() * tmp) + 1 '8-12

pos1 = m_cAVI.AVIStreamNearestNextKeyFrame(pos1)
pos2 = m_cAVI.AVIStreamNearestNextKeyFrame(pos2)
pos3 = m_cAVI.AVIStreamNearestNextKeyFrame(pos3)

    If Opt_PicRealRes Then '
PicSS1Big.Width = ScaleX(AviWidth, vbPixels, vbTwips)
PicSS1Big.Height = ScaleY(AviHeight, vbPixels, vbTwips)
PicSS2Big.Width = PicSS1Big.Width
PicSS2Big.Height = PicSS1Big.Height
PicSS3Big.Width = PicSS1Big.Width
PicSS3Big.Height = PicSS1Big.Height

'
'tmp = m_cAVI.AVIStreamNearestNextKeyFrame(pos1)
'm_cAVI.DrawFrame PicSS1Big.hdc, tmp, 0, 0, Transparent:=False

m_cAVI.DrawFrame PicSS1Big.hdc, pos1, 0, 0, Transparent:=False
m_cAVI.DrawFrame PicSS2Big.hdc, pos2, 0, 0, Transparent:=False
m_cAVI.DrawFrame PicSS3Big.hdc, pos3, 0, 0, Transparent:=False

PicSS2Big.Picture = PicSS2Big.Image
PicSS1Big.Picture = PicSS1Big.Image
PicSS3Big.Picture = PicSS3Big.Image

'small
PicSS1.PaintPicture PicSS1Big, 0, 0, PicSS1.ScaleWidth, PicSS1.ScaleHeight
PicSS1.Picture = PicSS1.Image
PicSS2.PaintPicture PicSS2Big, 0, 0, PicSS2.ScaleWidth, PicSS2.ScaleHeight
PicSS2.Picture = PicSS2.Image
PicSS3.PaintPicture PicSS3Big, 0, 0, PicSS3.ScaleWidth, PicSS3.ScaleHeight
PicSS3.Picture = PicSS3.Image

    Else
'only small
m_cAVI.DrawFrame PicSS1.hdc, pos1, lWidth:=PicSS1.ScaleWidth, lHeight:=PicSS1.ScaleHeight, Transparent:=False
PicSS1.Picture = PicSS1.Image
m_cAVI.DrawFrame PicSS2.hdc, pos2, lWidth:=PicSS2.ScaleWidth, lHeight:=PicSS2.ScaleHeight, Transparent:=False
PicSS2.Picture = PicSS2.Image
m_cAVI.DrawFrame PicSS3.hdc, pos3, lWidth:=PicSS3.ScaleWidth, lHeight:=PicSS3.ScaleHeight, Transparent:=False
PicSS3.Picture = PicSS3.Image

    End If
'Position.Value = lastRendedAVI
ToDebug "AScrShotsPos Avi: " & pos1 & " " & pos2 & " " & pos3
End Sub

'  auto1
Private Sub AutoScrShotsN(F As Long, ss As Integer)
Select Case ss
Case 1

Set PicSS1 = Nothing
PicSS1.Height = ScrShotEd_W * movie.Height / movie.Width
PicSS1.Width = ScrShotEd_W
pos1 = 1 + (Rnd() * F)
pos1 = m_cAVI.AVIStreamNearestNextKeyFrame(pos1)

    If Opt_PicRealRes Then '
PicSS1Big.Width = ScaleX(AviWidth, vbPixels, vbTwips)
PicSS1Big.Height = ScaleY(AviHeight, vbPixels, vbTwips)
m_cAVI.DrawFrame PicSS1Big.hdc, pos1, 0, 0, Transparent:=False
PicSS1Big.Picture = PicSS1Big.Image
    End If
    
m_cAVI.DrawFrame PicSS1.hdc, pos1, lWidth:=PicSS1.ScaleWidth, lHeight:=PicSS1.ScaleHeight, Transparent:=False
PicSS1.Picture = PicSS1.Image

Case 2

Set PicSS2 = Nothing
PicSS2.Height = ScrShotEd_W * movie.Height / movie.Width
PicSS2.Width = ScrShotEd_W

pos2 = 1 + (Rnd() * F)
pos2 = m_cAVI.AVIStreamNearestNextKeyFrame(pos2)

    If Opt_PicRealRes Then '
PicSS2Big.Width = ScaleX(AviWidth, vbPixels, vbTwips)
PicSS2Big.Height = ScaleY(AviHeight, vbPixels, vbTwips)
m_cAVI.DrawFrame PicSS2Big.hdc, pos2, 0, 0, Transparent:=False
PicSS2Big.Picture = PicSS2Big.Image
    End If
    
m_cAVI.DrawFrame PicSS2.hdc, pos2, lWidth:=PicSS1.ScaleWidth, lHeight:=PicSS1.ScaleHeight, Transparent:=False
PicSS2.Picture = PicSS2.Image
'PicSS1.Picture = movie.Image

Case 3

Set PicSS3 = Nothing
PicSS3.Height = ScrShotEd_W * movie.Height / movie.Width
PicSS3.Width = ScrShotEd_W

pos3 = 1 + (Rnd() * F)
pos3 = m_cAVI.AVIStreamNearestNextKeyFrame(pos3)

    If Opt_PicRealRes Then '
PicSS3Big.Width = ScaleX(AviWidth, vbPixels, vbTwips)
PicSS3Big.Height = ScaleY(AviHeight, vbPixels, vbTwips)
m_cAVI.DrawFrame PicSS3Big.hdc, pos3, 0, 0, Transparent:=False
PicSS3Big.Picture = PicSS3Big.Image
    End If
    
m_cAVI.DrawFrame PicSS3.hdc, pos3, lWidth:=PicSS1.ScaleWidth, lHeight:=PicSS1.ScaleHeight, Transparent:=False
PicSS3.Picture = PicSS3.Image

End Select

End Sub


Private Sub DisplayTextPopup(ByVal txt As TextBox)
' 
    ' Make VB discard the mouse capture.
    txt.Enabled = False
    txt.Enabled = True
    txt.SetFocus

    ' Enable appropriate menu items.
    ' See if anything is selected.
    If txt.SelLength > 0 Then
        ' Text is selected.
        mnuCut.Enabled = True
        mnuCopy.Enabled = True
        mnuDelete.Enabled = True
    Else
        ' No text is selected.
        mnuCut.Enabled = False
        mnuCopy.Enabled = False
        mnuDelete.Enabled = False
    End If

If SendMessage(txt.hWnd, EM_CANUNDO, 0&, ByVal 0&) Then mnuUndo.Enabled = True Else mnuUndo.Enabled = False

    ' Display the custom menu.
    
m7Hid.Visible = True
mnuUndo.Visible = True
mnuCut.Visible = True
mnuCopy.Visible = True
mnuPaste.Visible = True
mnuDelete.Visible = True
m8Hid.Visible = True
mnuSelectAll.Visible = True

If Len(sPerson) = 0 Then mFiltAct.Enabled = False Else mFiltAct.Enabled = True

    PopupMenu mnuTextMenuHid
End Sub

Private Sub mnuCopy_Click()
Dim sOldLang As String
On Error Resume Next

sOldLang = switchLang("00000419")

Clipboard.Clear
Clipboard.SetText ActiveControl.SelText
If Len(sOldLang) > 0 Then sOldLang = switchLang(sOldLang)

End Sub

' Cut the current TextBox's text
' to the clipboard.
Private Sub mnuCut_Click()
Dim sOldLang As String
sOldLang = switchLang("00000419")
Clipboard.Clear
Clipboard.SetText ActiveControl.SelText
ActiveControl.SelText = vbNullString
If Len(sOldLang) > 0 Then sOldLang = switchLang(sOldLang)
End Sub


' Delete the selected text.
Private Sub mnuDelete_Click()
    ActiveControl.SelText = vbNullString
End Sub

' Paste into the current TextBox.
Private Sub mnuPaste_Click()
    ActiveControl.SelText = Clipboard.GetText
End Sub

' Select the TextBox's text.
Private Sub mnuSelectAll_Click()
    ActiveControl.SelStart = 0
    ActiveControl.SelLength = Len(ActiveControl.Text)
End Sub

Private Sub mnuSavePic_Click()
'     1:1 
'  

SavePicFromPic FormShowPic.Picture, FormShowPic.hWnd

'Dim iFile As String
'iFile = pSaveDialog(FormShowPic.hwnd, DTitle:=ComSaveRec.Caption)
'If iFile <> vbNullString Then
'If LCase$(Right$(iFile, 3)) = "bmp" Then
'    SavePicture FormShowPic.Picture, iFile
'End If 'bmp
'If LCase$(Right$(iFile, 3)) = "jpg" Then
'    m_cDib.CreateFromPicture FormShowPic.Picture
'    SaveJPG m_cDib, iFile, QJPG
'End If 'jpg
'Set m_cDib = Nothing
'End If ' iFile <> vbNullString

End Sub
Private Sub mnuCopyPic_Click()
On Error Resume Next
Clipboard.Clear
Clipboard.SetData FormShowPic.Picture ', vbCFBitmap
End Sub

Private Sub mnuKillPic_Click()
If IsCoverShowFlag Then
    CoverWindTop = FormShowPic.top
    CoverWindLeft = FormShowPic.left
Else
    ScrShotWindTop = FormShowPic.top
    ScrShotWindLeft = FormShowPic.left
End If
Unload FormShowPic: Set FormShowPic = Nothing
End Sub
Private Property Let ISubclass_MsgResponse(ByVal RHS As SSubTimer6.EMsgResponse)
m_emr = RHS
End Property

Private Property Get ISubclass_MsgResponse() As SSubTimer6.EMsgResponse
m_emr = emrConsume
ISubclass_MsgResponse = m_emr
End Property

Private Function ISubclass_WindowProc(ByVal hWnd As Long, ByVal iMsg As Long, ByVal wParam As Long, ByVal lParam As Long) As Long
' 
Dim mmiT As MINMAXINFO
'resize
' Copy parameter to local variable for processing
CopyMemory mmiT, ByVal lParam, LenB(mmiT)

' Minimium width and height for sizing
mmiT.ptMinTrackSize.x = 807
mmiT.ptMinTrackSize.y = 608

' Copy modified results back to parameter
CopyMemory ByVal lParam, mmiT, LenB(mmiT)

End Function
Public Sub FillTVGroup()
'  

Dim i As Long, j As Long
Dim strSQL As String
Dim SQL1 As String
Dim rsTV As DAO.Recordset
'mzt Dim TempPole As String
Dim pFlag As Boolean    '  
Dim PustoFlag As Boolean '   
Dim NullFlag As Boolean '  null 
Dim rsArr() As String '   ( )
Dim R() As String
'Dim TokNums As Integer
Dim ArrFlag As Boolean '      rsArr

On Error Resume Next

'tvGroup.Visible = False
tvGroup.ListItems.Clear
' ,    Order By
tvGroup.Sorted = False


If Len(GroupField) = 0 Then    '             
    If FilteredFlag And Len(LastSQLFilterString) <> 0 Then    '   
        strSQL = "Select * From Storage Where " & LastSQLFilterString
        Set rs = DB.OpenRecordset(strSQL)
        GroupedFlag = False
        FillListView
        Exit Sub
    ElseIf FiltPersonFlag And Len(LastSQLPersonString) <> 0 Then '   , 
        strSQL = "Select * From Storage Where " & LastSQLPersonString
        Set rs = DB.OpenRecordset(strSQL)
        GroupedFlag = False
        FillListView
        Exit Sub

    Else    ' 
        'tvGroup.Visible = True
        tvGroup.Refresh ' -  
        
        If GroupedFlag Then
            strSQL = "Select * From Storage"
            Set rs = DB.OpenRecordset(strSQL)
            GroupedFlag = False
            FillListView
            Exit Sub
        Else
            Exit Sub
        End If
    End If


Else

    '      (, , , , .c, , , , , , URL , URL 
    '  TVCLICK
    
    Select Case GroupField
        ' 
        Case "MovieName", "Label", "Year", "Resolution", "FPS", "CDN", "MediaType", "Audio", "Video", "Debtor", "Other", "CoverPath", "MovieURL", "Rating", "FileLen"
            pFlag = False
        Case Else
            pFlag = True    '
    End Select

'ToDebug "Splitting: " & GroupField & " = " & pFlag

    If pFlag Then
    '  , ,  
        SQL1 = "Select " & GroupField & " From Storage"
        If FilteredFlag And Len(LastSQLFilterString) <> 0 Then    '   
        
            '!    255 
            strSQL = SQL1 & " WHERE " & LastSQLFilterString    '& " Group By " & GroupField
        Else
            strSQL = SQL1    '& " Group By " & GroupField
        End If
        
    Else
        'SQL1 = "Select " & GroupField & ", Count(" & GroupField & ") From Storage"
        SQL1 = "Select " & GroupField & ", Count(*) From Storage" 'Count(*)  Null 
        
        If FilteredFlag And Len(LastSQLFilterString) <> 0 Then    '   
            'strSQL = SQL1 & " WHERE " & LastSQLFilterString & " Group By " & GroupField
            
            strSQL = SQL1 & " WHERE " & LastSQLFilterString & " Group By " & GroupField & " Order By " & GroupField '& " Desc"
        Else
        
            strSQL = SQL1 & " Group By " & GroupField & " Order By " & GroupField  '& " Desc"
        
'   -      ,  " Order By Val(" & GroupField & ")" - ,  Null
       
'strSQL = SQL1 & " Group By " & GroupField & " Order By IIf(Label Is Null, Label, Val(Label))"
'strSQL = SQL1 & " Group By " & GroupField & " Order By Int(Label)"


'strSQL = "Select Label, Count(Label) From Storage Group By Label Order By Label"

        End If

    End If

End If    'If Len(GroupField) <> 0

'Debug.Print "FillTV: " & strSQL


Set rsTV = DB.OpenRecordset(strSQL)
If err Then
    Debug.Print "Err FillTVGroup " & err.Description
    ToDebug "Err_FillTVGroup: " & err.Description
    Exit Sub
End If

Screen.MousePointer = vbHourglass
On Error GoTo 0
'Debug.Print rsTV(0).Type

ReDim rsArr(0)    '  0
ArrFlag = False

If Not (rsTV.BOF And rsTV.EOF) Then    'If rsTV.RecordCount > 0 Then
    rsTV.MoveLast: rsTV.MoveFirst

    '
    PBar.min = 0: PBar.Max = rsTV.RecordCount
    'TextItemHid.ZOrder 0
    PBar.ZOrder 0
    PBar.Value = 0
    
    For i = 1 To rsTV.RecordCount    'Do While Not rsTV.EOF '
        PBar.Value = i
        If IsNull(rsTV(0)) Then    '   null, ,  , -  -  null
            ' Null   Count(*)
            If pFlag Then
                NullFlag = True
                'tvGroup.ListItems.Add Text:="Null"
            Else
                tvGroup.ListItems.Add(Text:="Null").ListSubItems.Add Text:=rsTV(1)
            End If
        Else
            'If rsTV(0) = vbNullString Then
            'tvGroup.ListItems.Add(Text:=vbNullString).ListSubItems.Add Text:=rsTV(1)
            'Else
            'tvGroup.ListItems.Add(Text:=rsTV(0)).ListSubItems.Add Text:=rsTV(1)
            
            If pFlag Then
                '     FillGroupArray
                'TempPole = TempPole & rsTV(0) & ","
                '    
                
                If Len(rsTV(0)) = 0 Then
                    PustoFlag = True ' ,     
                Else
                    If Tokenize04(rsTV(0), R(), ",;", False) > -1 Then ' False!    . (1, 2,)
                        For j = 0 To UBound(R)
                        
                           If ArrFlag Then ReDim Preserve rsArr(UBound(rsArr) + 1)
                            rsArr(UBound(rsArr)) = R(j)
                            ArrFlag = True
                            
                        Next j
                    End If
                End If
            
            Else
                ' ,     
                tvGroup.ListItems.Add(Text:=rsTV(0)).ListSubItems.Add Text:=rsTV(1)
            End If
            'End If
        End If
        rsTV.MoveNext
    Next i    'Loop
Else
    'rs 
    pFlag = False '    
End If

Set rsTV = Nothing
'''''''''''''''''''''''''''''''''''''''''''''''
'ReDim Preserve rsArr(UBound(rsArr) - 1) '    - 

If pFlag Then
    If UBound(rsArr) > 0 Then

        TriQuickSortString rsArr    'sorts your string array

        remdups rsArr    'removes all duplicates
        
        If PustoFlag Then ReDim Preserve rsArr(UBound(rsArr) + 1): rsArr(UBound(rsArr)) = vbNullString ' 
        If NullFlag Then ReDim Preserve rsArr(UBound(rsArr) + 1): rsArr(UBound(rsArr)) = "Null" '

        PBar.min = 0
        If UBound(rsArr) > 0 Then PBar.Max = UBound(rsArr) Else PBar.Max = 1
        'TextItemHid.ZOrder 0
        PBar.ZOrder 0

        For i = 0 To UBound(rsArr)
            PBar.Value = i
            If GetAsyncKeyState(vbKeyEscape) And &H1 = &H1 Then Exit For
            tvGroup.ListItems.Add(i + 1, Text:=rsArr(i)).ListSubItems.Add 'Text:=GetGroupNum(rsArr(I))
        Next i

    Else
           tvGroup.ListItems.Add(1, Text:=rsArr(0)).ListSubItems.Add '
            If PustoFlag And (Len(rsArr(0)) <> 0) Then tvGroup.ListItems.Add(1, Text:=vbNullString).ListSubItems.Add

    End If    'If UBound(rsArr) > 1 Then
End If    'If pFlag Then


TextItemHid.ZOrder 0
'''''''''''''''''''''''''''''''''''''''''''''''
':
'    
'   (tvGroup.Sorted = True),    -   

tvGroup.SortKey = 0: tvGroup.SortOrder = lvwAscending    ': tvGroup.Sorted = True
tvGroup.Visible = True
If tvGroup.ListItems.Count > 0 Then
    Set tvGroup.SelectedItem = tvGroup.ListItems(1)
    TVCLICK
    tvGroup.ColumnHeaders(1).Text = GroupColumnHeader & "<" & tvGroup.ListItems.Count & ">"    ' 
End If

Screen.MousePointer = vbNormal
End Sub
Private Sub FillTVNums()
',     (  )
Dim itmX As MSComctlLib.ListItem
On Error Resume Next
Screen.MousePointer = vbHourglass

PBar.min = 0: PBar.Value = 0
If tvGroup.ListItems.Count > 0 Then PBar.Max = tvGroup.ListItems.Count + 1 Else PBar.Max = 1
PBar.ZOrder 0

For Each itmX In tvGroup.ListItems
    'DoEvents
    If GetAsyncKeyState(vbKeyEscape) And &H1 = &H1 Then Exit For
    'Debug.Print GetKeyState(vbKeyEscape)
    If GetKeyState(vbKeyEscape) < 0 Then Exit For
    'End If
    'Exit For
    'End If

    PBar.Value = PBar.Value + 1
    'itmX.ListSubItems.Add Text:=GetGroupNum(itmX.Text)
    '    
    itmX.ListSubItems(1) = GetGroupNum(itmX.Text)
    'Debug.Print itmX.ListSubItems(1)
Next

TextItemHid.ZOrder 0
Screen.MousePointer = vbNormal
End Sub




' Set the list box's horizontal extent
'   listbox
Public Sub SetListboxScrollbar(lb As ListBox)
Dim i As Integer
Dim new_len As Long
Dim max_len As Long

For i = 0 To lb.ListCount - 1
 new_len = 10 + ScaleX(TextWidth(lb.List(i)), ScaleMode, vbPixels)
 If max_len < new_len Then max_len = new_len
Next i

SendMessage lb.hWnd, LB_SETHORIZONTALEXTENT, max_len, 0
End Sub

Private Sub m_LV_Vert_MouseLeave()
'End tracking
Screen.MousePointer = vbNormal
End Sub

Private Sub FrLV_Vert_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)
' Tracking is initialised by entering the control:
FrLV_Vert.MousePointer = 9
If Not (m_LV_Vert.Tracking) Then m_LV_Vert.StartMouseTracking
End Sub
Private Sub FrTV_Vert_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)
' Tracking is initialised by entering the control:
FrTV_Vert.MousePointer = 9
If Not (m_TV_Vert.Tracking) Then m_TV_Vert.StartMouseTracking
End Sub

Private Sub FrLV_Vert_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)
'  
If Opt_Group_Vis Then
    LVWidth = ((x + ListView.Width) * 100) / (MainWidth - tvGroup.Width)
Else
    LVWidth = ((x + ListView.Width) * 100) / MainWidth
End If
'DoEvents
Form_Resize
End Sub
Private Sub FrTV_Vert_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)
'  
TVWidth = x + tvGroup.Width
If TVWidth > MainWidth - 5000 Then
TVWidth = MainWidth - 5000
End If

If TVWidth < 2100 Then TVWidth = 2100

On Error Resume Next ' TVWidth (  )
tvGroup.ColumnHeaders(1).Width = TVWidth - tvGroup.ColumnHeaders(2).Width - 260 '+ setforecolor
'DoEvents
Form_Resize
'Form_Resize
End Sub


Public Sub Mark2Save()
'    
If rs.RecordCount < 1 Then Exit Sub
If BaseReadOnly Or BaseReadOnlyU Then Exit Sub

If Mark2SaveFlag Then
    If FrameAddEdit.Visible Then
        If rs.EditMode = 0 Then
        rs.Edit
        ComSaveRec.BackColor = &HC0C0E0 '
        End If
    End If
End If
End Sub

Private Sub SetMenuIcon()
Dim M As Menu
Set cIM = New cIconMenu

cIM.Attach hWnd, FrmMain.ScaleMode
cIM.OfficeXpStyle = True
cIM.ImageList = ImageList

'On Error Resume Next
'For Each m In mnuEdit
'cIM.IconIndex(m.Caption) = ImageList1.ListImages(m.Caption).Index - 1
'Next
'err.Clear
'On Error GoTo 0

End Sub
