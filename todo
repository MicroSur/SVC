The setting of Referer
??When it keeps tracing link with the browser, it can read normally, but when immediately it tries probably to read
??When it cannot read, "Referer" is set.
??It tries when probably to read the graphics file why it becomes the text file.
??In that kind of case this setting is necessary.
    char szHead [] = "Referer: http://www.microsoft.com/ \ r \ n \ r \ n";  Referer is added to the // header
    HINTERNET hService;
    hService = InternetOpenUrl(hSession, Edit1->Text.c_str (), szHead and lstrlen (szHead), 0 and 0);

??Or, also it is possible to set with HttpOpenRequest.
    char Referer [] = "http://www.microsoft.com/";
    HttpOpenRequest (hService, "GET", UrlName, NULL and Referer, 0,0 and 0);



- искать материал и писать туду поддержки сериалов
-lv индент для сериалов
-инструменты - галка считать объем помеченных

			Сериалы

название.сезон.серия.часть(эпизод?) - выяснить

(свернуто)		    N S	 K  Key      	другие поля, для примера - описание

[]   Другой фильм           0 0   0 183           (фильм, не сериал)
[] > Сериал Дживс и Вустер  4 0	  0 200      	(Экранизация популярнейшего цикла произведений Пэлема Грэнвила Вудхауза.)

(развернуто название)

[]   Другой фильм           0 0   0 183           (фильм, не сериал)
[] V Сериал Дживс и Вустер  4 0	  0 200		(Экранизация популярнейшего цикла произведений Пэлема Грэнвила Вудхауза.)
  [] > Первый сезон         3 1 200 111
  [] > Второй сезон         3 2 200 222
  [] > Третий сезон         3 3 200 333
  [] > Четвертый сезон      3 4 200 444

(развернут первый сезон)

[]   Другой фильм           0 0   0 183           (фильм, не сериал)
[] V Сериал Дживс и Вустер  4 0	  0 200		(Экранизация популярнейшего цикла произведений Пэлема Грэнвила Вудхауза.)
  [] V Первый сезон         3 1 200 777
    []  1. Знакомство       0 1 777 321		(Тетушка Агата мечтает женить своего племянника Берти Вустера. )
    []  2. Турнир по гольфу 0 2 777 322		(Берти не лишен чувства прекрасного. Однажды влюбляется и он.)
    []  3. Азартные Игры    0 3 777 323		(Лорд Вихамерсли проиграл в карты часть имения.)
  [] > Второй сезон         3 2 200 222
  [] > Третий сезон         3 3 200 333
  [] > Четвертый сезон      3 4 200 444


	Новые поля таблицы Storage (не видимы в списке, наверно навсегда)

1) N, количество дочерних строк, 
	если > 0 то текущая строка имеет подстроки (является общим названием 
	сериала, названием сезона итп) и ее нужно отметить "иконкой раскрытия >"
	 ? как определить это кол-во сезонов или серий - никак и разделять на несколько полей не хочется, 
         вложений может быть больше (части, эпизоды)

2) S, Номер сезона или серии, для упорядочивания при показе, можно вписывать в начало названия (1. Знакомство)
	=0 для общего названия

3) K, содержит ключ поля-родителя. Если заполнено, то это дочерняя строка
      сдвинутая относительно родителя, если 0 - обычный фильм.


? как привязать строку сезона или серии к родителю с обеспечением целостности (может ключ изменится при компакте?) - выяснить
  - 
? что будет и что делать если что-то удаляем
  -
? как дублировать/копировать строки
  - отслеживать связи, в настройках галку 'как копировать' с дочками или только строку
? что делать и что будет при общей сортировке по любому полю
  - надо не сортировать дочерние, или скрывать их при любой сортировке
? А простого поиска не будет по списку, невидимых серий не будет физически
  - а что делать... поищем по базе 
- при выходе запоминать не текущий ключ, а ключ главного родителя
-----------------------------------------
? как это заполнять с нуля

I
	1. Заносить в базу все файлы сериала (автодобавлением) как обычные фильмы.
	2. Заполнить поля 'номера серий' S ручками (а как иначе)
	   ? Как именно (в редакторе, в списке этого скорее всего не будет, хотя можно бы)
	3. Занести новые строки-родители, не имеющие файлов (основное название, названия сезонов...)
        4. Преобразовать в сериал (инструмент?):
		a) помечаем галочкой родителя, выделяем дочерние, 
		  меню - преобразовать в сериал
		  при этом автоматом заполняются N у родителя и K у дочерних.
		  и поля родителя автоматом получают сумму полей дочерних (что можно суммировать или объединить). 
   		   (время, дисков, файлов?, средний рейтинг? размер файлов, года 2000-2007...).
		   чтобы это работало нужно начать преобразование 'снизу-вверх':
		    (серии к сезонам, сезоны к основному названию сериала)
		b) повторять пункт a) до конца объединения в общее название сериала.
II
	1. Заносить в базу все файлы сериала (автодобавлением) как обычные фильмы.
	3. Занести новые строки-родители, не имеющие файлов (основное название, названия сезонов...)
        4. Преобразовать в сериал из меню 'инструменты' с вызовом новой формы:
		a) выделяем все записи, относящиеся к данному сериалу
		   меню - преобразовать в сериал, Новая форма преобразования в сериал, 
		   куда попадают выделенные строки,
		   где простым перетаскиванием строк вверх-вниз и влево-вправо (индент) мы форматируем сериал
		   по типу 'как будет в списке'.
  		   и заполняем номера серий в этой же форме.
                   Применить изменения по готовности. (уже не надо преобразовывать несколько раз. как в [I])
          	    при этом автоматом заполняются N у родителя и K у дочерних.
		    и поля родителя автоматом получают сумму полей дочерних (что можно суммировать или объединить). 
   		    (время, дисков, файлов?, средний рейтинг? размер файлов, года 2000;2007 и потрошить при группировке ...).

походу все. Хочу вариант II, будет весело реализовывать форму-преобразователь
---------------------------------------

? как это преобразовать, если уже внесено (весь Джеймс Бонд, Звездные войны...)
	        смотри '? как это заполнять с нуля', только без пункта 1.
--------------------------------------
эээээээээээээээээээээээээээээээээээээээээээ

10 при >9 не показывается (сравнение текст) и это не работает ('') если поле числовое

поле	 	запрос
число   	> 4
val(не число)   > 4	

'обложка
Set PicFaceV = Nothing
If ComShowFa.Visible = True Then
If Not Opt_NoSlideShow Then picScrollBoxV.Visible = False
'а то вначале обложек не видно, а они грузятся
End If















Private NoBeFlat  As Boolean

Private Sub UserControl_Initialize()

Set lvaddon_cScroll = New cScrollBars
lvaddon_cScroll.Create UserControl.hWnd, False, True

lvaddon_cScroll.style = efsFlat ' efsEncarta
'lvaddon_cScroll.VBGColor = RGB(5, 255, 255)'ЎтхЄ BG
lvaddon_cScroll.Orientation = efsoVertical
PicLVAddon.Move 0, 0
'UCLastCtrl = "textMName"
End Sub

Public Sub Create(ByVal hWndA As Long, Optional fsur As Boolean, Optional NoFlat As Boolean)
pClearUp
m_hWnd = hWndA

NoBeFlat = NoFlat '1
pCreateScrollBar '2
pAttachMessages
If fsur Then ForSur = True
End Sub

