Инструменты - отменить сортировку

- лассо в группировке
? позволить в группировке выбирать несколько значений через или

sSQL = "Select * From Storage Where FilmID In (Select FilmID From Cat_Film Where CatID In (Select CatID From CatNames Where CatName = 'Кошмар'))"
Новая таблица для своих категорий

CatID   счетчик индекс ключ
CatName название категории

Новая связующая таблица для категорий

CatID	числовой, индекс (просто)
key   	числовой, индекс (просто)
CatVal	текст
CatKey  счетчик индекс ключ


списки для польз полей
?может в новой таблице? Новые поля... бля.
Своя категория, текст, потрошить
Общее название сериала

слоган
Возрастной рейтинг
Качество фильма
местоположение
Номер диска
Сценарист
Композитор
Дата занесения в базу
Технические
	backcolor строки
	forecolor строки
Галки
	Смотрел/не смотрел
	Есть/Нет в коллекции






Поиск Замена Вставка



'LAST MODIFIED
'- TextTimeMSHid на sTextTimeMS
'rsdd.Fields("MovieName") = rsdd.Fields("MovieName") 'CheckNoNull("MovieName")

'ListView.SelectedItem.Selected = True     'надо, не помню зачем, отключим пока
'FilterItemsSQL FilterItemsSQL 'поле целиком - Like
'21 may 2007 реабилитирован restorebasepos
'14.05.07   , LCID в strconv для буржуев

'Private Sub SQLCompatible(ByRef s As String)

'29.04.2007
'снята постоянная сортировка с tv в ide
'при заполнении tv сортировка снимается (устанавливается при сотрировке чисел)
'внедрена сортировка запроса
'strSQL = SQL1 & " Group By " & GroupField & " Order By " & GroupField '& " Desc"
'теперь если поле числовое и поле не потрошено, сортируется как число в группировке

'28.03.2007 MMI_Format As Currency 'Single  As Currency 'Single
'возможна замена, если встретится нечитаемый старым фильтром двд
'было Private Const cstrSVDName As String = "Universal Open Source MPEG Source"
'на Private Const cstrSVDName As String = "Mpeg Source" + новый соурс фильтр

'''возможные неисправности''''''
'Инет поиск: терминатор
'10:44:30> InetOpen: Ok
'10:44:30> Входной URL =
'10:44:30> Internet Connect Error: 87
' --------- не зарегистрирован msscript.ocx
''''''''''

'Debug.Print "ГР: " & strSQL
'Debug.Print "FAD: " & strSQL
'Debug.Print "mFA:" & strSQL
'Debug.Print "FIS" & strSQL

'TODO
'!! с 1501 актеры worldart - не дают картинки
'актеры кинопоиск, 500 и там перестали пускать. register Acter -..- shura_le@

'!!! myMsgBox применять правильный hwnd если меняем форму
'!!! frmAutoFlag Then FrmMain.SetFocus тоже

'+ из актеров при выборе персоны идет теперь не пометка а фильтрация фильмов (Пометить в каталоге - Оставить...)
'+ показ всех актеров в базе актеров для текущего фильма (меню карточки)
'- поиск по шаблону не только всего поля - как делать Replace with pattern
'- фильтр нет био в актерах - не куда
'+ Нет в списке фильмов без названия, правка взад - проверка на нулл при fill lv в названии
'+ править LstBases_DragDrop перетаскивание (будет все равно не верно, если вкладки имеют одинаковые названия)
'+ Статистика показ кол-ва дисков по серийке
'+ Дополнительный Инструмент/Проверка меток и серийников в меню списка фильмов
'+ Правка для статистики по выделенному - не применялось, если снимали выделение с ctrl
'+ правка для f11 чтоб не мигал (гор прокрутка своя)
'+ kinopoisk для фильмов и актеров

'? обновить рейтинки с ибдм по аналогии с
'  Sub InetGetPics(ch As Boolean)       http://us.imdb.com/title/tt0477347/
'~ не уменьшать первую букву в скобках в актерах: Эрик (теодор) Картман
'? окошечко пока только одно в технической информации на movie site..
'? почему группа метки показ 22 и 2,22 при выборе 22
'- Индексированный поиск по всем базам (вкладка в ctrl+F)
'~ при опред типа dvd опред буктип, а не конкретно dvd+r например
'? как массово переопределить например все метки? к чему привязаться
'? как определить, что метка уже есть при заполнении нового фильма
'    как определить, что метка уже дана неправильно(уже была) серийник?


' 06.06.2007 5.4.0 svcsetup.exe
'- всунуть в сетап - почитать ридми
'+доп функции в глобальном поиске и замене: добавление чисел (счетчиков) и текстов,удаление и преобразование строк, удаление картинок.
'+дополнительный фильтр по персонам в меню актеров в карточке фильма
'+после удаления строк, если нужно применить фильтры и группировки DelMovies
'! Больше возможностей при фильтрации, изменен почти весь
'+ лучше работа с выделениями в лв (Dim SelIt As Boolean)
'+ F10 настройки
'+ / 2.2 поправить масштаб людей кино
'+ перейти на сайт фильма (меню под посмотреть)
'+ в списке ctrl+клик можно ли сделать снятие выделения при мультиселекте
'+ выделить хотябы цветом кол-во актеров, если фильтровано (или радио?)
'+ 2000 чуть подольше таймер слайдшоу (не мешала бы настройка)
'+ средняя кнопка мыши-выключает таймер (до след клика по лв)
'+ FilterItemsSQL 'поле целиком можно сделать Like и будут работать шаблоны (,*)
'+ Добавить еще полей в фильтр (язык, субтитры, рейтинг, файлы, прим, описание)
'   или оставить десяток с Изменяемыми названиями нужных пользователю полей


'+ если при автозаполнении мы в редакторе, то исп данные как шаблон.
'+не применялось изменение по кнопке \все\ в настройках профилей экспорта
'+неправильно запоминались положение галочек в окне автодобавления
'+ Opt_InetGetPicUseTempFile для тестов, только в read global.ini
'+ перемещение разделителя tv не всегда отрисовывает
'! правой мышкой в TV - сортирует как число
'+ правка filelen в TV
'+ Null в группировке
'! Подготовка к mediainfo MediaInfoLib - v0.7.4.5
'применение новых ответов mediainfo/ 'Select Case MPGCodec заменен на функцию Select Case strMPEG
'+ Ins (есть другая реакция при ctrl shift)
'+ перестановка баз тасканием правой кнопкой
    
'патч 5.3.7.1 20.03.2007
'+правка вычисления времени многосерийных dvd фильмов
'~ При объединении суммируется только 255 символов в поле имя файла - если поле базы txt (и у времени)
'+ ввести w:h в редакторе
'- что за структура у файлов ПДД/рандеву ? нет захвата
'+ выбор аспекта, если не узнали. кнопки у видео окна (4/3 16/9)
'+ удаление и просмоти обложки во вкладке Фильм в редакторе.
'+ Сделать добавление скриншотов, без основного открытия файла (открыть фотики с выбором файла)
'? ну lcase там зачем то ... в автодобаавлении названия файлов маленькими буквами?
'- экспорт в HTML по алфавиту?
'
'релиз 5.3.7 22.02.2007
'+ Если наступит завтра - косяк со временем при добавлении
'- что будет? вызывается Ins не только из просмотра
'+ продолжить с makeini (как у текущего)
'+ списками из файлов локализаций переехали в user.lng
'+ манагер списков в настройках, новая вкладка
'+ добавить комбо с плюсиком для примечания. выбор качества, просил Infernal13
'= новые комбо подменяют значения из базы подходящими из списка - убрал выпадение
'+ в хранилище списков user.lng появилась поддержка еще некоторых полей редактора.
'+ кнопка проверки новой версии в закладке интернет
'+ прописать в сетап новый шаблон интерактив
'+ поправлено вычисление длительности avi с некорректным заголовком.
'? добавить галку кадры в печати
'+ 30.01.2007 полный отказ от IJL11.DLL (cDibSection mIntelJPEGLibrary)
'+ все записи картинок в файл переделать в одну подпрогу + через WIA во все форматы
'+ галку AVI DS
'+ при переключении на режим показа скриншотов, глючит таймер. Timer2.Enabled = TimerStatus
'  Запускается, но при клике на строку застывает.
'+ узнавать тип носителя только при смене носителя (по sn)
'   +InitOpto = cCD.ChooseInterface '(blnForceASPI)
'+ галку - всегда центровать 1:1 окно
'+ статистика врет террабайты - забил на AI
'+ убрать таки показ текстовой строки из browseForFolder - тупая она
'? как-то отследить, что global.ini поврежден, и если так, сделать новый с бекапом
'+ если не найден файл локализации, подставить таки rus.lng если он есть.
'~ до того посмотреть, что там без него плывет
'~ нет пока. обновление библиотеки MediaInfo в дистрибутиве.
'+ ридонли база выдала ошибку на ctrl+a - при любом редактировании базы проверить ридонли флаг.
'? предупредить, что ини файл ридонли, если так. INIFileFlagRW и для опций
'~ не засек ... не удалялась firstrun после добавления новых баз и удаления firstrun
'? проверить... автодобавлению очень мешает показ скриншотов в окне просмотра.  Как то его заморозить...
'+ что с вылетами при записи неких файлов при 99-100% сжатии - создается кривой jepeg.
'   ReDim B(0 To m_cDib.Height * m_cDib.BytesPerScanLine / 3) As Byte
'? Могу подумать о пункте в меню типа "Открыть папку с фильмом в проводнике".
'   длительный поиск...
'+ мгновенная реакция на смену разделителя полей экспорта
'- GetWord жрет двойные и более пробелы
'+ сделать выбор вариантов при выборе полей экспорта в настройках
'+ сохранять созданную для печати обложку как jpg (для помещения ее на болванку)
'   mnuCoverSave, mnuCoverCopy
'+ галка показывать ли при експорте в буфер и список печати названия колонок
'   tmp = TranslatedFieldsNames(dbAnnotationInd) & ": " & tmp

' - через WIA
'   + искусственное уширение
'   ~ обложки в печати - есть в двд
' + 'исправить : RenderAut поместить в DShGetInfo !!!
' ? вертик. расположение кадров в печати обложки
' + недокум ключи NoMediaType - не читать инфу о носителе
' ? сделать www.torrents.ru
' + 31.10.2006 www.senatorinfo.com скрипт сломался
' - OriginalTitleFirst = True (Шаререактор, ...
' + 30.10.2006 Шаререактор скрипт сломался
' + список печати группирован по полю сортировки
' ? произвести сортировку после глобальной замены
' ? дома по правому клику после отработки меню происходит клик на lv
' + тестировать: заполнять только пустые... -> опции заменять, не менять, дополнять
' + vbr/cbr у видео в avi? только первого - в todebug
' + метадата для avi
'   IART - Director, IAS1 - IAS9 первый язык и тд
' + AVCodecList.svc в сетап
' + search replace
' + convert2svc - people
' + ComSaveRec.BackColor = &HC0C0E0
' + запоминать ключ актера а не позицию
' + редактирование в актерах при фильтре
' + горячие кнопки не должны отрабатывать "серые" пункты меню
' + в фильтр 2 галки: есть кадры, есть обложка (составить запросы и обратные запросы)
' ? не вышло создавать базу программно - unicode compression как поставить?
' + проверить аспекты видео окон
' + оставить только hb_cScroll
' ? почему передается фокус в 1:1 - изза постоянной модальности окна 1:1 - поставлен флаг
' + сделать общий саб для иск. рисайза в ShowInShowPic и formShowPic
' + GetAspectFromVideoField и юзать для искуственного расширения
' + Private Sub DrawCoverEdit() переделать как в картинках для печати (уменьшение, по центру)
' ? Почемужтак тормозит большие Био в актерах - зависит от шрифта
' = картинки записанные в базу с реальным разр. при html не масштабируются
' ? Совместная база из всех?
' + редактор - 255...
' + прописать горячие клавиши в lv
' + инвертирование пометок
' + удаление помеченного и выделенного DelMovies
' + скроллинг и больше полей в карточке фильма
' ? TextGenre_KeyDown -> TextGenre_KeyPress для ловли ctrl c
' ? как бы перенести обложку в район карточки фильма
' + Не считать фильмы в FillTV для актеров режиссеров и всего длинного. Читать при нажатии <>
' + FillTV    'Не потрошить некоторые поля (Название, Метка, Год, Формат, к.c, Дисков, Носитель, Видео, Должник, Прим, URL об, URL фильма
'   FillTV рейтинг .  фпс , - так в базе.
' + неправильно считаются кол-ва в FillTV
' + TVClick с потрошением как сделать, что показывать
' + Фильтр - не терять выбранные критерии при закрытии окна фильтра - скрывать фильтр
' + Совместная работа фильтра и группировки
' + Фильтр - галка Исключить выбранное
' + Потрошить поля на составляющие (,;) для группировки как и для фильтра
' + Converter: При открывании источников - вернуть взад готовые связи
' + j=0 'Экспорт в Эксел (и может еще куда) выделенное (dvd) попадает не все. Помеченное - все (12 обезъян - сайлент хилл?)
' ? антифлик в актерах? ато тормозит на больших текстах
' ? после удаления и перезапуска может не найти последнее поле - подумать о записи ключа, а не позиции
' + бокс с паролем для ntlm (SendRequest)
' + не работает cancel в меню изменения должника и метки
' + SelRowsKey ... в SelRows и checkrows - ключи, исправить все присвоения
' + передавать в rsmove ключи
'
' + ИНТЕРНЕТ global.ini [GLOBAL]
' + добавление для DShow файлов
' + объединение нескольких записей в одну? как в ANTe  сделано. Фильм разбит на несколько файлов. Я отмечаю и даю команду объединить. Он вычисляет средний битрейт, суммирует время и размер. Ставит максимальный размер кадра (если размеры разные у файлов). Делает одну запись.
' + Скрипты проверить
' ~ брать картинки для печати обложки - 1 раз - тока обложку
' + быстрая пометка всего (b avto) LB_SETSEL
' + скомпилить конвертер
' + Регистрировать! В инсталлятор - WIA и convert.txt, новые инет-скрипты
' ? не меняется ли global при инсталле? - нет
' + добавить группировку при печати списка - чтобы можно было группировать с подзаголовками.
'   Например, напечатать весь список, разбитый по дискам.
'   Серийник 12351
'   Питер Пен
'   Бармаглот
'   Святой Грааль
'
'   Серийник 12352
'   Амели
'   Стена
'   Красная скрипка
' - И при выводе в HTML тоже сделать возможность группировки по какому-либо полю.
' + Доп кнопочку - скопировать из базы в это окно. Потом переходишь в другую запись базы и копируешь из этого окна в запись базы.
' ? в окне редактирования добавить бы кнопки перехода от фильма к фильму
' + Придумать удобную фильтрацию разрешений. расширение *.mp4, MKV - матрешка
'   NamesStore(9) и 10
' + В базе могут находится картинки в форматах PNG, Tif, jpg,gif,bmp
' + PNG, Tif (MS WIA)
' + не чистить подписи, если нет файла локализации
' ? редактирование в таблице
' + утилита актеров - дополнение без дубликатов
' + Понимать разделитель Enter*
' + при дебаггере не выходит по X
' + в меню менять метку как должника
' + при входе в редактор очищать список инет поиска
' + убирать последнию запятую во времени, если время несколько в одном (кошки)
' + Чистить таки носитель при открывании фильма
' ? Изучить кварц события и ваще
'   http://msdn.microsoft.com/library/default.asp?url=/library/en-us/directshow/htm/geteventmethodimediaeventobject.asp
' ? тестировать - почему долго выходит при опто инфо - не чистить объекты ?
' ~ врет опто инфо при nero drivespeed
' ? не работает соурс кодек дома (разрешение svcd?) - тогда проверить еще и наши кодеки
'   при определении svcd
' + ? убрал cancelupdate удаление фильмов - баг - удаляет, после компакта поля снова есть
' + убрать может выбор принтера? все есть по кнопке Принт
' + порядок полей экспорта - как в списке
' + разделитель полей экспорта
' + авто добавление фильмов
' + раздать иконки формам 1 раз
' ? процент FrameView верх-низ - побольше верха
' + если не показаны скриншоты показать описание и обложку рядом
' + Удаление записей без перечитывания
' + HScroll_Change
' ! убран транспарент - тормоза
' + почему много ресайзов при запуске
' + новые поля в драг-дроп окно
' + Сделать добавление нового DVD диска ?
'   как быть, если 1 ифо на все фильмы (времена через , ) - никак не складывать
' + синхронизируй файлы локализаций
' + группировка в списке по дискам и др
' ? cBasePicURL и ComboInfoSites - заполнять и дополнять из формы
'   (внести ключ - кол-во и вписывать в файл локализации)
' + цвет вертик меню
' + как инкрементно обьединять базы?
' + ввести ключ  'rsKeyPole = val(ListView.ListItems(140).Key)
'   ListView.ListItems.Add ind, rs.Fields("Key") & """", CheckNoNullVal(0)
' + Не суммировать носители при добавлении нового файла (только если это новый диск?)
' + битрейт видео для vstrip-нутого из mminfo
' + править vstrip - разбить на 2 функции язык и аудио
' ? в настройки - добавлять к должнику дату (и в редакторе)
' + запоминать позиции textWindow обложки сразу
' - Люди кино - просить сохранить при переходе меж строк и пункт автосохранения в настройках
' + ПЕРЕДЕЛАТЬ опции
' + Печать списка (несколько в одном) в конкретных обложках
' + Импорт из CSV
' + Кнопка у картинки-обложки - взять картинку из... интернета (скрипт)
' + НОвые поля базы:
'   + SubTitle
'   + CoverPath +
'   + MovieURL +
'   + Rating
'   + MediaType + ComboNos
'   + Language
' + если нет ifo взять MMI_Format_str=16/9...
' = Сохранять кадры с реальным разрешением, показывать пропорционально.
'   = нужно хранить пропорции
'   = а если картинка не скриншот... - беда
' - добавить форму для выбора и заполнения должника с адресами - таблицу в базе people.mdb
' + dsGetInfo и туда аспект из vstrip (WMV )- это процедура, если файл не мпег
' + Актеры: Можно ли не перезаполнять всю базу, а только новую запись добавлять.
' ~ при поиске в описании продолжить поиск не со след записи а попытаться в тойже.
' + F3 ^F
' + опции - сохранять настройки на выходе
' + опции - отмечать должников цветом в списке
' + Эксперименты с фильтр sql
' + перемещение текста в печати (границы)
' + после редактирования нового и показа только названия не проявляется остальное
' + пощитать размер всех вобов фильма
' + что-то сделать с аспектом
' + Можно ли не перезаполнять всю базу, а только новую запись добавлять.
''''''''''''''''''
''''''''''''''''''
'При изменении полей базы:
'+ При изменении названий полей в базе - менять в SQL запросах
'+ Внести индекс - Public dbMovieNameInd As Integer
'+ Поменять кол-во
'    Public Const lvHeaderIndexPole As Integer = 25
'    Public Const lvIndexPole As Integer = 24 ' 18
'    Public Const SVCBaseFielsCount = 31 '25 'полей в базе фильмов
'+ Добавить проверку в OpenDB
'+ Изменить файлы локализации ListView.CH1 и новые лейблы
'+ Добавить новое в FillLVSubs
'+ Засунуть новую пустышку в ресурсы
'+ Поменять FirstRun.mdb
'+ Если надо подогнать сортировку ListView_ColumnClick
'+ добавить в ExportHTML
'   + поменять шаблон HTML
'   + добавить в ридми  ($SUBTITLE$    - Субтитры)
'+ проверить индексы GetCoverSpisok и mnuCopyLV_Click
'  + LstExport_ListCount = 25 '19       +текстовые поля + аннотация
'  + LstExport_Arr(25) As Boolean ' с 0
'+ проверить на тестовом test.html
'+ Разместить и сконнектить поля в редакторе
'  + GetFields()
'  + PutFields()
'  + ClearFields
'+ GetPutDD копирование
'+ Автоматически заполнять новые поля
'+ добавить в инет скрипты и подпрограммы с этим связанные SetFromScript
'+ добавить в UCLV
'
''''''''''''''''''''''''''''''''''''''''''''
'   Для новой опции надо
'+ Добавить в Const LstOptNum +1
'+ Декларировать переменную-флаг в модуле Опций
'+ прописать в файлы локализаций (LstOpt14=Центровать 1:1 окно изображений)
'+ запись переменной в ини ComOptSave_Click
'+ чтение переменной ReadINI ReadINIOpt
'+ передача ее в опции Var2Options (LstOpt.Selected(13) = Opt_CenterShowPic)
'+ возврат из контрола в переменную Options2Var - LstOpt2Var - LstExport2Var
'           или возврат и применение сразу по изменению контрола
'+ процедура изменения контрола, если надо chVMcolor_Click()
'        VMSameColor = chVMcolor.Value
'        ApplyOpt
'        optsaved = False
'+ Применить в коде
'
